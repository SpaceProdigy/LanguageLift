var ts=Object.defineProperty;var es=(b,e,v)=>e in b?ts(b,e,{enumerable:!0,configurable:!0,writable:!0,value:v}):b[e]=v;var ee=(b,e,v)=>(es(b,typeof e!="symbol"?e+"":e,v),v),je=(b,e,v)=>{if(!e.has(b))throw TypeError("Cannot "+v)};var t=(b,e,v)=>(je(b,e,"read from private field"),v?v.call(b):e.get(b)),U=(b,e,v)=>{if(e.has(b))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(b):e.set(b,v)},rt=(b,e,v,n)=>(je(b,e,"write to private field"),n?n.call(b,v):e.set(b,v),v);var ge=(b,e,v,n)=>({set _(d){rt(b,e,d,v)},get _(){return t(b,e,n)}}),X=(b,e,v)=>(je(b,e,"access private method"),v);import{r as reactExports,Y as generateUtilityClasses,Z as generateUtilityClass,s as styled,a1 as capitalize,G as _objectWithoutPropertiesLoose,J as _extends,U as useSlotProps,a4 as clsx,j as jsxRuntimeExports,aI as createUseThemeProps,V as composeClasses,B as Box,m as motion,A as requireCreateSvgIcon,C as interopRequireDefaultExports,aJ as getAugmentedNamespace,h as getDefaultExportFromCjs,a as useSelector,b as selectLanguage,T as Typography,I as IconButton,P as PropTypes,c as useDispatch,aH as useLocation,aK as selectLessonsById,aL as Divider,q as nanoid,aM as uploadMaterialsThunk,p as notify,i as Paper,ai as dayjs,aN as addCommentByIdThunk,ay as collectionDb,aO as default_1$9,a0 as Modal,at as selectLessonsLoading,v as selectAuthUser,aP as selectTheme,e as selectAuthentificated,aQ as getScheduleByIdThunk,aR as deleteFileByNameThunk}from"./index-By5rtwD6.js";import{A as AlertComponent}from"./AlertComponent-DhBIWvDV.js";import{C as Chip,I as ImageTitle}from"./ImageTitle-Cl3cm8yk.js";import{d as default_1$8}from"./Close-Ci92SZqB.js";import{C as CircularProgress,T as TextField,d as default_1$a}from"./Delete-3yzfhYCh.js";import{B as Button}from"./Button-DuwqzRyg.js";import{A as AnimatePresence}from"./index-D-BPPXHe.js";import"./index-MmPmNS3S.js";import"./OutlinedInput-CkPNzoKb.js";function _mergeNamespaces(b,e){for(var v=0;v<e.length;v++){const n=e[v];if(typeof n!="string"&&!Array.isArray(n)){for(const d in n)if(d!=="default"&&!(d in b)){const W=Object.getOwnPropertyDescriptor(n,d);W&&Object.defineProperty(b,d,W.get?W:{enumerable:!0,get:()=>n[d]})}}}return Object.freeze(Object.defineProperty(b,Symbol.toStringTag,{value:"Module"}))}const usePreviousProps=b=>{const e=reactExports.useRef({});return reactExports.useEffect(()=>{e.current=b}),e.current};function useBadge(b){const{badgeContent:e,invisible:v=!1,max:n=99,showZero:d=!1}=b,W=usePreviousProps({badgeContent:e,max:n});let j=v;v===!1&&e===0&&!d&&(j=!0);const{badgeContent:it,max:k=n}=j?W:b,S=it&&Number(it)>k?`${k}+`:it;return{badgeContent:it,invisible:j,max:k,displayValue:S}}function getBadgeUtilityClass(b){return generateUtilityClass("MuiBadge",b)}const badgeClasses=generateUtilityClasses("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),_excluded=["anchorOrigin","className","classes","component","components","componentsProps","children","overlap","color","invisible","max","badgeContent","slots","slotProps","showZero","variant"],RADIUS_STANDARD=10,RADIUS_DOT=4,useThemeProps=createUseThemeProps(),useUtilityClasses=b=>{const{color:e,anchorOrigin:v,invisible:n,overlap:d,variant:W,classes:j={}}=b,it={root:["root"],badge:["badge",W,n&&"invisible",`anchorOrigin${capitalize(v.vertical)}${capitalize(v.horizontal)}`,`anchorOrigin${capitalize(v.vertical)}${capitalize(v.horizontal)}${capitalize(d)}`,`overlap${capitalize(d)}`,e!=="default"&&`color${capitalize(e)}`]};return composeClasses(it,getBadgeUtilityClass,j)},BadgeRoot=styled("span",{name:"MuiBadge",slot:"Root",overridesResolver:(b,e)=>e.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),BadgeBadge=styled("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(b,e)=>{const{ownerState:v}=b;return[e.badge,e[v.variant],e[`anchorOrigin${capitalize(v.anchorOrigin.vertical)}${capitalize(v.anchorOrigin.horizontal)}${capitalize(v.overlap)}`],v.color!=="default"&&e[`color${capitalize(v.color)}`],v.invisible&&e.invisible]}})(({theme:b})=>{var e;return{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:b.typography.fontFamily,fontWeight:b.typography.fontWeightMedium,fontSize:b.typography.pxToRem(12),minWidth:RADIUS_STANDARD*2,lineHeight:1,padding:"0 6px",height:RADIUS_STANDARD*2,borderRadius:RADIUS_STANDARD,zIndex:1,transition:b.transitions.create("transform",{easing:b.transitions.easing.easeInOut,duration:b.transitions.duration.enteringScreen}),variants:[...Object.keys(((e=b.vars)!=null?e:b).palette).filter(v=>{var n,d;return((n=b.vars)!=null?n:b).palette[v].main&&((d=b.vars)!=null?d:b).palette[v].contrastText}).map(v=>({props:{color:v},style:{backgroundColor:(b.vars||b).palette[v].main,color:(b.vars||b).palette[v].contrastText}})),{props:{variant:"dot"},style:{borderRadius:RADIUS_DOT,height:RADIUS_DOT*2,minWidth:RADIUS_DOT*2,padding:0}},{props:({ownerState:v})=>v.anchorOrigin.vertical==="top"&&v.anchorOrigin.horizontal==="right"&&v.overlap==="rectangular",style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${badgeClasses.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:v})=>v.anchorOrigin.vertical==="bottom"&&v.anchorOrigin.horizontal==="right"&&v.overlap==="rectangular",style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${badgeClasses.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:v})=>v.anchorOrigin.vertical==="top"&&v.anchorOrigin.horizontal==="left"&&v.overlap==="rectangular",style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${badgeClasses.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:v})=>v.anchorOrigin.vertical==="bottom"&&v.anchorOrigin.horizontal==="left"&&v.overlap==="rectangular",style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${badgeClasses.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:({ownerState:v})=>v.anchorOrigin.vertical==="top"&&v.anchorOrigin.horizontal==="right"&&v.overlap==="circular",style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${badgeClasses.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:v})=>v.anchorOrigin.vertical==="bottom"&&v.anchorOrigin.horizontal==="right"&&v.overlap==="circular",style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${badgeClasses.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:v})=>v.anchorOrigin.vertical==="top"&&v.anchorOrigin.horizontal==="left"&&v.overlap==="circular",style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${badgeClasses.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:v})=>v.anchorOrigin.vertical==="bottom"&&v.anchorOrigin.horizontal==="left"&&v.overlap==="circular",style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${badgeClasses.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:b.transitions.create("transform",{easing:b.transitions.easing.easeInOut,duration:b.transitions.duration.leavingScreen})}}]}}),Badge=reactExports.forwardRef(function(e,v){var n,d,W,j,it,k;const S=useThemeProps({props:e,name:"MuiBadge"}),{anchorOrigin:f={vertical:"top",horizontal:"right"},className:I,component:D,components:E={},componentsProps:g={},children:x,overlap:u="rectangular",color:y="default",invisible:C=!1,max:w=99,badgeContent:_,slots:a,slotProps:c,showZero:L=!1,variant:A="standard"}=S,l=_objectWithoutPropertiesLoose(S,_excluded),{badgeContent:F,invisible:m,max:$,displayValue:z}=useBadge({max:w,invisible:C,badgeContent:_,showZero:L}),R=usePreviousProps({anchorOrigin:f,color:y,overlap:u,variant:A,badgeContent:_}),V=m||F==null&&A!=="dot",{color:st=y,overlap:at=u,anchorOrigin:G=f,variant:ct=A}=V?R:S,gt=ct!=="dot"?z:void 0,xt=_extends({},S,{badgeContent:F,invisible:V,max:$,displayValue:gt,showZero:L,anchorOrigin:G,color:st,overlap:at,variant:ct}),Et=useUtilityClasses(xt),M=(n=(d=a==null?void 0:a.root)!=null?d:E.Root)!=null?n:BadgeRoot,i=(W=(j=a==null?void 0:a.badge)!=null?j:E.Badge)!=null?W:BadgeBadge,o=(it=c==null?void 0:c.root)!=null?it:g.root,r=(k=c==null?void 0:c.badge)!=null?k:g.badge,h=useSlotProps({elementType:M,externalSlotProps:o,externalForwardedProps:l,additionalProps:{ref:v,as:D},ownerState:xt,className:clsx(o==null?void 0:o.className,Et.root,I)}),p=useSlotProps({elementType:i,externalSlotProps:r,ownerState:xt,className:clsx(Et.badge,r==null?void 0:r.className)});return jsxRuntimeExports.jsxs(M,_extends({},h,{children:[x,jsxRuntimeExports.jsx(i,_extends({},p,{children:gt}))]}))}),ModalWrapper=styled(Box)`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 90%;
  height: 80%;
  background-color: ${({theme:b})=>b.palette.background.paper};
  box-shadow: ${({theme:b})=>b.shadows[11]};
  padding: 40px;
  border-radius: 5px;

  overflow-y: auto;
  scrollbar-width: thin;
  z-index: 100;
`,MotionWrapper=motion(ModalWrapper),WrapperClose=styled(Box)`
  position: absolute;
  right: 5px;
  top: 5px;
`,Overlay=styled(Box)`
  position: absolute;
  right: 0;
  top: 0;
  left: 0;
  bottom: 0;
  background-color: #11111190;
`,maxSizeError=b=>alert((()=>{switch(b){case"en":return"The maximum file size must not exceed 5 MB.";case"ua":return"Максимальний розмір файлу не повинен перевищувати 5 МБ.";default:return"The maximum file size must not exceed 5 MB."}})()),maxFilesError=(b,e)=>alert((()=>{switch(b){case"en":return`You can only upload up to ${e} files.`;case"ua":return`Ви можете завантажити не більше ${e} файлів.`;default:return`You can only upload up to ${e} files.`}})()),chooseCorrectFile=b=>alert((()=>{switch(b){case"en":return"Please select an image (png, jpg, jpeg) or PDF file.";case"ua":return"Будь ласка, виберіть зображення (png, jpg, jpeg) або файл PDF.";default:return"Please select an image (png, jpg, jpeg) or PDF file."}})());var AttachFile={},_interopRequireDefault$7=interopRequireDefaultExports;Object.defineProperty(AttachFile,"__esModule",{value:!0});var default_1$7=AttachFile.default=void 0,_createSvgIcon$7=_interopRequireDefault$7(requireCreateSvgIcon()),_jsxRuntime$7=jsxRuntimeExports;default_1$7=AttachFile.default=(0,_createSvgIcon$7.default)((0,_jsxRuntime$7.jsx)("path",{d:"M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6z"}),"AttachFile");const StyledBadge=styled(Box)`
  width: 18px;
  height: 18px;
  border-radius: 50%;
  right: -7px;
  top: -7px;
  position: absolute;
  display: flex;
  justify-content: center;
  align-items: center;
  background-color: ${({theme:b})=>b.palette.secondary.main};
`,VisuallyHiddenInput=styled("input")({clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1}),ImageWrapper=styled(Box)`
  position: relative;
  width: 200px;
  height: 150px;
  background-repeat: no-repeat;
  background-size: contain;
  background-position: center;
  background-image: url(${({src:b})=>b});
  background-color: #b0c4de;
  border-radius: 5px;
`,LoaderWrapper$1=styled(Box)`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  display: flex;
  justify-content: center;
  align-items: center;
  background-color: #11111190;
  border-radius: 50%;
  z-index: 10;
`,LoaderPercent$1=styled(Box)`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
`,MainWrapper=styled(Box)`
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-wrap: wrap;
  flex-direction: column;
  gap: 20px;
`,ButtonWrapper=styled(Box)`
  width: 100%;
  display: flex;
  gap: 20px;
  justify-content: center;
  flex-wrap: wrap;
`;var CloudUpload={},_interopRequireDefault$6=interopRequireDefaultExports;Object.defineProperty(CloudUpload,"__esModule",{value:!0});var default_1$6=CloudUpload.default=void 0,_createSvgIcon$6=_interopRequireDefault$6(requireCreateSvgIcon()),_jsxRuntime$6=jsxRuntimeExports;default_1$6=CloudUpload.default=(0,_createSvgIcon$6.default)((0,_jsxRuntime$6.jsx)("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M14 13v4h-4v-4H7l5-5 5 5z"}),"CloudUpload");const WrapperNavigateButton$1=styled(Box)`
  width: 100%;
  position: absolute;
  top: 50%;
  transform: translate(0, -50%);
  display: flex;
  justify-content: space-between;
  z-index: 10;
`,LoaderWrapper=styled(Box)`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  display: flex;
  justify-content: center;
  align-items: center;
  background-color: #11111190;
  border-radius: 50%;
  z-index: 10;
`,LoaderPercent=styled(Box)`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
`;var ChevronLeft={},_interopRequireDefault$5=interopRequireDefaultExports;Object.defineProperty(ChevronLeft,"__esModule",{value:!0});var default_1$5=ChevronLeft.default=void 0,_createSvgIcon$5=_interopRequireDefault$5(requireCreateSvgIcon()),_jsxRuntime$5=jsxRuntimeExports;default_1$5=ChevronLeft.default=(0,_createSvgIcon$5.default)((0,_jsxRuntime$5.jsx)("path",{d:"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"ChevronLeft");var ChevronRight={},_interopRequireDefault$4=interopRequireDefaultExports;Object.defineProperty(ChevronRight,"__esModule",{value:!0});var default_1$4=ChevronRight.default=void 0,_createSvgIcon$4=_interopRequireDefault$4(requireCreateSvgIcon()),_jsxRuntime$4=jsxRuntimeExports;default_1$4=ChevronRight.default=(0,_createSvgIcon$4.default)((0,_jsxRuntime$4.jsx)("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"ChevronRight");function commonjsRequire(b){throw new Error('Could not dynamically require "'+b+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf$1={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(e,v){module.exports=e.pdfjsLib=v()})(globalThis,()=>(()=>{var __webpack_modules__=[,(b,e)=>{var Xt;Object.defineProperty(e,"__esModule",{value:!0}),e.VerbosityLevel=e.Util=e.UnknownErrorException=e.UnexpectedResponseException=e.TextRenderingMode=e.RenderingIntentFlag=e.PromiseCapability=e.PermissionFlag=e.PasswordResponses=e.PasswordException=e.PageActionEventType=e.OPS=e.MissingPDFException=e.MAX_IMAGE_SIZE_TO_CACHE=e.LINE_FACTOR=e.LINE_DESCENT_FACTOR=e.InvalidPDFException=e.ImageKind=e.IDENTITY_MATRIX=e.FormatError=e.FeatureTest=e.FONT_IDENTITY_MATRIX=e.DocumentActionEventType=e.CMapCompressionType=e.BaseException=e.BASELINE_FACTOR=e.AnnotationType=e.AnnotationReplyType=e.AnnotationPrefix=e.AnnotationMode=e.AnnotationFlag=e.AnnotationFieldFlag=e.AnnotationEditorType=e.AnnotationEditorPrefix=e.AnnotationEditorParamsType=e.AnnotationBorderStyleType=e.AnnotationActionEventType=e.AbortException=void 0,e.assert=ct,e.bytesToString=H,e.createValidAbsoluteUrl=xt,e.getModificationDate=Ct,e.getUuid=Gt,e.getVerbosityLevel=V,e.info=st,e.isArrayBuffer=pt,e.isArrayEqual=Tt,e.isNodeJS=void 0,e.normalizeUnicode=$t,e.objectFromMap=ht,e.objectSize=ot,e.setVerbosityLevel=R,e.shadow=Et,e.string32=J,e.stringToBytes=nt,e.stringToPDFString=mt,e.stringToUTF8String=et,e.unreachable=G,e.utf8StringToString=Q,e.warn=at;const v=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");e.isNodeJS=v;const n=[1,0,0,1,0,0];e.IDENTITY_MATRIX=n;const d=[.001,0,0,.001,0,0];e.FONT_IDENTITY_MATRIX=d;const W=1e7;e.MAX_IMAGE_SIZE_TO_CACHE=W;const j=1.35;e.LINE_FACTOR=j;const it=.35;e.LINE_DESCENT_FACTOR=it;const k=it/j;e.BASELINE_FACTOR=k;const S={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};e.RenderingIntentFlag=S;const f={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};e.AnnotationMode=f;const I="pdfjs_internal_editor_";e.AnnotationEditorPrefix=I;const D={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};e.AnnotationEditorType=D;const E={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};e.AnnotationEditorParamsType=E;const g={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};e.PermissionFlag=g;const x={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};e.TextRenderingMode=x;const u={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};e.ImageKind=u;const y={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};e.AnnotationType=y;const C={GROUP:"Group",REPLY:"R"};e.AnnotationReplyType=C;const w={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};e.AnnotationFlag=w;const _={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};e.AnnotationFieldFlag=_;const a={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};e.AnnotationBorderStyleType=a;const c={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};e.AnnotationActionEventType=c;const L={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};e.DocumentActionEventType=L;const A={O:"PageOpen",C:"PageClose"};e.PageActionEventType=A;const l={ERRORS:0,WARNINGS:1,INFOS:5};e.VerbosityLevel=l;const F={NONE:0,BINARY:1};e.CMapCompressionType=F;const m={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};e.OPS=m;const $={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};e.PasswordResponses=$;let z=l.WARNINGS;function R(ut){Number.isInteger(ut)&&(z=ut)}function V(){return z}function st(ut){z>=l.INFOS&&console.log(`Info: ${ut}`)}function at(ut){z>=l.WARNINGS&&console.log(`Warning: ${ut}`)}function G(ut){throw new Error(ut)}function ct(ut,tt){ut||G(tt)}function gt(ut){switch(ut==null?void 0:ut.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function xt(ut,tt=null,Y=null){if(!ut)return null;try{if(Y&&typeof ut=="string"){if(Y.addDefaultProtocol&&ut.startsWith("www.")){const At=ut.match(/\./g);(At==null?void 0:At.length)>=2&&(ut=`http://${ut}`)}if(Y.tryConvertEncoding)try{ut=et(ut)}catch{}}const yt=tt?new URL(ut,tt):new URL(ut);if(gt(yt))return yt}catch{}return null}function Et(ut,tt,Y,yt=!1){return Object.defineProperty(ut,tt,{value:Y,enumerable:!yt,configurable:!0,writable:!1}),Y}const M=function(){function tt(Y,yt){this.constructor===tt&&G("Cannot initialize BaseException."),this.message=Y,this.name=yt}return tt.prototype=new Error,tt.constructor=tt,tt}();e.BaseException=M;class i extends M{constructor(tt,Y){super(tt,"PasswordException"),this.code=Y}}e.PasswordException=i;class o extends M{constructor(tt,Y){super(tt,"UnknownErrorException"),this.details=Y}}e.UnknownErrorException=o;class r extends M{constructor(tt){super(tt,"InvalidPDFException")}}e.InvalidPDFException=r;class h extends M{constructor(tt){super(tt,"MissingPDFException")}}e.MissingPDFException=h;class p extends M{constructor(tt,Y){super(tt,"UnexpectedResponseException"),this.status=Y}}e.UnexpectedResponseException=p;class P extends M{constructor(tt){super(tt,"FormatError")}}e.FormatError=P;class O extends M{constructor(tt){super(tt,"AbortException")}}e.AbortException=O;function H(ut){(typeof ut!="object"||(ut==null?void 0:ut.length)===void 0)&&G("Invalid argument for bytesToString");const tt=ut.length,Y=8192;if(tt<Y)return String.fromCharCode.apply(null,ut);const yt=[];for(let At=0;At<tt;At+=Y){const te=Math.min(At+Y,tt),Qt=ut.subarray(At,te);yt.push(String.fromCharCode.apply(null,Qt))}return yt.join("")}function nt(ut){typeof ut!="string"&&G("Invalid argument for stringToBytes");const tt=ut.length,Y=new Uint8Array(tt);for(let yt=0;yt<tt;++yt)Y[yt]=ut.charCodeAt(yt)&255;return Y}function J(ut){return String.fromCharCode(ut>>24&255,ut>>16&255,ut>>8&255,ut&255)}function ot(ut){return Object.keys(ut).length}function ht(ut){const tt=Object.create(null);for(const[Y,yt]of ut)tt[Y]=yt;return tt}function ft(){const ut=new Uint8Array(4);return ut[0]=1,new Uint32Array(ut.buffer,0,1)[0]===1}function dt(){try{return new Function(""),!0}catch{return!1}}class wt{static get isLittleEndian(){return Et(this,"isLittleEndian",ft())}static get isEvalSupported(){return Et(this,"isEvalSupported",dt())}static get isOffscreenCanvasSupported(){return Et(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?Et(this,"platform",{isWin:!1,isMac:!1}):Et(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var tt,Y;return Et(this,"isCSSRoundSupported",(Y=(tt=globalThis.CSS)==null?void 0:tt.supports)==null?void 0:Y.call(tt,"width: round(1.5px, 1px)"))}}e.FeatureTest=wt;const Lt=[...Array(256).keys()].map(ut=>ut.toString(16).padStart(2,"0"));class vt{static makeHexColor(tt,Y,yt){return`#${Lt[tt]}${Lt[Y]}${Lt[yt]}`}static scaleMinMax(tt,Y){let yt;tt[0]?(tt[0]<0&&(yt=Y[0],Y[0]=Y[1],Y[1]=yt),Y[0]*=tt[0],Y[1]*=tt[0],tt[3]<0&&(yt=Y[2],Y[2]=Y[3],Y[3]=yt),Y[2]*=tt[3],Y[3]*=tt[3]):(yt=Y[0],Y[0]=Y[2],Y[2]=yt,yt=Y[1],Y[1]=Y[3],Y[3]=yt,tt[1]<0&&(yt=Y[2],Y[2]=Y[3],Y[3]=yt),Y[2]*=tt[1],Y[3]*=tt[1],tt[2]<0&&(yt=Y[0],Y[0]=Y[1],Y[1]=yt),Y[0]*=tt[2],Y[1]*=tt[2]),Y[0]+=tt[4],Y[1]+=tt[4],Y[2]+=tt[5],Y[3]+=tt[5]}static transform(tt,Y){return[tt[0]*Y[0]+tt[2]*Y[1],tt[1]*Y[0]+tt[3]*Y[1],tt[0]*Y[2]+tt[2]*Y[3],tt[1]*Y[2]+tt[3]*Y[3],tt[0]*Y[4]+tt[2]*Y[5]+tt[4],tt[1]*Y[4]+tt[3]*Y[5]+tt[5]]}static applyTransform(tt,Y){const yt=tt[0]*Y[0]+tt[1]*Y[2]+Y[4],At=tt[0]*Y[1]+tt[1]*Y[3]+Y[5];return[yt,At]}static applyInverseTransform(tt,Y){const yt=Y[0]*Y[3]-Y[1]*Y[2],At=(tt[0]*Y[3]-tt[1]*Y[2]+Y[2]*Y[5]-Y[4]*Y[3])/yt,te=(-tt[0]*Y[1]+tt[1]*Y[0]+Y[4]*Y[1]-Y[5]*Y[0])/yt;return[At,te]}static getAxialAlignedBoundingBox(tt,Y){const yt=this.applyTransform(tt,Y),At=this.applyTransform(tt.slice(2,4),Y),te=this.applyTransform([tt[0],tt[3]],Y),Qt=this.applyTransform([tt[2],tt[1]],Y);return[Math.min(yt[0],At[0],te[0],Qt[0]),Math.min(yt[1],At[1],te[1],Qt[1]),Math.max(yt[0],At[0],te[0],Qt[0]),Math.max(yt[1],At[1],te[1],Qt[1])]}static inverseTransform(tt){const Y=tt[0]*tt[3]-tt[1]*tt[2];return[tt[3]/Y,-tt[1]/Y,-tt[2]/Y,tt[0]/Y,(tt[2]*tt[5]-tt[4]*tt[3])/Y,(tt[4]*tt[1]-tt[5]*tt[0])/Y]}static singularValueDecompose2dScale(tt){const Y=[tt[0],tt[2],tt[1],tt[3]],yt=tt[0]*Y[0]+tt[1]*Y[2],At=tt[0]*Y[1]+tt[1]*Y[3],te=tt[2]*Y[0]+tt[3]*Y[2],Qt=tt[2]*Y[1]+tt[3]*Y[3],Z=(yt+Qt)/2,St=Math.sqrt((yt+Qt)**2-4*(yt*Qt-te*At))/2,Ot=Z+St||1,Rt=Z-St||1;return[Math.sqrt(Ot),Math.sqrt(Rt)]}static normalizeRect(tt){const Y=tt.slice(0);return tt[0]>tt[2]&&(Y[0]=tt[2],Y[2]=tt[0]),tt[1]>tt[3]&&(Y[1]=tt[3],Y[3]=tt[1]),Y}static intersect(tt,Y){const yt=Math.max(Math.min(tt[0],tt[2]),Math.min(Y[0],Y[2])),At=Math.min(Math.max(tt[0],tt[2]),Math.max(Y[0],Y[2]));if(yt>At)return null;const te=Math.max(Math.min(tt[1],tt[3]),Math.min(Y[1],Y[3])),Qt=Math.min(Math.max(tt[1],tt[3]),Math.max(Y[1],Y[3]));return te>Qt?null:[yt,te,At,Qt]}static bezierBoundingBox(tt,Y,yt,At,te,Qt,Z,St){const Ot=[],Rt=[[],[]];let jt,Nt,Jt,_t,Yt,It,N,s;for(let K=0;K<2;++K){if(K===0?(Nt=6*tt-12*yt+6*te,jt=-3*tt+9*yt-9*te+3*Z,Jt=3*yt-3*tt):(Nt=6*Y-12*At+6*Qt,jt=-3*Y+9*At-9*Qt+3*St,Jt=3*At-3*Y),Math.abs(jt)<1e-12){if(Math.abs(Nt)<1e-12)continue;_t=-Jt/Nt,0<_t&&_t<1&&Ot.push(_t);continue}N=Nt*Nt-4*Jt*jt,s=Math.sqrt(N),!(N<0)&&(Yt=(-Nt+s)/(2*jt),0<Yt&&Yt<1&&Ot.push(Yt),It=(-Nt-s)/(2*jt),0<It&&It<1&&Ot.push(It))}let T=Ot.length,B;const q=T;for(;T--;)_t=Ot[T],B=1-_t,Rt[0][T]=B*B*B*tt+3*B*B*_t*yt+3*B*_t*_t*te+_t*_t*_t*Z,Rt[1][T]=B*B*B*Y+3*B*B*_t*At+3*B*_t*_t*Qt+_t*_t*_t*St;return Rt[0][q]=tt,Rt[1][q]=Y,Rt[0][q+1]=Z,Rt[1][q+1]=St,Rt[0].length=Rt[1].length=q+2,[Math.min(...Rt[0]),Math.min(...Rt[1]),Math.max(...Rt[0]),Math.max(...Rt[1])]}}e.Util=vt;const Dt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function mt(ut){if(ut[0]>="ï"){let Y;if(ut[0]==="þ"&&ut[1]==="ÿ"?Y="utf-16be":ut[0]==="ÿ"&&ut[1]==="þ"?Y="utf-16le":ut[0]==="ï"&&ut[1]==="»"&&ut[2]==="¿"&&(Y="utf-8"),Y)try{const yt=new TextDecoder(Y,{fatal:!0}),At=nt(ut);return yt.decode(At)}catch(yt){at(`stringToPDFString: "${yt}".`)}}const tt=[];for(let Y=0,yt=ut.length;Y<yt;Y++){const At=Dt[ut.charCodeAt(Y)];tt.push(At?String.fromCharCode(At):ut.charAt(Y))}return tt.join("")}function et(ut){return decodeURIComponent(escape(ut))}function Q(ut){return unescape(encodeURIComponent(ut))}function pt(ut){return typeof ut=="object"&&(ut==null?void 0:ut.byteLength)!==void 0}function Tt(ut,tt){if(ut.length!==tt.length)return!1;for(let Y=0,yt=ut.length;Y<yt;Y++)if(ut[Y]!==tt[Y])return!1;return!0}function Ct(ut=new Date){return[ut.getUTCFullYear().toString(),(ut.getUTCMonth()+1).toString().padStart(2,"0"),ut.getUTCDate().toString().padStart(2,"0"),ut.getUTCHours().toString().padStart(2,"0"),ut.getUTCMinutes().toString().padStart(2,"0"),ut.getUTCSeconds().toString().padStart(2,"0")].join("")}class Ut{constructor(){U(this,Xt,!1);this.promise=new Promise((tt,Y)=>{this.resolve=yt=>{rt(this,Xt,!0),tt(yt)},this.reject=yt=>{rt(this,Xt,!0),Y(yt)}})}get settled(){return t(this,Xt)}}Xt=new WeakMap,e.PromiseCapability=Ut;let zt=null,Wt=null;function $t(ut){return zt||(zt=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Wt=new Map([["ﬅ","ſt"]])),ut.replaceAll(zt,(tt,Y,yt)=>Y?Y.normalize("NFKC"):Wt.get(yt))}function Gt(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const ut=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(ut);else for(let tt=0;tt<32;tt++)ut[tt]=Math.floor(Math.random()*255);return H(ut)}const Bt="pdfjs_internal_id_";e.AnnotationPrefix=Bt},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var b,v,n,d,he,j,Ee,k,S,f,I,D,E,g,x,u,Se,C,w,Ne,a,c;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(A){if(typeof A=="string"||A instanceof URL?A={url:A}:(0,_util.isArrayBuffer)(A)&&(A={data:A}),typeof A!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!A.url&&!A.data&&!A.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const l=new PDFDocumentLoadingTask,{docId:F}=l,m=A.url?getUrlProp(A.url):null,$=A.data?getDataProp(A.data):null,z=A.httpHeaders||null,R=A.withCredentials===!0,V=A.password??null,st=A.range instanceof PDFDataRangeTransport?A.range:null,at=Number.isInteger(A.rangeChunkSize)&&A.rangeChunkSize>0?A.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let G=A.worker instanceof PDFWorker?A.worker:null;const ct=A.verbosity,gt=typeof A.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(A.docBaseUrl)?A.docBaseUrl:null,xt=typeof A.cMapUrl=="string"?A.cMapUrl:null,Et=A.cMapPacked!==!1,M=A.CMapReaderFactory||DefaultCMapReaderFactory,i=typeof A.standardFontDataUrl=="string"?A.standardFontDataUrl:null,o=A.StandardFontDataFactory||DefaultStandardFontDataFactory,r=A.stopAtErrors!==!0,h=Number.isInteger(A.maxImageSize)&&A.maxImageSize>-1?A.maxImageSize:-1,p=A.isEvalSupported!==!1,P=typeof A.isOffscreenCanvasSupported=="boolean"?A.isOffscreenCanvasSupported:!_util.isNodeJS,O=Number.isInteger(A.canvasMaxAreaInBytes)?A.canvasMaxAreaInBytes:-1,H=typeof A.disableFontFace=="boolean"?A.disableFontFace:_util.isNodeJS,nt=A.fontExtraProperties===!0,J=A.enableXfa===!0,ot=A.ownerDocument||globalThis.document,ht=A.disableRange===!0,ft=A.disableStream===!0,dt=A.disableAutoFetch===!0,wt=A.pdfBug===!0,Lt=st?st.length:A.length??NaN,vt=typeof A.useSystemFonts=="boolean"?A.useSystemFonts:!_util.isNodeJS&&!H,Dt=typeof A.useWorkerFetch=="boolean"?A.useWorkerFetch:M===_display_utils.DOMCMapReaderFactory&&o===_display_utils.DOMStandardFontDataFactory&&xt&&i&&(0,_display_utils.isValidFetchUrl)(xt,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(i,document.baseURI),mt=A.canvasFactory||new DefaultCanvasFactory({ownerDocument:ot}),et=A.filterFactory||new DefaultFilterFactory({docId:F,ownerDocument:ot}),Q=null;(0,_util.setVerbosityLevel)(ct);const pt={canvasFactory:mt,filterFactory:et};if(Dt||(pt.cMapReaderFactory=new M({baseUrl:xt,isCompressed:Et}),pt.standardFontDataFactory=new o({baseUrl:i})),!G){const Ut={verbosity:ct,port:_worker_options.GlobalWorkerOptions.workerPort};G=Ut.port?PDFWorker.fromPort(Ut):new PDFWorker(Ut),l._worker=G}const Tt={docId:F,apiVersion:"3.11.174",data:$,password:V,disableAutoFetch:dt,rangeChunkSize:at,length:Lt,docBaseUrl:gt,enableXfa:J,evaluatorOptions:{maxImageSize:h,disableFontFace:H,ignoreErrors:r,isEvalSupported:p,isOffscreenCanvasSupported:P,canvasMaxAreaInBytes:O,fontExtraProperties:nt,useSystemFonts:vt,cMapUrl:Dt?xt:null,standardFontDataUrl:Dt?i:null}},Ct={ignoreErrors:r,isEvalSupported:p,disableFontFace:H,fontExtraProperties:nt,enableXfa:J,ownerDocument:ot,disableAutoFetch:dt,pdfBug:wt,styleElement:Q};return G.promise.then(function(){if(l.destroyed)throw new Error("Loading aborted");const Ut=_fetchDocument(G,Tt),zt=new Promise(function(Wt){let $t;st?$t=new _transport_stream.PDFDataTransportStream({length:Lt,initialData:st.initialData,progressiveDone:st.progressiveDone,contentDispositionFilename:st.contentDispositionFilename,disableRange:ht,disableStream:ft},st):$||($t=(Bt=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(Bt):(0,_display_utils.isValidFetchUrl)(Bt.url)?new _displayFetch_stream.PDFFetchStream(Bt):new _displayNetwork.PDFNetworkStream(Bt))({url:m,length:Lt,httpHeaders:z,withCredentials:R,rangeChunkSize:at,disableRange:ht,disableStream:ft})),Wt($t)});return Promise.all([Ut,zt]).then(function([Wt,$t]){if(l.destroyed)throw new Error("Loading aborted");const Gt=new _message_handler.MessageHandler(F,Wt,G.port),Bt=new WorkerTransport(Gt,l,$t,Ct,pt);l._transport=Bt,Gt.send("Ready",null)})}).catch(l._capability.reject),l}async function _fetchDocument(A,l){if(A.destroyed)throw new Error("Worker was destroyed");const F=await A.messageHandler.sendWithPromise("GetDocRequest",l,l.data?[l.data.buffer]:null);if(A.destroyed)throw new Error("Worker was destroyed");return F}function getUrlProp(A){if(A instanceof URL)return A.href;try{return new URL(A,window.location).href}catch{if(_util.isNodeJS&&typeof A=="string")return A}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(A){if(_util.isNodeJS&&typeof Buffer<"u"&&A instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(A instanceof Uint8Array&&A.byteLength===A.buffer.byteLength)return A;if(typeof A=="string")return(0,_util.stringToBytes)(A);if(typeof A=="object"&&!isNaN(A==null?void 0:A.length)||(0,_util.isArrayBuffer)(A))return new Uint8Array(A);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const e=class e{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${ge(e,b)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var l,F,m;this.destroyed=!0;try{(l=this._worker)!=null&&l.port&&(this._worker._pendingDestroy=!0),await((F=this._transport)==null?void 0:F.destroy())}catch($){throw(m=this._worker)!=null&&m.port&&delete this._worker._pendingDestroy,$}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};b=new WeakMap,U(e,b,0);let PDFDocumentLoadingTask=e;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(l,F,m=!1,$=null){this.length=l,this.initialData=F,this.progressiveDone=m,this.contentDispositionFilename=$,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(l){this._rangeListeners.push(l)}addProgressListener(l){this._progressListeners.push(l)}addProgressiveReadListener(l){this._progressiveReadListeners.push(l)}addProgressiveDoneListener(l){this._progressiveDoneListeners.push(l)}onDataRange(l,F){for(const m of this._rangeListeners)m(l,F)}onDataProgress(l,F){this._readyCapability.promise.then(()=>{for(const m of this._progressListeners)m(l,F)})}onDataProgressiveRead(l){this._readyCapability.promise.then(()=>{for(const F of this._progressiveReadListeners)F(l)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const l of this._progressiveDoneListeners)l()})}transportReady(){this._readyCapability.resolve()}requestDataRange(l,F){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(l,F){this._pdfInfo=l,this._transport=F,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(m=>{if(!m)return m;const $=[];for(const z in m)$.push(...m[z]);return $}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(l){return this._transport.getPage(l)}getPageIndex(l){return this._transport.getPageIndex(l)}getDestinations(){return this._transport.getDestinations()}getDestination(l){return this._transport.getDestination(l)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(l=!1){return this._transport.startCleanup(l||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(l,F,m,$=!1){U(this,d);U(this,j);U(this,v,null);U(this,n,!1);this._pageIndex=l,this._pageInfo=F,this._transport=m,this._stats=$?new _display_utils.StatTimer:null,this._pdfBug=$,this.commonObjs=m.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:l,rotation:F=this.rotate,offsetX:m=0,offsetY:$=0,dontFlip:z=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:l,rotation:F,offsetX:m,offsetY:$,dontFlip:z})}getAnnotations({intent:l="display"}={}){const F=this._transport.getRenderingIntent(l);return this._transport.getAnnotations(this._pageIndex,F.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var l;return((l=this._transport._htmlForXfa)==null?void 0:l.children[this._pageIndex])||null}render({canvasContext:l,viewport:F,intent:m="display",annotationMode:$=_util.AnnotationMode.ENABLE,transform:z=null,background:R=null,optionalContentConfigPromise:V=null,annotationCanvasMap:st=null,pageColors:at=null,printAnnotationStorage:G=null}){var o,r;(o=this._stats)==null||o.time("Overall");const ct=this._transport.getRenderingIntent(m,$,G);rt(this,n,!1),X(this,j,Ee).call(this),V||(V=this._transport.getOptionalContentConfig());let gt=this._intentStates.get(ct.cacheKey);gt||(gt=Object.create(null),this._intentStates.set(ct.cacheKey,gt)),gt.streamReaderCancelTimeout&&(clearTimeout(gt.streamReaderCancelTimeout),gt.streamReaderCancelTimeout=null);const xt=!!(ct.renderingIntent&_util.RenderingIntentFlag.PRINT);gt.displayReadyCapability||(gt.displayReadyCapability=new _util.PromiseCapability,gt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(r=this._stats)==null||r.time("Page Request"),this._pumpOperatorList(ct));const Et=h=>{var p,P;gt.renderTasks.delete(M),(this._maybeCleanupAfterRender||xt)&&rt(this,n,!0),X(this,d,he).call(this,!xt),h?(M.capability.reject(h),this._abortOperatorList({intentState:gt,reason:h instanceof Error?h:new Error(h)})):M.capability.resolve(),(p=this._stats)==null||p.timeEnd("Rendering"),(P=this._stats)==null||P.timeEnd("Overall")},M=new InternalRenderTask({callback:Et,params:{canvasContext:l,viewport:F,transform:z,background:R},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:st,operatorList:gt.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!xt,pdfBug:this._pdfBug,pageColors:at});(gt.renderTasks||(gt.renderTasks=new Set)).add(M);const i=M.task;return Promise.all([gt.displayReadyCapability.promise,V]).then(([h,p])=>{var P;if(this.destroyed){Et();return}(P=this._stats)==null||P.time("Rendering"),M.initializeGraphics({transparency:h,optionalContentConfig:p}),M.operatorListChanged()}).catch(Et),i}getOperatorList({intent:l="display",annotationMode:F=_util.AnnotationMode.ENABLE,printAnnotationStorage:m=null}={}){var st;function $(){R.operatorList.lastChunk&&(R.opListReadCapability.resolve(R.operatorList),R.renderTasks.delete(V))}const z=this._transport.getRenderingIntent(l,F,m,!0);let R=this._intentStates.get(z.cacheKey);R||(R=Object.create(null),this._intentStates.set(z.cacheKey,R));let V;return R.opListReadCapability||(V=Object.create(null),V.operatorListChanged=$,R.opListReadCapability=new _util.PromiseCapability,(R.renderTasks||(R.renderTasks=new Set)).add(V),R.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(st=this._stats)==null||st.time("Page Request"),this._pumpOperatorList(z)),R.opListReadCapability.promise}streamTextContent({includeMarkedContent:l=!1,disableNormalization:F=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:l===!0,disableNormalization:F===!0},{highWaterMark:100,size($){return $.items.length}})}getTextContent(l={}){if(this._transport._htmlForXfa)return this.getXfa().then(m=>_xfa_text.XfaText.textContent(m));const F=this.streamTextContent(l);return new Promise(function(m,$){function z(){R.read().then(function({value:st,done:at}){if(at){m(V);return}Object.assign(V.styles,st.styles),V.items.push(...st.items),z()},$)}const R=F.getReader(),V={items:[],styles:Object.create(null)};z()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const l=[];for(const F of this._intentStates.values())if(this._abortOperatorList({intentState:F,reason:new Error("Page was destroyed."),force:!0}),!F.opListReadCapability)for(const m of F.renderTasks)l.push(m.completed),m.cancel();return this.objs.clear(),rt(this,n,!1),X(this,j,Ee).call(this),Promise.all(l)}cleanup(l=!1){rt(this,n,!0);const F=X(this,d,he).call(this,!1);return l&&F&&this._stats&&(this._stats=new _display_utils.StatTimer),F}_startRenderPage(l,F){var $,z;const m=this._intentStates.get(F);m&&(($=this._stats)==null||$.timeEnd("Page Request"),(z=m.displayReadyCapability)==null||z.resolve(l))}_renderPageChunk(l,F){for(let m=0,$=l.length;m<$;m++)F.operatorList.fnArray.push(l.fnArray[m]),F.operatorList.argsArray.push(l.argsArray[m]);F.operatorList.lastChunk=l.lastChunk,F.operatorList.separateAnnots=l.separateAnnots;for(const m of F.renderTasks)m.operatorListChanged();l.lastChunk&&X(this,d,he).call(this,!0)}_pumpOperatorList({renderingIntent:l,cacheKey:F,annotationStorageSerializable:m}){const{map:$,transfers:z}=m,V=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:l,cacheKey:F,annotationStorage:$},z).getReader(),st=this._intentStates.get(F);st.streamReader=V;const at=()=>{V.read().then(({value:G,done:ct})=>{if(ct){st.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(G,st),at())},G=>{if(st.streamReader=null,!this._transport.destroyed){if(st.operatorList){st.operatorList.lastChunk=!0;for(const ct of st.renderTasks)ct.operatorListChanged();X(this,d,he).call(this,!0)}if(st.displayReadyCapability)st.displayReadyCapability.reject(G);else if(st.opListReadCapability)st.opListReadCapability.reject(G);else throw G}})};at()}_abortOperatorList({intentState:l,reason:F,force:m=!1}){if(l.streamReader){if(l.streamReaderCancelTimeout&&(clearTimeout(l.streamReaderCancelTimeout),l.streamReaderCancelTimeout=null),!m){if(l.renderTasks.size>0)return;if(F instanceof _display_utils.RenderingCancelledException){let $=RENDERING_CANCELLED_TIMEOUT;F.extraDelay>0&&F.extraDelay<1e3&&($+=F.extraDelay),l.streamReaderCancelTimeout=setTimeout(()=>{l.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:l,reason:F,force:!0})},$);return}}if(l.streamReader.cancel(new _util.AbortException(F.message)).catch(()=>{}),l.streamReader=null,!this._transport.destroyed){for(const[$,z]of this._intentStates)if(z===l){this._intentStates.delete($);break}this.cleanup()}}}get stats(){return this._stats}}v=new WeakMap,n=new WeakMap,d=new WeakSet,he=function(l=!1){if(X(this,j,Ee).call(this),!t(this,n)||this.destroyed)return!1;if(l)return rt(this,v,setTimeout(()=>{rt(this,v,null),X(this,d,he).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:F,operatorList:m}of this._intentStates.values())if(F.size>0||!m.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),rt(this,n,!1),!0},j=new WeakSet,Ee=function(){t(this,v)&&(clearTimeout(t(this,v)),rt(this,v,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){U(this,k,new Set);U(this,S,Promise.resolve())}postMessage(l,F){const m={data:structuredClone(l,F?{transfer:F}:null)};t(this,S).then(()=>{for(const $ of t(this,k))$.call(this,m)})}addEventListener(l,F){t(this,k).add(F)}removeEventListener(l,F){t(this,k).delete(F)}terminate(){t(this,k).clear()}}k=new WeakMap,S=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const A=(f=document==null?void 0:document.currentScript)==null?void 0:f.src;A&&(PDFWorkerUtil.fallbackWorkerSrc=A.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(A,l){let F;try{if(F=new URL(A),!F.origin||F.origin==="null")return!1}catch{return!1}const m=new URL(l,F);return F.origin===m.origin},PDFWorkerUtil.createCDNWrapper=function(A){const l=`importScripts("${A}");`;return URL.createObjectURL(new Blob([l]))}}const _PDFWorker=class _PDFWorker{constructor({name:A=null,port:l=null,verbosity:F=(0,_util.getVerbosityLevel)()}={}){var m;if(this.name=A,this.destroyed=!1,this.verbosity=F,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,l){if((m=t(_PDFWorker,I))!=null&&m.has(l))throw new Error("Cannot use more than one PDFWorker per port.");(t(_PDFWorker,I)||rt(_PDFWorker,I,new WeakMap)).set(l,this),this._initializeFromPort(l);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(A){this._port=A,this._messageHandler=new _message_handler.MessageHandler("main","worker",A),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:A}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,A)||(A=PDFWorkerUtil.createCDNWrapper(new URL(A,window.location).href));const l=new Worker(A),F=new _message_handler.MessageHandler("main","worker",l),m=()=>{l.removeEventListener("error",$),F.destroy(),l.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},$=()=>{this._webWorker||m()};l.addEventListener("error",$),F.on("test",R=>{if(l.removeEventListener("error",$),this.destroyed){m();return}R?(this._messageHandler=F,this._port=l,this._webWorker=l,this._readyCapability.resolve(),F.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),F.destroy(),l.terminate())}),F.on("ready",R=>{if(l.removeEventListener("error",$),this.destroyed){m();return}try{z()}catch{this._setupFakeWorker()}});const z=()=>{const R=new Uint8Array;F.send("test",R,[R.buffer])};z();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(A=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const l=new LoopbackPort;this._port=l;const F=`fake${PDFWorkerUtil.fakeWorkerId++}`,m=new _message_handler.MessageHandler(F+"_worker",F,l);A.setup(m,l);const $=new _message_handler.MessageHandler(F,F+"_worker",l);this._messageHandler=$,this._readyCapability.resolve(),$.send("configure",{verbosity:this.verbosity})}).catch(A=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${A.message}".`))})}destroy(){var A;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(A=t(_PDFWorker,I))==null||A.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(A){var F;if(!(A!=null&&A.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const l=(F=t(this,I))==null?void 0:F.get(A.port);if(l){if(l._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return l}return new _PDFWorker(A)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var A;try{return((A=globalThis.pdfjsWorker)==null?void 0:A.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};I=new WeakMap,U(_PDFWorker,I,void 0);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(l,F,m,$,z){U(this,u);U(this,D,new Map);U(this,E,new Map);U(this,g,new Map);U(this,x,null);this.messageHandler=l,this.loadingTask=F,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:$.ownerDocument,styleElement:$.styleElement}),this._params=$,this.canvasFactory=z.canvasFactory,this.filterFactory=z.filterFactory,this.cMapReaderFactory=z.cMapReaderFactory,this.standardFontDataFactory=z.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=m,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(l,F=_util.AnnotationMode.ENABLE,m=null,$=!1){let z=_util.RenderingIntentFlag.DISPLAY,R=_annotation_storage.SerializableEmpty;switch(l){case"any":z=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":z=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${l}`)}switch(F){case _util.AnnotationMode.DISABLE:z+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:z+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:z+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,R=(z&_util.RenderingIntentFlag.PRINT&&m instanceof _annotation_storage.PrintAnnotationStorage?m:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${F}`)}return $&&(z+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:z,cacheKey:`${z}_${R.hash}`,annotationStorageSerializable:R}}destroy(){var m;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(m=t(this,x))==null||m.reject(new Error("Worker was destroyed during onPassword callback"));const l=[];for(const $ of t(this,E).values())l.push($._destroy());t(this,E).clear(),t(this,g).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const F=this.messageHandler.sendWithPromise("Terminate",null);return l.push(F),Promise.all(l).then(()=>{var $;this.commonObjs.clear(),this.fontLoader.clear(),t(this,D).clear(),this.filterFactory.destroy(),($=this._networkStream)==null||$.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:l,loadingTask:F}=this;l.on("GetReader",(m,$)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=z=>{this._lastProgress={loaded:z.loaded,total:z.total}},$.onPull=()=>{this._fullReader.read().then(function({value:z,done:R}){if(R){$.close();return}(0,_util.assert)(z instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),$.enqueue(new Uint8Array(z),1,[z])}).catch(z=>{$.error(z)})},$.onCancel=z=>{this._fullReader.cancel(z),$.ready.catch(R=>{if(!this.destroyed)throw R})}}),l.on("ReaderHeadersReady",m=>{const $=new _util.PromiseCapability,z=this._fullReader;return z.headersReady.then(()=>{var R;(!z.isStreamingSupported||!z.isRangeSupported)&&(this._lastProgress&&((R=F.onProgress)==null||R.call(F,this._lastProgress)),z.onProgress=V=>{var st;(st=F.onProgress)==null||st.call(F,{loaded:V.loaded,total:V.total})}),$.resolve({isStreamingSupported:z.isStreamingSupported,isRangeSupported:z.isRangeSupported,contentLength:z.contentLength})},$.reject),$.promise}),l.on("GetRangeReader",(m,$)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const z=this._networkStream.getRangeReader(m.begin,m.end);if(!z){$.close();return}$.onPull=()=>{z.read().then(function({value:R,done:V}){if(V){$.close();return}(0,_util.assert)(R instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),$.enqueue(new Uint8Array(R),1,[R])}).catch(R=>{$.error(R)})},$.onCancel=R=>{z.cancel(R),$.ready.catch(V=>{if(!this.destroyed)throw V})}}),l.on("GetDoc",({pdfInfo:m})=>{this._numPages=m.numPages,this._htmlForXfa=m.htmlForXfa,delete m.htmlForXfa,F._capability.resolve(new PDFDocumentProxy(m,this))}),l.on("DocException",function(m){let $;switch(m.name){case"PasswordException":$=new _util.PasswordException(m.message,m.code);break;case"InvalidPDFException":$=new _util.InvalidPDFException(m.message);break;case"MissingPDFException":$=new _util.MissingPDFException(m.message);break;case"UnexpectedResponseException":$=new _util.UnexpectedResponseException(m.message,m.status);break;case"UnknownErrorException":$=new _util.UnknownErrorException(m.message,m.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}F._capability.reject($)}),l.on("PasswordRequest",m=>{if(rt(this,x,new _util.PromiseCapability),F.onPassword){const $=z=>{z instanceof Error?t(this,x).reject(z):t(this,x).resolve({password:z})};try{F.onPassword($,m.code)}catch(z){t(this,x).reject(z)}}else t(this,x).reject(new _util.PasswordException(m.message,m.code));return t(this,x).promise}),l.on("DataLoaded",m=>{var $;($=F.onProgress)==null||$.call(F,{loaded:m.length,total:m.length}),this.downloadInfoCapability.resolve(m)}),l.on("StartRenderPage",m=>{if(this.destroyed)return;t(this,E).get(m.pageIndex)._startRenderPage(m.transparency,m.cacheKey)}),l.on("commonobj",([m,$,z])=>{var R;if(!this.destroyed&&!this.commonObjs.has(m))switch($){case"Font":const V=this._params;if("error"in z){const G=z.error;(0,_util.warn)(`Error during font loading: ${G}`),this.commonObjs.resolve(m,G);break}const st=V.pdfBug&&((R=globalThis.FontInspector)!=null&&R.enabled)?(G,ct)=>globalThis.FontInspector.fontAdded(G,ct):null,at=new _font_loader.FontFaceObject(z,{isEvalSupported:V.isEvalSupported,disableFontFace:V.disableFontFace,ignoreErrors:V.ignoreErrors,inspectFont:st});this.fontLoader.bind(at).catch(G=>l.sendWithPromise("FontFallback",{id:m})).finally(()=>{!V.fontExtraProperties&&at.data&&(at.data=null),this.commonObjs.resolve(m,at)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(m,z);break;default:throw new Error(`Got unknown common object type ${$}`)}}),l.on("obj",([m,$,z,R])=>{var st;if(this.destroyed)return;const V=t(this,E).get($);if(!V.objs.has(m))switch(z){case"Image":if(V.objs.resolve(m,R),R){let at;if(R.bitmap){const{width:G,height:ct}=R;at=G*ct*4}else at=((st=R.data)==null?void 0:st.length)||0;at>_util.MAX_IMAGE_SIZE_TO_CACHE&&(V._maybeCleanupAfterRender=!0)}break;case"Pattern":V.objs.resolve(m,R);break;default:throw new Error(`Got unknown object type ${z}`)}}),l.on("DocProgress",m=>{var $;this.destroyed||($=F.onProgress)==null||$.call(F,{loaded:m.loaded,total:m.total})}),l.on("FetchBuiltInCMap",m=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(m):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),l.on("FetchStandardFontData",m=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(m):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var m;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:l,transfers:F}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:l,filename:((m=this._fullReader)==null?void 0:m.filename)??null},F).finally(()=>{this.annotationStorage.resetModified()})}getPage(l){if(!Number.isInteger(l)||l<=0||l>this._numPages)return Promise.reject(new Error("Invalid page request."));const F=l-1,m=t(this,g).get(F);if(m)return m;const $=this.messageHandler.sendWithPromise("GetPage",{pageIndex:F}).then(z=>{if(this.destroyed)throw new Error("Transport destroyed");const R=new PDFPageProxy(F,z,this,this._params.pdfBug);return t(this,E).set(F,R),R});return t(this,g).set(F,$),$}getPageIndex(l){return typeof l!="object"||l===null||!Number.isInteger(l.num)||l.num<0||!Number.isInteger(l.gen)||l.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:l.num,gen:l.gen})}getAnnotations(l,F){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:l,intent:F})}getFieldObjects(){return X(this,u,Se).call(this,"GetFieldObjects")}hasJSActions(){return X(this,u,Se).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(l){return typeof l!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:l})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return X(this,u,Se).call(this,"GetDocJSActions")}getPageJSActions(l){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:l})}getStructTree(l){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:l})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(l=>new _optional_content_config.OptionalContentConfig(l))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const l="GetMetadata",F=t(this,D).get(l);if(F)return F;const m=this.messageHandler.sendWithPromise(l,null).then($=>{var z,R;return{info:$[0],metadata:$[1]?new _metadata.Metadata($[1]):null,contentDispositionFilename:((z=this._fullReader)==null?void 0:z.filename)??null,contentLength:((R=this._fullReader)==null?void 0:R.contentLength)??null}});return t(this,D).set(l,m),m}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(l=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const F of t(this,E).values())if(!F.cleanup())throw new Error(`startCleanup: Page ${F.pageNumber} is currently rendering.`);this.commonObjs.clear(),l||this.fontLoader.clear(),t(this,D).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:l,enableXfa:F}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:l,enableXfa:F})}}D=new WeakMap,E=new WeakMap,g=new WeakMap,x=new WeakMap,u=new WeakSet,Se=function(l,F=null){const m=t(this,D).get(l);if(m)return m;const $=this.messageHandler.sendWithPromise(l,F);return t(this,D).set(l,$),$};class PDFObjects{constructor(){U(this,w);U(this,C,Object.create(null))}get(l,F=null){if(F){const $=X(this,w,Ne).call(this,l);return $.capability.promise.then(()=>F($.data)),null}const m=t(this,C)[l];if(!(m!=null&&m.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${l}.`);return m.data}has(l){const F=t(this,C)[l];return(F==null?void 0:F.capability.settled)||!1}resolve(l,F=null){const m=X(this,w,Ne).call(this,l);m.data=F,m.capability.resolve()}clear(){var l;for(const F in t(this,C)){const{data:m}=t(this,C)[F];(l=m==null?void 0:m.bitmap)==null||l.close()}rt(this,C,Object.create(null))}}C=new WeakMap,w=new WeakSet,Ne=function(l){var F;return(F=t(this,C))[l]||(F[l]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(l){U(this,a,null);rt(this,a,l),this.onContinue=null}get promise(){return t(this,a).capability.promise}cancel(l=0){t(this,a).cancel(null,l)}get separateAnnots(){const{separateAnnots:l}=t(this,a).operatorList;if(!l)return!1;const{annotationCanvasMap:F}=t(this,a);return l.form||l.canvas&&(F==null?void 0:F.size)>0}}a=new WeakMap,exports.RenderTask=RenderTask;const L=class L{constructor({callback:l,params:F,objs:m,commonObjs:$,annotationCanvasMap:z,operatorList:R,pageIndex:V,canvasFactory:st,filterFactory:at,useRequestAnimationFrame:G=!1,pdfBug:ct=!1,pageColors:gt=null}){this.callback=l,this.params=F,this.objs=m,this.commonObjs=$,this.annotationCanvasMap=z,this.operatorListIdx=null,this.operatorList=R,this._pageIndex=V,this.canvasFactory=st,this.filterFactory=at,this._pdfBug=ct,this.pageColors=gt,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=G===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=F.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:l=!1,optionalContentConfig:F}){var V,st;if(this.cancelled)return;if(this._canvas){if(t(L,c).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t(L,c).add(this._canvas)}this._pdfBug&&((V=globalThis.StepperManager)!=null&&V.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:m,viewport:$,transform:z,background:R}=this.params;this.gfx=new _canvas.CanvasGraphics(m,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:F},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:z,viewport:$,transparency:l,background:R}),this.operatorListIdx=0,this.graphicsReady=!0,(st=this.graphicsReadyCallback)==null||st.call(this)}cancel(l=null,F=0){var m;this.running=!1,this.cancelled=!0,(m=this.gfx)==null||m.endDrawing(),t(L,c).delete(this._canvas),this.callback(l||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,F))}operatorListChanged(){var l;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(l=this.stepper)==null||l.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),t(L,c).delete(this._canvas),this.callback())))}};c=new WeakMap,U(L,c,new WeakSet);let InternalRenderTask=L;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(b,e,v)=>{var S,f,I,An,E;Object.defineProperty(e,"__esModule",{value:!0}),e.SerializableEmpty=e.PrintAnnotationStorage=e.AnnotationStorage=void 0;var n=v(1),d=v(4),W=v(8);const j=Object.freeze({map:null,hash:"",transfers:void 0});e.SerializableEmpty=j;class it{constructor(){U(this,I);U(this,S,!1);U(this,f,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(x,u){const y=t(this,f).get(x);return y===void 0?u:Object.assign(u,y)}getRawValue(x){return t(this,f).get(x)}remove(x){if(t(this,f).delete(x),t(this,f).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const u of t(this,f).values())if(u instanceof d.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(x,u){const y=t(this,f).get(x);let C=!1;if(y!==void 0)for(const[w,_]of Object.entries(u))y[w]!==_&&(C=!0,y[w]=_);else C=!0,t(this,f).set(x,u);C&&X(this,I,An).call(this),u instanceof d.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(u.constructor._type)}has(x){return t(this,f).has(x)}getAll(){return t(this,f).size>0?(0,n.objectFromMap)(t(this,f)):null}setAll(x){for(const[u,y]of Object.entries(x))this.setValue(u,y)}get size(){return t(this,f).size}resetModified(){t(this,S)&&(rt(this,S,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new k(this)}get serializable(){if(t(this,f).size===0)return j;const x=new Map,u=new W.MurmurHash3_64,y=[],C=Object.create(null);let w=!1;for(const[_,a]of t(this,f)){const c=a instanceof d.AnnotationEditor?a.serialize(!1,C):a;c&&(x.set(_,c),u.update(`${_}:${JSON.stringify(c)}`),w||(w=!!c.bitmap))}if(w)for(const _ of x.values())_.bitmap&&y.push(_.bitmap);return x.size>0?{map:x,hash:u.hexdigest(),transfers:y}:j}}S=new WeakMap,f=new WeakMap,I=new WeakSet,An=function(){t(this,S)||(rt(this,S,!0),typeof this.onSetModified=="function"&&this.onSetModified())},e.AnnotationStorage=it;class k extends it{constructor(u){super();U(this,E,void 0);const{map:y,hash:C,transfers:w}=u.serializable,_=structuredClone(y,w?{transfer:w}:null);rt(this,E,{map:_,hash:C,transfers:w})}get print(){(0,n.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return t(this,E)}}E=new WeakMap,e.PrintAnnotationStorage=k},(b,e,v)=>{var k,S,f,I,D,E,g,x,u,y,C,w,_,a,c,Be,A,Ue,F,We,$,$e,R,vn,st,xn,G,En,gt,He,Et,Sn;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditor=void 0;var n=v(5),d=v(1),W=v(6);const i=class i{constructor(r){U(this,c);U(this,A);U(this,$);U(this,R);U(this,st);U(this,G);U(this,gt);U(this,Et);U(this,k,"");U(this,S,!1);U(this,f,null);U(this,I,null);U(this,D,null);U(this,E,!1);U(this,g,null);U(this,x,this.focusin.bind(this));U(this,u,this.focusout.bind(this));U(this,y,!1);U(this,C,!1);U(this,w,!1);ee(this,"_initialOptions",Object.create(null));ee(this,"_uiManager",null);ee(this,"_focusEventsAllowed",!0);ee(this,"_l10nPromise",null);U(this,_,!1);U(this,a,i._zIndex++);this.constructor===i&&(0,d.unreachable)("Cannot initialize AnnotationEditor."),this.parent=r.parent,this.id=r.id,this.width=this.height=null,this.pageIndex=r.parent.pageIndex,this.name=r.name,this.div=null,this._uiManager=r.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=r.isCentered,this._structTreeParentId=null;const{rotation:h,rawDims:{pageWidth:p,pageHeight:P,pageX:O,pageY:H}}=this.parent.viewport;this.rotation=h,this.pageRotation=(360+h-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[p,P],this.pageTranslation=[O,H];const[nt,J]=this.parentDimensions;this.x=r.x/nt,this.y=r.y/J,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,d.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(r){const h=new it({id:r.parent.getNextId(),parent:r.parent,uiManager:r._uiManager});h.annotationElementId=r.annotationElementId,h.deleted=!0,h._uiManager.addToAnnotationStorage(h)}static initialize(r,h=null){if(i._l10nPromise||(i._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(P=>[P,r.get(P)]))),h!=null&&h.strings)for(const P of h.strings)i._l10nPromise.set(P,r.get(P));if(i._borderLineWidth!==-1)return;const p=getComputedStyle(document.documentElement);i._borderLineWidth=parseFloat(p.getPropertyValue("--outline-width"))||0}static updateDefaultParams(r,h){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(r){return!1}static paste(r,h){(0,d.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return t(this,_)}set _isDraggable(r){var h;rt(this,_,r),(h=this.div)==null||h.classList.toggle("draggable",r)}center(){const[r,h]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*h/(r*2),this.y+=this.width*r/(h*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*h/(r*2),this.y-=this.width*r/(h*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(r){this._uiManager.addCommands(r)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=t(this,a)}setParent(r){r!==null&&(this.pageIndex=r.pageIndex,this.pageDimensions=r.pageDimensions),this.parent=r}focusin(r){this._focusEventsAllowed&&(t(this,y)?rt(this,y,!1):this.parent.setSelected(this))}focusout(r){var p;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const h=r.relatedTarget;h!=null&&h.closest(`#${this.id}`)||(r.preventDefault(),(p=this.parent)!=null&&p.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(r,h,p,P){const[O,H]=this.parentDimensions;[p,P]=this.screenToPageTranslation(p,P),this.x=(r+p)/O,this.y=(h+P)/H,this.fixAndSetPosition()}translate(r,h){X(this,c,Be).call(this,this.parentDimensions,r,h)}translateInPage(r,h){X(this,c,Be).call(this,this.pageDimensions,r,h),this.div.scrollIntoView({block:"nearest"})}drag(r,h){const[p,P]=this.parentDimensions;if(this.x+=r/p,this.y+=h/P,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:ot,y:ht}=this.div.getBoundingClientRect();this.parent.findNewParent(this,ot,ht)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:O,y:H}=this;const[nt,J]=X(this,A,Ue).call(this);O+=nt,H+=J,this.div.style.left=`${(100*O).toFixed(2)}%`,this.div.style.top=`${(100*H).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[r,h]=this.pageDimensions;let{x:p,y:P,width:O,height:H}=this;switch(O*=r,H*=h,p*=r,P*=h,this.rotation){case 0:p=Math.max(0,Math.min(r-O,p)),P=Math.max(0,Math.min(h-H,P));break;case 90:p=Math.max(0,Math.min(r-H,p)),P=Math.min(h,Math.max(O,P));break;case 180:p=Math.min(r,Math.max(O,p)),P=Math.min(h,Math.max(H,P));break;case 270:p=Math.min(r,Math.max(H,p)),P=Math.max(0,Math.min(h-O,P));break}this.x=p/=r,this.y=P/=h;const[nt,J]=X(this,A,Ue).call(this);p+=nt,P+=J;const{style:ot}=this.div;ot.left=`${(100*p).toFixed(2)}%`,ot.top=`${(100*P).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(r,h){var p;return X(p=i,F,We).call(p,r,h,this.parentRotation)}pageTranslationToScreen(r,h){var p;return X(p=i,F,We).call(p,r,h,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:r,pageDimensions:[h,p]}=this,P=h*r,O=p*r;return d.FeatureTest.isCSSRoundSupported?[Math.round(P),Math.round(O)]:[P,O]}setDims(r,h){var O;const[p,P]=this.parentDimensions;this.div.style.width=`${(100*r/p).toFixed(2)}%`,t(this,E)||(this.div.style.height=`${(100*h/P).toFixed(2)}%`),(O=t(this,f))==null||O.classList.toggle("small",r<i.SMALL_EDITOR_SIZE||h<i.SMALL_EDITOR_SIZE)}fixDims(){const{style:r}=this.div,{height:h,width:p}=r,P=p.endsWith("%"),O=!t(this,E)&&h.endsWith("%");if(P&&O)return;const[H,nt]=this.parentDimensions;P||(r.width=`${(100*parseFloat(p)/H).toFixed(2)}%`),!t(this,E)&&!O&&(r.height=`${(100*parseFloat(h)/nt).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(t(this,f))return;const r=rt(this,f,document.createElement("button"));r.className="altText";const h=await i._l10nPromise.get("editor_alt_text_button_label");r.textContent=h,r.setAttribute("aria-label",h),r.tabIndex="0",r.addEventListener("contextmenu",W.noContextMenu),r.addEventListener("pointerdown",p=>p.stopPropagation()),r.addEventListener("click",p=>{p.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),r.addEventListener("keydown",p=>{p.target===r&&p.key==="Enter"&&(p.preventDefault(),this._uiManager.editAltText(this))}),X(this,gt,He).call(this),this.div.append(r),i.SMALL_EDITOR_SIZE||(i.SMALL_EDITOR_SIZE=Math.min(128,Math.round(r.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:t(this,k),decorative:t(this,S)}}set altTextData({altText:r,decorative:h}){t(this,k)===r&&t(this,S)===h||(rt(this,k,r),rt(this,S,h),X(this,gt,He).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",t(this,x)),this.div.addEventListener("focusout",t(this,u));const[r,h]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*h/r).toFixed(2)}%`,this.div.style.maxHeight=`${(100*r/h).toFixed(2)}%`);const[p,P]=this.getInitialTranslation();return this.translate(p,P),(0,n.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(r){const{isMac:h}=d.FeatureTest.platform;if(r.button!==0||r.ctrlKey&&h){r.preventDefault();return}rt(this,y,!0),X(this,Et,Sn).call(this,r)}moveInDOM(){var r;(r=this.parent)==null||r.moveEditorInDOM(this)}_setParentAndPosition(r,h,p){r.changeParent(this),this.x=h,this.y=p,this.fixAndSetPosition()}getRect(r,h){const p=this.parentScale,[P,O]=this.pageDimensions,[H,nt]=this.pageTranslation,J=r/p,ot=h/p,ht=this.x*P,ft=this.y*O,dt=this.width*P,wt=this.height*O;switch(this.rotation){case 0:return[ht+J+H,O-ft-ot-wt+nt,ht+J+dt+H,O-ft-ot+nt];case 90:return[ht+ot+H,O-ft+J+nt,ht+ot+wt+H,O-ft+J+dt+nt];case 180:return[ht-J-dt+H,O-ft+ot+nt,ht-J+H,O-ft+ot+wt+nt];case 270:return[ht-ot-wt+H,O-ft-J-dt+nt,ht-ot+H,O-ft-J+nt];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(r,h){const[p,P,O,H]=r,nt=O-p,J=H-P;switch(this.rotation){case 0:return[p,h-H,nt,J];case 90:return[p,h-P,J,nt];case 180:return[O,h-P,nt,J];case 270:return[O,h-H,J,nt];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){rt(this,w,!0)}disableEditMode(){rt(this,w,!1)}isInEditMode(){return t(this,w)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var r,h;(r=this.div)==null||r.addEventListener("focusin",t(this,x)),(h=this.div)==null||h.addEventListener("focusout",t(this,u))}serialize(r=!1,h=null){(0,d.unreachable)("An editor must be serializable")}static deserialize(r,h,p){const P=new this.prototype.constructor({parent:h,id:h.getNextId(),uiManager:p});P.rotation=r.rotation;const[O,H]=P.pageDimensions,[nt,J,ot,ht]=P.getRectInCurrentCoords(r.rect,H);return P.x=nt/O,P.y=J/H,P.width=ot/O,P.height=ht/H,P}remove(){var r;this.div.removeEventListener("focusin",t(this,x)),this.div.removeEventListener("focusout",t(this,u)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(r=t(this,f))==null||r.remove(),rt(this,f,null),rt(this,I,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(X(this,R,vn).call(this),t(this,g).classList.remove("hidden"))}select(){var r;this.makeResizable(),(r=this.div)==null||r.classList.add("selectedEditor")}unselect(){var r,h,p;(r=t(this,g))==null||r.classList.add("hidden"),(h=this.div)==null||h.classList.remove("selectedEditor"),(p=this.div)!=null&&p.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(r,h){}disableEditing(){t(this,f)&&(t(this,f).hidden=!0)}enableEditing(){t(this,f)&&(t(this,f).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return t(this,C)}set isEditing(r){rt(this,C,r),this.parent&&(r?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(r,h){rt(this,E,!0);const p=r/h,{style:P}=this.div;P.aspectRatio=p,P.height="auto"}static get MIN_SIZE(){return 16}};k=new WeakMap,S=new WeakMap,f=new WeakMap,I=new WeakMap,D=new WeakMap,E=new WeakMap,g=new WeakMap,x=new WeakMap,u=new WeakMap,y=new WeakMap,C=new WeakMap,w=new WeakMap,_=new WeakMap,a=new WeakMap,c=new WeakSet,Be=function([r,h],p,P){[p,P]=this.screenToPageTranslation(p,P),this.x+=p/r,this.y+=P/h,this.fixAndSetPosition()},A=new WeakSet,Ue=function(){const[r,h]=this.parentDimensions,{_borderLineWidth:p}=i,P=p/r,O=p/h;switch(this.rotation){case 90:return[-P,O];case 180:return[P,O];case 270:return[P,-O];default:return[-P,-O]}},F=new WeakSet,We=function(r,h,p){switch(p){case 90:return[h,-r];case 180:return[-r,-h];case 270:return[-h,r];default:return[r,h]}},$=new WeakSet,$e=function(r){switch(r){case 90:{const[h,p]=this.pageDimensions;return[0,-h/p,p/h,0]}case 180:return[-1,0,0,-1];case 270:{const[h,p]=this.pageDimensions;return[0,h/p,-p/h,0]}default:return[1,0,0,1]}},R=new WeakSet,vn=function(){if(t(this,g))return;rt(this,g,document.createElement("div")),t(this,g).classList.add("resizers");const r=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||r.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const h of r){const p=document.createElement("div");t(this,g).append(p),p.classList.add("resizer",h),p.addEventListener("pointerdown",X(this,st,xn).bind(this,h)),p.addEventListener("contextmenu",W.noContextMenu)}this.div.prepend(t(this,g))},st=new WeakSet,xn=function(r,h){h.preventDefault();const{isMac:p}=d.FeatureTest.platform;if(h.button!==0||h.ctrlKey&&p)return;const P=X(this,G,En).bind(this,r),O=this._isDraggable;this._isDraggable=!1;const H={passive:!0,capture:!0};window.addEventListener("pointermove",P,H);const nt=this.x,J=this.y,ot=this.width,ht=this.height,ft=this.parent.div.style.cursor,dt=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(h.target).cursor;const wt=()=>{this._isDraggable=O,window.removeEventListener("pointerup",wt),window.removeEventListener("blur",wt),window.removeEventListener("pointermove",P,H),this.parent.div.style.cursor=ft,this.div.style.cursor=dt;const Lt=this.x,vt=this.y,Dt=this.width,mt=this.height;Lt===nt&&vt===J&&Dt===ot&&mt===ht||this.addCommands({cmd:()=>{this.width=Dt,this.height=mt,this.x=Lt,this.y=vt;const[et,Q]=this.parentDimensions;this.setDims(et*Dt,Q*mt),this.fixAndSetPosition()},undo:()=>{this.width=ot,this.height=ht,this.x=nt,this.y=J;const[et,Q]=this.parentDimensions;this.setDims(et*ot,Q*ht),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",wt),window.addEventListener("blur",wt)},G=new WeakSet,En=function(r,h){const[p,P]=this.parentDimensions,O=this.x,H=this.y,nt=this.width,J=this.height,ot=i.MIN_SIZE/p,ht=i.MIN_SIZE/P,ft=yt=>Math.round(yt*1e4)/1e4,dt=X(this,$,$e).call(this,this.rotation),wt=(yt,At)=>[dt[0]*yt+dt[2]*At,dt[1]*yt+dt[3]*At],Lt=X(this,$,$e).call(this,360-this.rotation),vt=(yt,At)=>[Lt[0]*yt+Lt[2]*At,Lt[1]*yt+Lt[3]*At];let Dt,mt,et=!1,Q=!1;switch(r){case"topLeft":et=!0,Dt=(yt,At)=>[0,0],mt=(yt,At)=>[yt,At];break;case"topMiddle":Dt=(yt,At)=>[yt/2,0],mt=(yt,At)=>[yt/2,At];break;case"topRight":et=!0,Dt=(yt,At)=>[yt,0],mt=(yt,At)=>[0,At];break;case"middleRight":Q=!0,Dt=(yt,At)=>[yt,At/2],mt=(yt,At)=>[0,At/2];break;case"bottomRight":et=!0,Dt=(yt,At)=>[yt,At],mt=(yt,At)=>[0,0];break;case"bottomMiddle":Dt=(yt,At)=>[yt/2,At],mt=(yt,At)=>[yt/2,0];break;case"bottomLeft":et=!0,Dt=(yt,At)=>[0,At],mt=(yt,At)=>[yt,0];break;case"middleLeft":Q=!0,Dt=(yt,At)=>[0,At/2],mt=(yt,At)=>[yt,At/2];break}const pt=Dt(nt,J),Tt=mt(nt,J);let Ct=wt(...Tt);const Ut=ft(O+Ct[0]),zt=ft(H+Ct[1]);let Wt=1,$t=1,[Gt,Bt]=this.screenToPageTranslation(h.movementX,h.movementY);if([Gt,Bt]=vt(Gt/p,Bt/P),et){const yt=Math.hypot(nt,J);Wt=$t=Math.max(Math.min(Math.hypot(Tt[0]-pt[0]-Gt,Tt[1]-pt[1]-Bt)/yt,1/nt,1/J),ot/nt,ht/J)}else Q?Wt=Math.max(ot,Math.min(1,Math.abs(Tt[0]-pt[0]-Gt)))/nt:$t=Math.max(ht,Math.min(1,Math.abs(Tt[1]-pt[1]-Bt)))/J;const Xt=ft(nt*Wt),ut=ft(J*$t);Ct=wt(...mt(Xt,ut));const tt=Ut-Ct[0],Y=zt-Ct[1];this.width=Xt,this.height=ut,this.x=tt,this.y=Y,this.setDims(p*Xt,P*ut),this.fixAndSetPosition()},gt=new WeakSet,He=async function(){var p;const r=t(this,f);if(!r)return;if(!t(this,k)&&!t(this,S)){r.classList.remove("done"),(p=t(this,I))==null||p.remove();return}i._l10nPromise.get("editor_alt_text_edit_button_label").then(P=>{r.setAttribute("aria-label",P)});let h=t(this,I);if(!h){rt(this,I,h=document.createElement("span")),h.className="tooltip",h.setAttribute("role","tooltip");const P=h.id=`alt-text-tooltip-${this.id}`;r.setAttribute("aria-describedby",P);const O=100;r.addEventListener("mouseenter",()=>{rt(this,D,setTimeout(()=>{rt(this,D,null),t(this,I).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},O))}),r.addEventListener("mouseleave",()=>{var H;clearTimeout(t(this,D)),rt(this,D,null),(H=t(this,I))==null||H.classList.remove("show")})}r.classList.add("done"),h.innerText=t(this,S)?await i._l10nPromise.get("editor_alt_text_decorative_tooltip"):t(this,k),h.parentNode||r.append(h)},Et=new WeakSet,Sn=function(r){if(!this._isDraggable)return;const h=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let p,P;h&&(p={passive:!0,capture:!0},P=H=>{const[nt,J]=this.screenToPageTranslation(H.movementX,H.movementY);this._uiManager.dragSelectedEditors(nt,J)},window.addEventListener("pointermove",P,p));const O=()=>{if(window.removeEventListener("pointerup",O),window.removeEventListener("blur",O),h&&window.removeEventListener("pointermove",P,p),rt(this,y,!1),!this._uiManager.endDragSession()){const{isMac:H}=d.FeatureTest.platform;r.ctrlKey&&!H||r.shiftKey||r.metaKey&&H?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",O),window.addEventListener("blur",O)},U(i,F),ee(i,"_borderLineWidth",-1),ee(i,"_colorManager",new n.ColorManager),ee(i,"_zIndex",1),ee(i,"SMALL_EDITOR_SIZE",0);let j=i;e.AnnotationEditor=j;class it extends j{constructor(r){super(r),this.annotationElementId=r.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(b,e,v)=>{var E,g,x,u,y,ze,_,a,c,L,A,Tn,m,$,z,R,V,st,at,G,ct,gt,xt,Et,M,i,o,r,h,p,P,O,H,nt,J,ot,ht,ft,dt,wt,Lt,vt,Dt,mt,et,Q,pt,Cn,Ct,Ge,zt,qe,$t,Te,Bt,Ve,ut,Xe,Y,re,At,me,Qt,wn,St,Rn,Rt,Ye,Nt,be,_t,Ke;Object.defineProperty(e,"__esModule",{value:!0}),e.KeyboardManager=e.CommandManager=e.ColorManager=e.AnnotationEditorUIManager=void 0,e.bindEvents=W,e.opacityToHex=j;var n=v(1),d=v(6);function W(N,s,T){for(const B of T)s.addEventListener(B,N[B].bind(N))}function j(N){return Math.round(Math.min(255,Math.max(1,255*N))).toString(16).padStart(2,"0")}class it{constructor(){U(this,E,0)}getId(){return`${n.AnnotationEditorPrefix}${ge(this,E)._++}`}}E=new WeakMap;const w=class w{constructor(){U(this,y);U(this,g,(0,n.getUuid)());U(this,x,0);U(this,u,null)}static get _isSVGFittingCanvas(){const s='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',B=new OffscreenCanvas(1,3).getContext("2d"),q=new Image;q.src=s;const K=q.decode().then(()=>(B.drawImage(q,0,0,1,1,0,0,1,3),new Uint32Array(B.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,n.shadow)(this,"_isSVGFittingCanvas",K)}async getFromFile(s){const{lastModified:T,name:B,size:q,type:K}=s;return X(this,y,ze).call(this,`${T}_${B}_${q}_${K}`,s)}async getFromUrl(s){return X(this,y,ze).call(this,s,s)}async getFromId(s){t(this,u)||rt(this,u,new Map);const T=t(this,u).get(s);return T?T.bitmap?(T.refCounter+=1,T):T.file?this.getFromFile(T.file):this.getFromUrl(T.url):null}getSvgUrl(s){const T=t(this,u).get(s);return T!=null&&T.isSvg?T.svgUrl:null}deleteId(s){t(this,u)||rt(this,u,new Map);const T=t(this,u).get(s);T&&(T.refCounter-=1,T.refCounter===0&&(T.bitmap=null))}isValidId(s){return s.startsWith(`image_${t(this,g)}_`)}};g=new WeakMap,x=new WeakMap,u=new WeakMap,y=new WeakSet,ze=async function(s,T){t(this,u)||rt(this,u,new Map);let B=t(this,u).get(s);if(B===null)return null;if(B!=null&&B.bitmap)return B.refCounter+=1,B;try{B||(B={bitmap:null,id:`image_${t(this,g)}_${ge(this,x)._++}`,refCounter:0,isSvg:!1});let q;if(typeof T=="string"){B.url=T;const K=await fetch(T);if(!K.ok)throw new Error(K.statusText);q=await K.blob()}else q=B.file=T;if(q.type==="image/svg+xml"){const K=w._isSVGFittingCanvas,lt=new FileReader,bt=new Image,kt=new Promise((Pt,qt)=>{bt.onload=()=>{B.bitmap=bt,B.isSvg=!0,Pt()},lt.onload=async()=>{const Ft=B.svgUrl=lt.result;bt.src=await K?`${Ft}#svgView(preserveAspectRatio(none))`:Ft},bt.onerror=lt.onerror=qt});lt.readAsDataURL(q),await kt}else B.bitmap=await createImageBitmap(q);B.refCounter=1}catch(q){console.error(q),B=null}return t(this,u).set(s,B),B&&t(this,u).set(B.id,B),B};let k=w;class S{constructor(s=128){U(this,_,[]);U(this,a,!1);U(this,c,void 0);U(this,L,-1);rt(this,c,s)}add({cmd:s,undo:T,mustExec:B,type:q=NaN,overwriteIfSameType:K=!1,keepUndo:lt=!1}){if(B&&s(),t(this,a))return;const bt={cmd:s,undo:T,type:q};if(t(this,L)===-1){t(this,_).length>0&&(t(this,_).length=0),rt(this,L,0),t(this,_).push(bt);return}if(K&&t(this,_)[t(this,L)].type===q){lt&&(bt.undo=t(this,_)[t(this,L)].undo),t(this,_)[t(this,L)]=bt;return}const kt=t(this,L)+1;kt===t(this,c)?t(this,_).splice(0,1):(rt(this,L,kt),kt<t(this,_).length&&t(this,_).splice(kt)),t(this,_).push(bt)}undo(){t(this,L)!==-1&&(rt(this,a,!0),t(this,_)[t(this,L)].undo(),rt(this,a,!1),rt(this,L,t(this,L)-1))}redo(){t(this,L)<t(this,_).length-1&&(rt(this,L,t(this,L)+1),rt(this,a,!0),t(this,_)[t(this,L)].cmd(),rt(this,a,!1))}hasSomethingToUndo(){return t(this,L)!==-1}hasSomethingToRedo(){return t(this,L)<t(this,_).length-1}destroy(){rt(this,_,null)}}_=new WeakMap,a=new WeakMap,c=new WeakMap,L=new WeakMap,e.CommandManager=S;class f{constructor(s){U(this,A);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:T}=n.FeatureTest.platform;for(const[B,q,K={}]of s)for(const lt of B){const bt=lt.startsWith("mac+");T&&bt?(this.callbacks.set(lt.slice(4),{callback:q,options:K}),this.allKeys.add(lt.split("+").at(-1))):!T&&!bt&&(this.callbacks.set(lt,{callback:q,options:K}),this.allKeys.add(lt.split("+").at(-1)))}}exec(s,T){if(!this.allKeys.has(T.key))return;const B=this.callbacks.get(X(this,A,Tn).call(this,T));if(!B)return;const{callback:q,options:{bubbles:K=!1,args:lt=[],checker:bt=null}}=B;bt&&!bt(s,T)||(q.bind(s,...lt)(),K||(T.stopPropagation(),T.preventDefault()))}}A=new WeakSet,Tn=function(s){s.altKey&&this.buffer.push("alt"),s.ctrlKey&&this.buffer.push("ctrl"),s.metaKey&&this.buffer.push("meta"),s.shiftKey&&this.buffer.push("shift"),this.buffer.push(s.key);const T=this.buffer.join("+");return this.buffer.length=0,T},e.KeyboardManager=f;const F=class F{get _colors(){const s=new Map([["CanvasText",null],["Canvas",null]]);return(0,d.getColorValues)(s),(0,n.shadow)(this,"_colors",s)}convert(s){const T=(0,d.getRGB)(s);if(!window.matchMedia("(forced-colors: active)").matches)return T;for(const[B,q]of this._colors)if(q.every((K,lt)=>K===T[lt]))return F._colorsMapping.get(B);return T}getHexCode(s){const T=this._colors.get(s);return T?n.Util.makeHexColor(...T):s}};ee(F,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let I=F;e.ColorManager=I;const It=class It{constructor(s,T,B,q,K,lt){U(this,pt);U(this,Ct);U(this,zt);U(this,$t);U(this,Bt);U(this,ut);U(this,Y);U(this,At);U(this,Qt);U(this,St);U(this,Rt);U(this,Nt);U(this,_t);U(this,m,null);U(this,$,new Map);U(this,z,new Map);U(this,R,null);U(this,V,null);U(this,st,new S);U(this,at,0);U(this,G,new Set);U(this,ct,null);U(this,gt,null);U(this,xt,new Set);U(this,Et,null);U(this,M,new it);U(this,i,!1);U(this,o,!1);U(this,r,null);U(this,h,n.AnnotationEditorType.NONE);U(this,p,new Set);U(this,P,null);U(this,O,this.blur.bind(this));U(this,H,this.focus.bind(this));U(this,nt,this.copy.bind(this));U(this,J,this.cut.bind(this));U(this,ot,this.paste.bind(this));U(this,ht,this.keydown.bind(this));U(this,ft,this.onEditingAction.bind(this));U(this,dt,this.onPageChanging.bind(this));U(this,wt,this.onScaleChanging.bind(this));U(this,Lt,this.onRotationChanging.bind(this));U(this,vt,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});U(this,Dt,[0,0]);U(this,mt,null);U(this,et,null);U(this,Q,null);rt(this,et,s),rt(this,Q,T),rt(this,R,B),this._eventBus=q,this._eventBus._on("editingaction",t(this,ft)),this._eventBus._on("pagechanging",t(this,dt)),this._eventBus._on("scalechanging",t(this,wt)),this._eventBus._on("rotationchanging",t(this,Lt)),rt(this,V,K.annotationStorage),rt(this,Et,K.filterFactory),rt(this,P,lt),this.viewParameters={realScale:d.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const s=It.prototype,T=K=>{const{activeElement:lt}=document;return lt&&t(K,et).contains(lt)&&K.hasSomethingToControl()},B=this.TRANSLATE_SMALL,q=this.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new f([[["ctrl+a","mac+meta+a"],s.selectAll],[["ctrl+z","mac+meta+z"],s.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],s.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],s.delete],[["Escape","mac+Escape"],s.unselectAll],[["ArrowLeft","mac+ArrowLeft"],s.translateSelectedEditors,{args:[-B,0],checker:T}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],s.translateSelectedEditors,{args:[-q,0],checker:T}],[["ArrowRight","mac+ArrowRight"],s.translateSelectedEditors,{args:[B,0],checker:T}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],s.translateSelectedEditors,{args:[q,0],checker:T}],[["ArrowUp","mac+ArrowUp"],s.translateSelectedEditors,{args:[0,-B],checker:T}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],s.translateSelectedEditors,{args:[0,-q],checker:T}],[["ArrowDown","mac+ArrowDown"],s.translateSelectedEditors,{args:[0,B],checker:T}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],s.translateSelectedEditors,{args:[0,q],checker:T}]]))}destroy(){X(this,$t,Te).call(this),X(this,Ct,Ge).call(this),this._eventBus._off("editingaction",t(this,ft)),this._eventBus._off("pagechanging",t(this,dt)),this._eventBus._off("scalechanging",t(this,wt)),this._eventBus._off("rotationchanging",t(this,Lt));for(const s of t(this,z).values())s.destroy();t(this,z).clear(),t(this,$).clear(),t(this,xt).clear(),rt(this,m,null),t(this,p).clear(),t(this,st).destroy(),t(this,R).destroy()}get hcmFilter(){return(0,n.shadow)(this,"hcmFilter",t(this,P)?t(this,Et).addHCMFilter(t(this,P).foreground,t(this,P).background):"none")}get direction(){return(0,n.shadow)(this,"direction",getComputedStyle(t(this,et)).direction)}editAltText(s){var T;(T=t(this,R))==null||T.editAltText(this,s)}onPageChanging({pageNumber:s}){rt(this,at,s-1)}focusMainContainer(){t(this,et).focus()}findParent(s,T){for(const B of t(this,z).values()){const{x:q,y:K,width:lt,height:bt}=B.div.getBoundingClientRect();if(s>=q&&s<=q+lt&&T>=K&&T<=K+bt)return B}return null}disableUserSelect(s=!1){t(this,Q).classList.toggle("noUserSelect",s)}addShouldRescale(s){t(this,xt).add(s)}removeShouldRescale(s){t(this,xt).delete(s)}onScaleChanging({scale:s}){this.commitOrRemove(),this.viewParameters.realScale=s*d.PixelsPerInch.PDF_TO_CSS_UNITS;for(const T of t(this,xt))T.onScaleChanging()}onRotationChanging({pagesRotation:s}){this.commitOrRemove(),this.viewParameters.rotation=s}addToAnnotationStorage(s){!s.isEmpty()&&t(this,V)&&!t(this,V).has(s.id)&&t(this,V).setValue(s.id,s)}blur(){if(!this.hasSelection)return;const{activeElement:s}=document;for(const T of t(this,p))if(T.div.contains(s)){rt(this,r,[T,s]),T._focusEventsAllowed=!1;break}}focus(){if(!t(this,r))return;const[s,T]=t(this,r);rt(this,r,null),T.addEventListener("focusin",()=>{s._focusEventsAllowed=!0},{once:!0}),T.focus()}addEditListeners(){X(this,zt,qe).call(this),X(this,Bt,Ve).call(this)}removeEditListeners(){X(this,$t,Te).call(this),X(this,ut,Xe).call(this)}copy(s){var B;if(s.preventDefault(),(B=t(this,m))==null||B.commitOrRemove(),!this.hasSelection)return;const T=[];for(const q of t(this,p)){const K=q.serialize(!0);K&&T.push(K)}T.length!==0&&s.clipboardData.setData("application/pdfjs",JSON.stringify(T))}cut(s){this.copy(s),this.delete()}paste(s){s.preventDefault();const{clipboardData:T}=s;for(const K of T.items)for(const lt of t(this,gt))if(lt.isHandlingMimeForPasting(K.type)){lt.paste(K,this.currentLayer);return}let B=T.getData("application/pdfjs");if(!B)return;try{B=JSON.parse(B)}catch(K){(0,n.warn)(`paste: "${K.message}".`);return}if(!Array.isArray(B))return;this.unselectAll();const q=this.currentLayer;try{const K=[];for(const kt of B){const Pt=q.deserialize(kt);if(!Pt)return;K.push(Pt)}const lt=()=>{for(const kt of K)X(this,Rt,Ye).call(this,kt);X(this,_t,Ke).call(this,K)},bt=()=>{for(const kt of K)kt.remove()};this.addCommands({cmd:lt,undo:bt,mustExec:!0})}catch(K){(0,n.warn)(`paste: "${K.message}".`)}}keydown(s){var T;(T=this.getActive())!=null&&T.shouldGetKeyboardEvents()||It._keyboardManager.exec(this,s)}onEditingAction(s){["undo","redo","delete","selectAll"].includes(s.name)&&this[s.name]()}setEditingState(s){s?(X(this,pt,Cn).call(this),X(this,zt,qe).call(this),X(this,Bt,Ve).call(this),X(this,Y,re).call(this,{isEditing:t(this,h)!==n.AnnotationEditorType.NONE,isEmpty:X(this,Nt,be).call(this),hasSomethingToUndo:t(this,st).hasSomethingToUndo(),hasSomethingToRedo:t(this,st).hasSomethingToRedo(),hasSelectedEditor:!1})):(X(this,Ct,Ge).call(this),X(this,$t,Te).call(this),X(this,ut,Xe).call(this),X(this,Y,re).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(s){if(!t(this,gt)){rt(this,gt,s);for(const T of t(this,gt))X(this,At,me).call(this,T.defaultPropertiesToUpdate)}}getId(){return t(this,M).getId()}get currentLayer(){return t(this,z).get(t(this,at))}getLayer(s){return t(this,z).get(s)}get currentPageIndex(){return t(this,at)}addLayer(s){t(this,z).set(s.pageIndex,s),t(this,i)?s.enable():s.disable()}removeLayer(s){t(this,z).delete(s.pageIndex)}updateMode(s,T=null){if(t(this,h)!==s){if(rt(this,h,s),s===n.AnnotationEditorType.NONE){this.setEditingState(!1),X(this,St,Rn).call(this);return}this.setEditingState(!0),X(this,Qt,wn).call(this),this.unselectAll();for(const B of t(this,z).values())B.updateMode(s);if(T){for(const B of t(this,$).values())if(B.annotationElementId===T){this.setSelected(B),B.enterInEditMode();break}}}}updateToolbar(s){s!==t(this,h)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:s})}updateParams(s,T){if(t(this,gt)){if(s===n.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(s);return}for(const B of t(this,p))B.updateParams(s,T);for(const B of t(this,gt))B.updateDefaultParams(s,T)}}enableWaiting(s=!1){if(t(this,o)!==s){rt(this,o,s);for(const T of t(this,z).values())s?T.disableClick():T.enableClick(),T.div.classList.toggle("waiting",s)}}getEditors(s){const T=[];for(const B of t(this,$).values())B.pageIndex===s&&T.push(B);return T}getEditor(s){return t(this,$).get(s)}addEditor(s){t(this,$).set(s.id,s)}removeEditor(s){var T;t(this,$).delete(s.id),this.unselect(s),(!s.annotationElementId||!t(this,G).has(s.annotationElementId))&&((T=t(this,V))==null||T.remove(s.id))}addDeletedAnnotationElement(s){t(this,G).add(s.annotationElementId),s.deleted=!0}isDeletedAnnotationElement(s){return t(this,G).has(s)}removeDeletedAnnotationElement(s){t(this,G).delete(s.annotationElementId),s.deleted=!1}setActiveEditor(s){t(this,m)!==s&&(rt(this,m,s),s&&X(this,At,me).call(this,s.propertiesToUpdate))}toggleSelected(s){if(t(this,p).has(s)){t(this,p).delete(s),s.unselect(),X(this,Y,re).call(this,{hasSelectedEditor:this.hasSelection});return}t(this,p).add(s),s.select(),X(this,At,me).call(this,s.propertiesToUpdate),X(this,Y,re).call(this,{hasSelectedEditor:!0})}setSelected(s){for(const T of t(this,p))T!==s&&T.unselect();t(this,p).clear(),t(this,p).add(s),s.select(),X(this,At,me).call(this,s.propertiesToUpdate),X(this,Y,re).call(this,{hasSelectedEditor:!0})}isSelected(s){return t(this,p).has(s)}unselect(s){s.unselect(),t(this,p).delete(s),X(this,Y,re).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return t(this,p).size!==0}undo(){t(this,st).undo(),X(this,Y,re).call(this,{hasSomethingToUndo:t(this,st).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:X(this,Nt,be).call(this)})}redo(){t(this,st).redo(),X(this,Y,re).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:t(this,st).hasSomethingToRedo(),isEmpty:X(this,Nt,be).call(this)})}addCommands(s){t(this,st).add(s),X(this,Y,re).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:X(this,Nt,be).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const s=[...t(this,p)],T=()=>{for(const q of s)q.remove()},B=()=>{for(const q of s)X(this,Rt,Ye).call(this,q)};this.addCommands({cmd:T,undo:B,mustExec:!0})}commitOrRemove(){var s;(s=t(this,m))==null||s.commitOrRemove()}hasSomethingToControl(){return t(this,m)||this.hasSelection}selectAll(){for(const s of t(this,p))s.commit();X(this,_t,Ke).call(this,t(this,$).values())}unselectAll(){if(t(this,m)){t(this,m).commitOrRemove();return}if(this.hasSelection){for(const s of t(this,p))s.unselect();t(this,p).clear(),X(this,Y,re).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(s,T,B=!1){if(B||this.commitOrRemove(),!this.hasSelection)return;t(this,Dt)[0]+=s,t(this,Dt)[1]+=T;const[q,K]=t(this,Dt),lt=[...t(this,p)],bt=1e3;t(this,mt)&&clearTimeout(t(this,mt)),rt(this,mt,setTimeout(()=>{rt(this,mt,null),t(this,Dt)[0]=t(this,Dt)[1]=0,this.addCommands({cmd:()=>{for(const kt of lt)t(this,$).has(kt.id)&&kt.translateInPage(q,K)},undo:()=>{for(const kt of lt)t(this,$).has(kt.id)&&kt.translateInPage(-q,-K)},mustExec:!1})},bt));for(const kt of lt)kt.translateInPage(s,T)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),rt(this,ct,new Map);for(const s of t(this,p))t(this,ct).set(s,{savedX:s.x,savedY:s.y,savedPageIndex:s.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!t(this,ct))return!1;this.disableUserSelect(!1);const s=t(this,ct);rt(this,ct,null);let T=!1;for(const[{x:q,y:K,pageIndex:lt},bt]of s)bt.newX=q,bt.newY=K,bt.newPageIndex=lt,T||(T=q!==bt.savedX||K!==bt.savedY||lt!==bt.savedPageIndex);if(!T)return!1;const B=(q,K,lt,bt)=>{if(t(this,$).has(q.id)){const kt=t(this,z).get(bt);kt?q._setParentAndPosition(kt,K,lt):(q.pageIndex=bt,q.x=K,q.y=lt)}};return this.addCommands({cmd:()=>{for(const[q,{newX:K,newY:lt,newPageIndex:bt}]of s)B(q,K,lt,bt)},undo:()=>{for(const[q,{savedX:K,savedY:lt,savedPageIndex:bt}]of s)B(q,K,lt,bt)},mustExec:!0}),!0}dragSelectedEditors(s,T){if(t(this,ct))for(const B of t(this,ct).keys())B.drag(s,T)}rebuild(s){if(s.parent===null){const T=this.getLayer(s.pageIndex);T?(T.changeParent(s),T.addOrRebuild(s)):(this.addEditor(s),this.addToAnnotationStorage(s),s.rebuild())}else s.parent.addOrRebuild(s)}isActive(s){return t(this,m)===s}getActive(){return t(this,m)}getMode(){return t(this,h)}get imageManager(){return(0,n.shadow)(this,"imageManager",new k)}};m=new WeakMap,$=new WeakMap,z=new WeakMap,R=new WeakMap,V=new WeakMap,st=new WeakMap,at=new WeakMap,G=new WeakMap,ct=new WeakMap,gt=new WeakMap,xt=new WeakMap,Et=new WeakMap,M=new WeakMap,i=new WeakMap,o=new WeakMap,r=new WeakMap,h=new WeakMap,p=new WeakMap,P=new WeakMap,O=new WeakMap,H=new WeakMap,nt=new WeakMap,J=new WeakMap,ot=new WeakMap,ht=new WeakMap,ft=new WeakMap,dt=new WeakMap,wt=new WeakMap,Lt=new WeakMap,vt=new WeakMap,Dt=new WeakMap,mt=new WeakMap,et=new WeakMap,Q=new WeakMap,pt=new WeakSet,Cn=function(){window.addEventListener("focus",t(this,H)),window.addEventListener("blur",t(this,O))},Ct=new WeakSet,Ge=function(){window.removeEventListener("focus",t(this,H)),window.removeEventListener("blur",t(this,O))},zt=new WeakSet,qe=function(){window.addEventListener("keydown",t(this,ht),{capture:!0})},$t=new WeakSet,Te=function(){window.removeEventListener("keydown",t(this,ht),{capture:!0})},Bt=new WeakSet,Ve=function(){document.addEventListener("copy",t(this,nt)),document.addEventListener("cut",t(this,J)),document.addEventListener("paste",t(this,ot))},ut=new WeakSet,Xe=function(){document.removeEventListener("copy",t(this,nt)),document.removeEventListener("cut",t(this,J)),document.removeEventListener("paste",t(this,ot))},Y=new WeakSet,re=function(s){Object.entries(s).some(([B,q])=>t(this,vt)[B]!==q)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(t(this,vt),s)})},At=new WeakSet,me=function(s){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:s})},Qt=new WeakSet,wn=function(){if(!t(this,i)){rt(this,i,!0);for(const s of t(this,z).values())s.enable()}},St=new WeakSet,Rn=function(){if(this.unselectAll(),t(this,i)){rt(this,i,!1);for(const s of t(this,z).values())s.disable()}},Rt=new WeakSet,Ye=function(s){const T=t(this,z).get(s.pageIndex);T?T.addOrRebuild(s):this.addEditor(s)},Nt=new WeakSet,be=function(){if(t(this,$).size===0)return!0;if(t(this,$).size===1)for(const s of t(this,$).values())return s.isEmpty();return!1},_t=new WeakSet,Ke=function(s){t(this,p).clear();for(const T of s)T.isEmpty()||(t(this,p).add(T),T.select());X(this,Y,re).call(this,{hasSelectedEditor:!0})},ee(It,"TRANSLATE_SMALL",1),ee(It,"TRANSLATE_BIG",10);let D=It;e.AnnotationEditorUIManager=D},(b,e,v)=>{var at,G,ct,gt,xt,Et,M,i,o,r,h,p,de,O,ue,nt,Je,ot,Ce,ft,we,wt,ye,vt,_e;Object.defineProperty(e,"__esModule",{value:!0}),e.StatTimer=e.RenderingCancelledException=e.PixelsPerInch=e.PageViewport=e.PDFDateString=e.DOMStandardFontDataFactory=e.DOMSVGFactory=e.DOMFilterFactory=e.DOMCanvasFactory=e.DOMCMapReaderFactory=void 0,e.deprecated=L,e.getColorValues=$,e.getCurrentTransform=z,e.getCurrentTransformInverse=R,e.getFilenameFromUrl=y,e.getPdfFilenameFromUrl=C,e.getRGB=m,e.getXfaPageViewport=F,e.isDataScheme=x,e.isPdfFile=u,e.isValidFetchUrl=_,e.loadScript=c,e.noContextMenu=a,e.setLayerDimensions=V;var n=v(7),d=v(1);const W="http://www.w3.org/2000/svg",st=class st{};ee(st,"CSS",96),ee(st,"PDF",72),ee(st,"PDF_TO_CSS_UNITS",st.CSS/st.PDF);let j=st;e.PixelsPerInch=j;class it extends n.BaseFilterFactory{constructor({docId:Q,ownerDocument:pt=globalThis.document}={}){super();U(this,p);U(this,O);U(this,nt);U(this,ot);U(this,ft);U(this,wt);U(this,vt);U(this,at,void 0);U(this,G,void 0);U(this,ct,void 0);U(this,gt,void 0);U(this,xt,void 0);U(this,Et,void 0);U(this,M,void 0);U(this,i,void 0);U(this,o,void 0);U(this,r,void 0);U(this,h,0);rt(this,ct,Q),rt(this,gt,pt)}addFilter(Q){if(!Q)return"none";let pt=t(this,p,de).get(Q);if(pt)return pt;let Tt,Ct,Ut,zt;if(Q.length===1){const Bt=Q[0],Xt=new Array(256);for(let ut=0;ut<256;ut++)Xt[ut]=Bt[ut]/255;zt=Tt=Ct=Ut=Xt.join(",")}else{const[Bt,Xt,ut]=Q,tt=new Array(256),Y=new Array(256),yt=new Array(256);for(let At=0;At<256;At++)tt[At]=Bt[At]/255,Y[At]=Xt[At]/255,yt[At]=ut[At]/255;Tt=tt.join(","),Ct=Y.join(","),Ut=yt.join(","),zt=`${Tt}${Ct}${Ut}`}if(pt=t(this,p,de).get(zt),pt)return t(this,p,de).set(Q,pt),pt;const Wt=`g_${t(this,ct)}_transfer_map_${ge(this,h)._++}`,$t=`url(#${Wt})`;t(this,p,de).set(Q,$t),t(this,p,de).set(zt,$t);const Gt=X(this,ot,Ce).call(this,Wt);return X(this,wt,ye).call(this,Tt,Ct,Ut,Gt),$t}addHCMFilter(Q,pt){var Xt;const Tt=`${Q}-${pt}`;if(t(this,Et)===Tt)return t(this,M);if(rt(this,Et,Tt),rt(this,M,"none"),(Xt=t(this,xt))==null||Xt.remove(),!Q||!pt)return t(this,M);const Ct=X(this,vt,_e).call(this,Q);Q=d.Util.makeHexColor(...Ct);const Ut=X(this,vt,_e).call(this,pt);if(pt=d.Util.makeHexColor(...Ut),t(this,O,ue).style.color="",Q==="#000000"&&pt==="#ffffff"||Q===pt)return t(this,M);const zt=new Array(256);for(let ut=0;ut<=255;ut++){const tt=ut/255;zt[ut]=tt<=.03928?tt/12.92:((tt+.055)/1.055)**2.4}const Wt=zt.join(","),$t=`g_${t(this,ct)}_hcm_filter`,Gt=rt(this,i,X(this,ot,Ce).call(this,$t));X(this,wt,ye).call(this,Wt,Wt,Wt,Gt),X(this,nt,Je).call(this,Gt);const Bt=(ut,tt)=>{const Y=Ct[ut]/255,yt=Ut[ut]/255,At=new Array(tt+1);for(let te=0;te<=tt;te++)At[te]=Y+te/tt*(yt-Y);return At.join(",")};return X(this,wt,ye).call(this,Bt(0,5),Bt(1,5),Bt(2,5),Gt),rt(this,M,`url(#${$t})`),t(this,M)}addHighlightHCMFilter(Q,pt,Tt,Ct){var yt;const Ut=`${Q}-${pt}-${Tt}-${Ct}`;if(t(this,o)===Ut)return t(this,r);if(rt(this,o,Ut),rt(this,r,"none"),(yt=t(this,i))==null||yt.remove(),!Q||!pt)return t(this,r);const[zt,Wt]=[Q,pt].map(X(this,vt,_e).bind(this));let $t=Math.round(.2126*zt[0]+.7152*zt[1]+.0722*zt[2]),Gt=Math.round(.2126*Wt[0]+.7152*Wt[1]+.0722*Wt[2]),[Bt,Xt]=[Tt,Ct].map(X(this,vt,_e).bind(this));Gt<$t&&([$t,Gt,Bt,Xt]=[Gt,$t,Xt,Bt]),t(this,O,ue).style.color="";const ut=(At,te,Qt)=>{const Z=new Array(256),St=(Gt-$t)/Qt,Ot=At/255,Rt=(te-At)/(255*Qt);let jt=0;for(let Nt=0;Nt<=Qt;Nt++){const Jt=Math.round($t+Nt*St),_t=Ot+Nt*Rt;for(let Yt=jt;Yt<=Jt;Yt++)Z[Yt]=_t;jt=Jt+1}for(let Nt=jt;Nt<256;Nt++)Z[Nt]=Z[jt-1];return Z.join(",")},tt=`g_${t(this,ct)}_hcm_highlight_filter`,Y=rt(this,i,X(this,ot,Ce).call(this,tt));return X(this,nt,Je).call(this,Y),X(this,wt,ye).call(this,ut(Bt[0],Xt[0],5),ut(Bt[1],Xt[1],5),ut(Bt[2],Xt[2],5),Y),rt(this,r,`url(#${tt})`),t(this,r)}destroy(Q=!1){Q&&(t(this,M)||t(this,r))||(t(this,G)&&(t(this,G).parentNode.parentNode.remove(),rt(this,G,null)),t(this,at)&&(t(this,at).clear(),rt(this,at,null)),rt(this,h,0))}}at=new WeakMap,G=new WeakMap,ct=new WeakMap,gt=new WeakMap,xt=new WeakMap,Et=new WeakMap,M=new WeakMap,i=new WeakMap,o=new WeakMap,r=new WeakMap,h=new WeakMap,p=new WeakSet,de=function(){return t(this,at)||rt(this,at,new Map)},O=new WeakSet,ue=function(){if(!t(this,G)){const Q=t(this,gt).createElement("div"),{style:pt}=Q;pt.visibility="hidden",pt.contain="strict",pt.width=pt.height=0,pt.position="absolute",pt.top=pt.left=0,pt.zIndex=-1;const Tt=t(this,gt).createElementNS(W,"svg");Tt.setAttribute("width",0),Tt.setAttribute("height",0),rt(this,G,t(this,gt).createElementNS(W,"defs")),Q.append(Tt),Tt.append(t(this,G)),t(this,gt).body.append(Q)}return t(this,G)},nt=new WeakSet,Je=function(Q){const pt=t(this,gt).createElementNS(W,"feColorMatrix");pt.setAttribute("type","matrix"),pt.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),Q.append(pt)},ot=new WeakSet,Ce=function(Q){const pt=t(this,gt).createElementNS(W,"filter");return pt.setAttribute("color-interpolation-filters","sRGB"),pt.setAttribute("id",Q),t(this,O,ue).append(pt),pt},ft=new WeakSet,we=function(Q,pt,Tt){const Ct=t(this,gt).createElementNS(W,pt);Ct.setAttribute("type","discrete"),Ct.setAttribute("tableValues",Tt),Q.append(Ct)},wt=new WeakSet,ye=function(Q,pt,Tt,Ct){const Ut=t(this,gt).createElementNS(W,"feComponentTransfer");Ct.append(Ut),X(this,ft,we).call(this,Ut,"feFuncR",Q),X(this,ft,we).call(this,Ut,"feFuncG",pt),X(this,ft,we).call(this,Ut,"feFuncB",Tt)},vt=new WeakSet,_e=function(Q){return t(this,O,ue).style.color=Q,m(getComputedStyle(t(this,O,ue)).getPropertyValue("color"))},e.DOMFilterFactory=it;class k extends n.BaseCanvasFactory{constructor({ownerDocument:et=globalThis.document}={}){super(),this._document=et}_createCanvas(et,Q){const pt=this._document.createElement("canvas");return pt.width=et,pt.height=Q,pt}}e.DOMCanvasFactory=k;async function S(mt,et=!1){if(_(mt,document.baseURI)){const Q=await fetch(mt);if(!Q.ok)throw new Error(Q.statusText);return et?new Uint8Array(await Q.arrayBuffer()):(0,d.stringToBytes)(await Q.text())}return new Promise((Q,pt)=>{const Tt=new XMLHttpRequest;Tt.open("GET",mt,!0),et&&(Tt.responseType="arraybuffer"),Tt.onreadystatechange=()=>{if(Tt.readyState===XMLHttpRequest.DONE){if(Tt.status===200||Tt.status===0){let Ct;if(et&&Tt.response?Ct=new Uint8Array(Tt.response):!et&&Tt.responseText&&(Ct=(0,d.stringToBytes)(Tt.responseText)),Ct){Q(Ct);return}}pt(new Error(Tt.statusText))}},Tt.send(null)})}class f extends n.BaseCMapReaderFactory{_fetchData(et,Q){return S(et,this.isCompressed).then(pt=>({cMapData:pt,compressionType:Q}))}}e.DOMCMapReaderFactory=f;class I extends n.BaseStandardFontDataFactory{_fetchData(et){return S(et,!0)}}e.DOMStandardFontDataFactory=I;class D extends n.BaseSVGFactory{_createSVG(et){return document.createElementNS(W,et)}}e.DOMSVGFactory=D;class E{constructor({viewBox:et,scale:Q,rotation:pt,offsetX:Tt=0,offsetY:Ct=0,dontFlip:Ut=!1}){this.viewBox=et,this.scale=Q,this.rotation=pt,this.offsetX=Tt,this.offsetY=Ct;const zt=(et[2]+et[0])/2,Wt=(et[3]+et[1])/2;let $t,Gt,Bt,Xt;switch(pt%=360,pt<0&&(pt+=360),pt){case 180:$t=-1,Gt=0,Bt=0,Xt=1;break;case 90:$t=0,Gt=1,Bt=1,Xt=0;break;case 270:$t=0,Gt=-1,Bt=-1,Xt=0;break;case 0:$t=1,Gt=0,Bt=0,Xt=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}Ut&&(Bt=-Bt,Xt=-Xt);let ut,tt,Y,yt;$t===0?(ut=Math.abs(Wt-et[1])*Q+Tt,tt=Math.abs(zt-et[0])*Q+Ct,Y=(et[3]-et[1])*Q,yt=(et[2]-et[0])*Q):(ut=Math.abs(zt-et[0])*Q+Tt,tt=Math.abs(Wt-et[1])*Q+Ct,Y=(et[2]-et[0])*Q,yt=(et[3]-et[1])*Q),this.transform=[$t*Q,Gt*Q,Bt*Q,Xt*Q,ut-$t*Q*zt-Bt*Q*Wt,tt-Gt*Q*zt-Xt*Q*Wt],this.width=Y,this.height=yt}get rawDims(){const{viewBox:et}=this;return(0,d.shadow)(this,"rawDims",{pageWidth:et[2]-et[0],pageHeight:et[3]-et[1],pageX:et[0],pageY:et[1]})}clone({scale:et=this.scale,rotation:Q=this.rotation,offsetX:pt=this.offsetX,offsetY:Tt=this.offsetY,dontFlip:Ct=!1}={}){return new E({viewBox:this.viewBox.slice(),scale:et,rotation:Q,offsetX:pt,offsetY:Tt,dontFlip:Ct})}convertToViewportPoint(et,Q){return d.Util.applyTransform([et,Q],this.transform)}convertToViewportRectangle(et){const Q=d.Util.applyTransform([et[0],et[1]],this.transform),pt=d.Util.applyTransform([et[2],et[3]],this.transform);return[Q[0],Q[1],pt[0],pt[1]]}convertToPdfPoint(et,Q){return d.Util.applyInverseTransform([et,Q],this.transform)}}e.PageViewport=E;class g extends d.BaseException{constructor(et,Q=0){super(et,"RenderingCancelledException"),this.extraDelay=Q}}e.RenderingCancelledException=g;function x(mt){const et=mt.length;let Q=0;for(;Q<et&&mt[Q].trim()==="";)Q++;return mt.substring(Q,Q+5).toLowerCase()==="data:"}function u(mt){return typeof mt=="string"&&/\.pdf$/i.test(mt)}function y(mt,et=!1){return et||([mt]=mt.split(/[#?]/,1)),mt.substring(mt.lastIndexOf("/")+1)}function C(mt,et="document.pdf"){if(typeof mt!="string")return et;if(x(mt))return(0,d.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),et;const Q=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,pt=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,Tt=Q.exec(mt);let Ct=pt.exec(Tt[1])||pt.exec(Tt[2])||pt.exec(Tt[3]);if(Ct&&(Ct=Ct[0],Ct.includes("%")))try{Ct=pt.exec(decodeURIComponent(Ct))[0]}catch{}return Ct||et}class w{constructor(){ee(this,"started",Object.create(null));ee(this,"times",[])}time(et){et in this.started&&(0,d.warn)(`Timer is already running for ${et}`),this.started[et]=Date.now()}timeEnd(et){et in this.started||(0,d.warn)(`Timer has not been started for ${et}`),this.times.push({name:et,start:this.started[et],end:Date.now()}),delete this.started[et]}toString(){const et=[];let Q=0;for(const{name:pt}of this.times)Q=Math.max(pt.length,Q);for(const{name:pt,start:Tt,end:Ct}of this.times)et.push(`${pt.padEnd(Q)} ${Ct-Tt}ms
`);return et.join("")}}e.StatTimer=w;function _(mt,et){try{const{protocol:Q}=et?new URL(mt,et):new URL(mt);return Q==="http:"||Q==="https:"}catch{return!1}}function a(mt){mt.preventDefault()}function c(mt,et=!1){return new Promise((Q,pt)=>{const Tt=document.createElement("script");Tt.src=mt,Tt.onload=function(Ct){et&&Tt.remove(),Q(Ct)},Tt.onerror=function(){pt(new Error(`Cannot load script at: ${Tt.src}`))},(document.head||document.documentElement).append(Tt)})}function L(mt){console.log("Deprecated API usage: "+mt)}let A;class l{static toDateObject(et){if(!et||typeof et!="string")return null;A||(A=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const Q=A.exec(et);if(!Q)return null;const pt=parseInt(Q[1],10);let Tt=parseInt(Q[2],10);Tt=Tt>=1&&Tt<=12?Tt-1:0;let Ct=parseInt(Q[3],10);Ct=Ct>=1&&Ct<=31?Ct:1;let Ut=parseInt(Q[4],10);Ut=Ut>=0&&Ut<=23?Ut:0;let zt=parseInt(Q[5],10);zt=zt>=0&&zt<=59?zt:0;let Wt=parseInt(Q[6],10);Wt=Wt>=0&&Wt<=59?Wt:0;const $t=Q[7]||"Z";let Gt=parseInt(Q[8],10);Gt=Gt>=0&&Gt<=23?Gt:0;let Bt=parseInt(Q[9],10)||0;return Bt=Bt>=0&&Bt<=59?Bt:0,$t==="-"?(Ut+=Gt,zt+=Bt):$t==="+"&&(Ut-=Gt,zt-=Bt),new Date(Date.UTC(pt,Tt,Ct,Ut,zt,Wt))}}e.PDFDateString=l;function F(mt,{scale:et=1,rotation:Q=0}){const{width:pt,height:Tt}=mt.attributes.style,Ct=[0,0,parseInt(pt),parseInt(Tt)];return new E({viewBox:Ct,scale:et,rotation:Q})}function m(mt){if(mt.startsWith("#")){const et=parseInt(mt.slice(1),16);return[(et&16711680)>>16,(et&65280)>>8,et&255]}return mt.startsWith("rgb(")?mt.slice(4,-1).split(",").map(et=>parseInt(et)):mt.startsWith("rgba(")?mt.slice(5,-1).split(",").map(et=>parseInt(et)).slice(0,3):((0,d.warn)(`Not a valid color format: "${mt}"`),[0,0,0])}function $(mt){const et=document.createElement("span");et.style.visibility="hidden",document.body.append(et);for(const Q of mt.keys()){et.style.color=Q;const pt=window.getComputedStyle(et).color;mt.set(Q,m(pt))}et.remove()}function z(mt){const{a:et,b:Q,c:pt,d:Tt,e:Ct,f:Ut}=mt.getTransform();return[et,Q,pt,Tt,Ct,Ut]}function R(mt){const{a:et,b:Q,c:pt,d:Tt,e:Ct,f:Ut}=mt.getTransform().invertSelf();return[et,Q,pt,Tt,Ct,Ut]}function V(mt,et,Q=!1,pt=!0){if(et instanceof E){const{pageWidth:Tt,pageHeight:Ct}=et.rawDims,{style:Ut}=mt,zt=d.FeatureTest.isCSSRoundSupported,Wt=`var(--scale-factor) * ${Tt}px`,$t=`var(--scale-factor) * ${Ct}px`,Gt=zt?`round(${Wt}, 1px)`:`calc(${Wt})`,Bt=zt?`round(${$t}, 1px)`:`calc(${$t})`;!Q||et.rotation%180===0?(Ut.width=Gt,Ut.height=Bt):(Ut.width=Bt,Ut.height=Gt)}pt&&mt.setAttribute("data-main-rotation",et.rotation)}},(b,e,v)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BaseStandardFontDataFactory=e.BaseSVGFactory=e.BaseFilterFactory=e.BaseCanvasFactory=e.BaseCMapReaderFactory=void 0;var n=v(1);class d{constructor(){this.constructor===d&&(0,n.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(f){return"none"}addHCMFilter(f,I){return"none"}addHighlightHCMFilter(f,I,D,E){return"none"}destroy(f=!1){}}e.BaseFilterFactory=d;class W{constructor(){this.constructor===W&&(0,n.unreachable)("Cannot initialize BaseCanvasFactory.")}create(f,I){if(f<=0||I<=0)throw new Error("Invalid canvas size");const D=this._createCanvas(f,I);return{canvas:D,context:D.getContext("2d")}}reset(f,I,D){if(!f.canvas)throw new Error("Canvas is not specified");if(I<=0||D<=0)throw new Error("Invalid canvas size");f.canvas.width=I,f.canvas.height=D}destroy(f){if(!f.canvas)throw new Error("Canvas is not specified");f.canvas.width=0,f.canvas.height=0,f.canvas=null,f.context=null}_createCanvas(f,I){(0,n.unreachable)("Abstract method `_createCanvas` called.")}}e.BaseCanvasFactory=W;class j{constructor({baseUrl:f=null,isCompressed:I=!0}){this.constructor===j&&(0,n.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=f,this.isCompressed=I}async fetch({name:f}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!f)throw new Error("CMap name must be specified.");const I=this.baseUrl+f+(this.isCompressed?".bcmap":""),D=this.isCompressed?n.CMapCompressionType.BINARY:n.CMapCompressionType.NONE;return this._fetchData(I,D).catch(E=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${I}`)})}_fetchData(f,I){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseCMapReaderFactory=j;class it{constructor({baseUrl:f=null}){this.constructor===it&&(0,n.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=f}async fetch({filename:f}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!f)throw new Error("Font filename must be specified.");const I=`${this.baseUrl}${f}`;return this._fetchData(I).catch(D=>{throw new Error(`Unable to load font data at: ${I}`)})}_fetchData(f){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseStandardFontDataFactory=it;class k{constructor(){this.constructor===k&&(0,n.unreachable)("Cannot initialize BaseSVGFactory.")}create(f,I,D=!1){if(f<=0||I<=0)throw new Error("Invalid SVG dimensions");const E=this._createSVG("svg:svg");return E.setAttribute("version","1.1"),D||(E.setAttribute("width",`${f}px`),E.setAttribute("height",`${I}px`)),E.setAttribute("preserveAspectRatio","none"),E.setAttribute("viewBox",`0 0 ${f} ${I}`),E}createElement(f){if(typeof f!="string")throw new Error("Invalid SVG element type");return this._createSVG(f)}_createSVG(f){(0,n.unreachable)("Abstract method `_createSVG` called.")}}e.BaseSVGFactory=k},(b,e,v)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MurmurHash3_64=void 0;var n=v(1);const d=3285377520,W=4294901760,j=65535;class it{constructor(S){this.h1=S?S&4294967295:d,this.h2=S?S&4294967295:d}update(S){let f,I;if(typeof S=="string"){f=new Uint8Array(S.length*2),I=0;for(let L=0,A=S.length;L<A;L++){const l=S.charCodeAt(L);l<=255?f[I++]=l:(f[I++]=l>>>8,f[I++]=l&255)}}else if((0,n.isArrayBuffer)(S))f=S.slice(),I=f.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const D=I>>2,E=I-D*4,g=new Uint32Array(f.buffer,0,D);let x=0,u=0,y=this.h1,C=this.h2;const w=3432918353,_=461845907,a=w&j,c=_&j;for(let L=0;L<D;L++)L&1?(x=g[L],x=x*w&W|x*a&j,x=x<<15|x>>>17,x=x*_&W|x*c&j,y^=x,y=y<<13|y>>>19,y=y*5+3864292196):(u=g[L],u=u*w&W|u*a&j,u=u<<15|u>>>17,u=u*_&W|u*c&j,C^=u,C=C<<13|C>>>19,C=C*5+3864292196);switch(x=0,E){case 3:x^=f[D*4+2]<<16;case 2:x^=f[D*4+1]<<8;case 1:x^=f[D*4],x=x*w&W|x*a&j,x=x<<15|x>>>17,x=x*_&W|x*c&j,D&1?y^=x:C^=x}this.h1=y,this.h2=C}hexdigest(){let S=this.h1,f=this.h2;return S^=f>>>1,S=S*3981806797&W|S*36045&j,f=f*4283543511&W|((f<<16|S>>>16)*2950163797&W)>>>16,S^=f>>>1,S=S*444984403&W|S*60499&j,f=f*3301882366&W|((f<<16|S>>>16)*3120437893&W)>>>16,S^=f>>>1,(S>>>0).toString(16).padStart(8,"0")+(f>>>0).toString(16).padStart(8,"0")}}e.MurmurHash3_64=it},(b,e,v)=>{var j;Object.defineProperty(e,"__esModule",{value:!0}),e.FontLoader=e.FontFaceObject=void 0;var n=v(1);class d{constructor({ownerDocument:k=globalThis.document,styleElement:S=null}){U(this,j,new Set);this._document=k,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(k){this.nativeFontFaces.add(k),this._document.fonts.add(k)}removeNativeFontFace(k){this.nativeFontFaces.delete(k),this._document.fonts.delete(k)}insertRule(k){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const S=this.styleElement.sheet;S.insertRule(k,S.cssRules.length)}clear(){for(const k of this.nativeFontFaces)this._document.fonts.delete(k);this.nativeFontFaces.clear(),t(this,j).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(k){if(!(!k||t(this,j).has(k.loadedName))){if((0,n.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:S,src:f,style:I}=k,D=new FontFace(S,f,I);this.addNativeFontFace(D);try{await D.load(),t(this,j).add(S)}catch{(0,n.warn)(`Cannot load system font: ${k.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(D)}return}(0,n.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(k){if(k.attached||k.missingFile&&!k.systemFontInfo)return;if(k.attached=!0,k.systemFontInfo){await this.loadSystemFont(k.systemFontInfo);return}if(this.isFontLoadingAPISupported){const f=k.createNativeFontFace();if(f){this.addNativeFontFace(f);try{await f.loaded}catch(I){throw(0,n.warn)(`Failed to load font '${f.family}': '${I}'.`),k.disableFontFace=!0,I}}return}const S=k.createFontFaceRule();if(S){if(this.insertRule(S),this.isSyncFontLoadingSupported)return;await new Promise(f=>{const I=this._queueLoadingCallback(f);this._prepareFontLoadEvent(k,I)})}}get isFontLoadingAPISupported(){var S;const k=!!((S=this._document)!=null&&S.fonts);return(0,n.shadow)(this,"isFontLoadingAPISupported",k)}get isSyncFontLoadingSupported(){let k=!1;return(n.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(k=!0),(0,n.shadow)(this,"isSyncFontLoadingSupported",k)}_queueLoadingCallback(k){function S(){for((0,n.assert)(!I.done,"completeRequest() cannot be called twice."),I.done=!0;f.length>0&&f[0].done;){const D=f.shift();setTimeout(D.callback,0)}}const{loadingRequests:f}=this,I={done:!1,complete:S,callback:k};return f.push(I),I}get _loadTestFont(){const k=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,n.shadow)(this,"_loadTestFont",k)}_prepareFontLoadEvent(k,S){function f(m,$){return m.charCodeAt($)<<24|m.charCodeAt($+1)<<16|m.charCodeAt($+2)<<8|m.charCodeAt($+3)&255}function I(m,$,z,R){const V=m.substring(0,$),st=m.substring($+z);return V+R+st}let D,E;const g=this._document.createElement("canvas");g.width=1,g.height=1;const x=g.getContext("2d");let u=0;function y(m,$){if(++u>30){(0,n.warn)("Load test font never loaded."),$();return}if(x.font="30px "+m,x.fillText(".",0,20),x.getImageData(0,0,1,1).data[3]>0){$();return}setTimeout(y.bind(null,m,$))}const C=`lt${Date.now()}${this.loadTestFontId++}`;let w=this._loadTestFont;w=I(w,976,C.length,C);const a=16,c=1482184792;let L=f(w,a);for(D=0,E=C.length-3;D<E;D+=4)L=L-c+f(C,D)|0;D<C.length&&(L=L-c+f(C+"XXX",D)|0),w=I(w,a,4,(0,n.string32)(L));const A=`url(data:font/opentype;base64,${btoa(w)});`,l=`@font-face {font-family:"${C}";src:${A}}`;this.insertRule(l);const F=this._document.createElement("div");F.style.visibility="hidden",F.style.width=F.style.height="10px",F.style.position="absolute",F.style.top=F.style.left="0px";for(const m of[k.loadedName,C]){const $=this._document.createElement("span");$.textContent="Hi",$.style.fontFamily=m,F.append($)}this._document.body.append(F),y(C,()=>{F.remove(),S.complete()})}}j=new WeakMap,e.FontLoader=d;class W{constructor(k,{isEvalSupported:S=!0,disableFontFace:f=!1,ignoreErrors:I=!1,inspectFont:D=null}){this.compiledGlyphs=Object.create(null);for(const E in k)this[E]=k[E];this.isEvalSupported=S!==!1,this.disableFontFace=f===!0,this.ignoreErrors=I===!0,this._inspectFont=D}createNativeFontFace(){var S;if(!this.data||this.disableFontFace)return null;let k;if(!this.cssFontInfo)k=new FontFace(this.loadedName,this.data,{});else{const f={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(f.style=`oblique ${this.cssFontInfo.italicAngle}deg`),k=new FontFace(this.cssFontInfo.fontFamily,this.data,f)}return(S=this._inspectFont)==null||S.call(this,this),k}createFontFaceRule(){var I;if(!this.data||this.disableFontFace)return null;const k=(0,n.bytesToString)(this.data),S=`url(data:${this.mimetype};base64,${btoa(k)});`;let f;if(!this.cssFontInfo)f=`@font-face {font-family:"${this.loadedName}";src:${S}}`;else{let D=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(D+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),f=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${D}src:${S}}`}return(I=this._inspectFont)==null||I.call(this,this,S),f}getPathGenerator(k,S){if(this.compiledGlyphs[S]!==void 0)return this.compiledGlyphs[S];let f;try{f=k.get(this.loadedName+"_path_"+S)}catch(I){if(!this.ignoreErrors)throw I;return(0,n.warn)(`getPathGenerator - ignoring character: "${I}".`),this.compiledGlyphs[S]=function(D,E){}}if(this.isEvalSupported&&n.FeatureTest.isEvalSupported){const I=[];for(const D of f){const E=D.args!==void 0?D.args.join(","):"";I.push("c.",D.cmd,"(",E,`);
`)}return this.compiledGlyphs[S]=new Function("c","size",I.join(""))}return this.compiledGlyphs[S]=function(I,D){for(const E of f)E.cmd==="scale"&&(E.args=[D,-D]),I[E.cmd].apply(I,E.args)}}}e.FontFaceObject=W},(b,e,v)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NodeStandardFontDataFactory=e.NodeFilterFactory=e.NodeCanvasFactory=e.NodeCMapReaderFactory=void 0;var n=v(7);v(1);const d=function(S){return new Promise((f,I)=>{require$$5.readFile(S,(E,g)=>{if(E||!g){I(new Error(E));return}f(new Uint8Array(g))})})};class W extends n.BaseFilterFactory{}e.NodeFilterFactory=W;class j extends n.BaseCanvasFactory{_createCanvas(f,I){return require$$5.createCanvas(f,I)}}e.NodeCanvasFactory=j;class it extends n.BaseCMapReaderFactory{_fetchData(f,I){return d(f).then(D=>({cMapData:D,compressionType:I}))}}e.NodeCMapReaderFactory=it;class k extends n.BaseStandardFontDataFactory{_fetchData(f){return d(f)}}e.NodeStandardFontDataFactory=k},(b,e,v)=>{var G,Ze,gt,Qe;Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasGraphics=void 0;var n=v(1),d=v(6),W=v(12),j=v(13);const it=16,k=100,S=4096,f=15,I=10,D=1e3,E=16;function g(M,i){if(M._removeMirroring)throw new Error("Context is already forwarding operations.");M.__originalSave=M.save,M.__originalRestore=M.restore,M.__originalRotate=M.rotate,M.__originalScale=M.scale,M.__originalTranslate=M.translate,M.__originalTransform=M.transform,M.__originalSetTransform=M.setTransform,M.__originalResetTransform=M.resetTransform,M.__originalClip=M.clip,M.__originalMoveTo=M.moveTo,M.__originalLineTo=M.lineTo,M.__originalBezierCurveTo=M.bezierCurveTo,M.__originalRect=M.rect,M.__originalClosePath=M.closePath,M.__originalBeginPath=M.beginPath,M._removeMirroring=()=>{M.save=M.__originalSave,M.restore=M.__originalRestore,M.rotate=M.__originalRotate,M.scale=M.__originalScale,M.translate=M.__originalTranslate,M.transform=M.__originalTransform,M.setTransform=M.__originalSetTransform,M.resetTransform=M.__originalResetTransform,M.clip=M.__originalClip,M.moveTo=M.__originalMoveTo,M.lineTo=M.__originalLineTo,M.bezierCurveTo=M.__originalBezierCurveTo,M.rect=M.__originalRect,M.closePath=M.__originalClosePath,M.beginPath=M.__originalBeginPath,delete M._removeMirroring},M.save=function(){i.save(),this.__originalSave()},M.restore=function(){i.restore(),this.__originalRestore()},M.translate=function(r,h){i.translate(r,h),this.__originalTranslate(r,h)},M.scale=function(r,h){i.scale(r,h),this.__originalScale(r,h)},M.transform=function(r,h,p,P,O,H){i.transform(r,h,p,P,O,H),this.__originalTransform(r,h,p,P,O,H)},M.setTransform=function(r,h,p,P,O,H){i.setTransform(r,h,p,P,O,H),this.__originalSetTransform(r,h,p,P,O,H)},M.resetTransform=function(){i.resetTransform(),this.__originalResetTransform()},M.rotate=function(r){i.rotate(r),this.__originalRotate(r)},M.clip=function(r){i.clip(r),this.__originalClip(r)},M.moveTo=function(o,r){i.moveTo(o,r),this.__originalMoveTo(o,r)},M.lineTo=function(o,r){i.lineTo(o,r),this.__originalLineTo(o,r)},M.bezierCurveTo=function(o,r,h,p,P,O){i.bezierCurveTo(o,r,h,p,P,O),this.__originalBezierCurveTo(o,r,h,p,P,O)},M.rect=function(o,r,h,p){i.rect(o,r,h,p),this.__originalRect(o,r,h,p)},M.closePath=function(){i.closePath(),this.__originalClosePath()},M.beginPath=function(){i.beginPath(),this.__originalBeginPath()}}class x{constructor(i){this.canvasFactory=i,this.cache=Object.create(null)}getCanvas(i,o,r){let h;return this.cache[i]!==void 0?(h=this.cache[i],this.canvasFactory.reset(h,o,r)):(h=this.canvasFactory.create(o,r),this.cache[i]=h),h}delete(i){delete this.cache[i]}clear(){for(const i in this.cache){const o=this.cache[i];this.canvasFactory.destroy(o),delete this.cache[i]}}}function u(M,i,o,r,h,p,P,O,H,nt){const[J,ot,ht,ft,dt,wt]=(0,d.getCurrentTransform)(M);if(ot===0&&ht===0){const Dt=P*J+dt,mt=Math.round(Dt),et=O*ft+wt,Q=Math.round(et),pt=(P+H)*J+dt,Tt=Math.abs(Math.round(pt)-mt)||1,Ct=(O+nt)*ft+wt,Ut=Math.abs(Math.round(Ct)-Q)||1;return M.setTransform(Math.sign(J),0,0,Math.sign(ft),mt,Q),M.drawImage(i,o,r,h,p,0,0,Tt,Ut),M.setTransform(J,ot,ht,ft,dt,wt),[Tt,Ut]}if(J===0&&ft===0){const Dt=O*ht+dt,mt=Math.round(Dt),et=P*ot+wt,Q=Math.round(et),pt=(O+nt)*ht+dt,Tt=Math.abs(Math.round(pt)-mt)||1,Ct=(P+H)*ot+wt,Ut=Math.abs(Math.round(Ct)-Q)||1;return M.setTransform(0,Math.sign(ot),Math.sign(ht),0,mt,Q),M.drawImage(i,o,r,h,p,0,0,Ut,Tt),M.setTransform(J,ot,ht,ft,dt,wt),[Ut,Tt]}M.drawImage(i,o,r,h,p,P,O,H,nt);const Lt=Math.hypot(J,ot),vt=Math.hypot(ht,ft);return[Lt*H,vt*nt]}function y(M){const{width:i,height:o}=M;if(i>D||o>D)return null;const r=1e3,h=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),p=i+1;let P=new Uint8Array(p*(o+1)),O,H,nt;const J=i+7&-8;let ot=new Uint8Array(J*o),ht=0;for(const vt of M.data){let Dt=128;for(;Dt>0;)ot[ht++]=vt&Dt?0:255,Dt>>=1}let ft=0;for(ht=0,ot[ht]!==0&&(P[0]=1,++ft),H=1;H<i;H++)ot[ht]!==ot[ht+1]&&(P[H]=ot[ht]?2:1,++ft),ht++;for(ot[ht]!==0&&(P[H]=2,++ft),O=1;O<o;O++){ht=O*J,nt=O*p,ot[ht-J]!==ot[ht]&&(P[nt]=ot[ht]?1:8,++ft);let vt=(ot[ht]?4:0)+(ot[ht-J]?8:0);for(H=1;H<i;H++)vt=(vt>>2)+(ot[ht+1]?4:0)+(ot[ht-J+1]?8:0),h[vt]&&(P[nt+H]=h[vt],++ft),ht++;if(ot[ht-J]!==ot[ht]&&(P[nt+H]=ot[ht]?2:4,++ft),ft>r)return null}for(ht=J*(o-1),nt=O*p,ot[ht]!==0&&(P[nt]=8,++ft),H=1;H<i;H++)ot[ht]!==ot[ht+1]&&(P[nt+H]=ot[ht]?4:8,++ft),ht++;if(ot[ht]!==0&&(P[nt+H]=4,++ft),ft>r)return null;const dt=new Int32Array([0,p,-1,0,-p,0,0,0,1]),wt=new Path2D;for(O=0;ft&&O<=o;O++){let vt=O*p;const Dt=vt+i;for(;vt<Dt&&!P[vt];)vt++;if(vt===Dt)continue;wt.moveTo(vt%p,O);const mt=vt;let et=P[vt];do{const Q=dt[et];do vt+=Q;while(!P[vt]);const pt=P[vt];pt!==5&&pt!==10?(et=pt,P[vt]=0):(et=pt&51*et>>4,P[vt]&=et>>2|et<<2),wt.lineTo(vt%p,vt/p|0),P[vt]||--ft}while(mt!==vt);--O}return ot=null,P=null,function(vt){vt.save(),vt.scale(1/i,-1/o),vt.translate(0,-o),vt.fill(wt),vt.beginPath(),vt.restore()}}class C{constructor(i,o){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=n.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=n.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=n.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,i,o])}clone(){const i=Object.create(this);return i.clipBox=this.clipBox.slice(),i}setCurrentPoint(i,o){this.x=i,this.y=o}updatePathMinMax(i,o,r){[o,r]=n.Util.applyTransform([o,r],i),this.minX=Math.min(this.minX,o),this.minY=Math.min(this.minY,r),this.maxX=Math.max(this.maxX,o),this.maxY=Math.max(this.maxY,r)}updateRectMinMax(i,o){const r=n.Util.applyTransform(o,i),h=n.Util.applyTransform(o.slice(2),i);this.minX=Math.min(this.minX,r[0],h[0]),this.minY=Math.min(this.minY,r[1],h[1]),this.maxX=Math.max(this.maxX,r[0],h[0]),this.maxY=Math.max(this.maxY,r[1],h[1])}updateScalingPathMinMax(i,o){n.Util.scaleMinMax(i,o),this.minX=Math.min(this.minX,o[0]),this.maxX=Math.max(this.maxX,o[1]),this.minY=Math.min(this.minY,o[2]),this.maxY=Math.max(this.maxY,o[3])}updateCurvePathMinMax(i,o,r,h,p,P,O,H,nt,J){const ot=n.Util.bezierBoundingBox(o,r,h,p,P,O,H,nt);if(J){J[0]=Math.min(J[0],ot[0],ot[2]),J[1]=Math.max(J[1],ot[0],ot[2]),J[2]=Math.min(J[2],ot[1],ot[3]),J[3]=Math.max(J[3],ot[1],ot[3]);return}this.updateRectMinMax(i,ot)}getPathBoundingBox(i=W.PathType.FILL,o=null){const r=[this.minX,this.minY,this.maxX,this.maxY];if(i===W.PathType.STROKE){o||(0,n.unreachable)("Stroke bounding box must include transform.");const h=n.Util.singularValueDecompose2dScale(o),p=h[0]*this.lineWidth/2,P=h[1]*this.lineWidth/2;r[0]-=p,r[1]-=P,r[2]+=p,r[3]+=P}return r}updateClipFromPath(){const i=n.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(i||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(i){this.clipBox=i,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(i=W.PathType.FILL,o=null){return n.Util.intersect(this.clipBox,this.getPathBoundingBox(i,o))}}function w(M,i){if(typeof ImageData<"u"&&i instanceof ImageData){M.putImageData(i,0,0);return}const o=i.height,r=i.width,h=o%E,p=(o-h)/E,P=h===0?p:p+1,O=M.createImageData(r,E);let H=0,nt;const J=i.data,ot=O.data;let ht,ft,dt,wt;if(i.kind===n.ImageKind.GRAYSCALE_1BPP){const Lt=J.byteLength,vt=new Uint32Array(ot.buffer,0,ot.byteLength>>2),Dt=vt.length,mt=r+7>>3,et=4294967295,Q=n.FeatureTest.isLittleEndian?4278190080:255;for(ht=0;ht<P;ht++){for(dt=ht<p?E:h,nt=0,ft=0;ft<dt;ft++){const pt=Lt-H;let Tt=0;const Ct=pt>mt?r:pt*8-7,Ut=Ct&-8;let zt=0,Wt=0;for(;Tt<Ut;Tt+=8)Wt=J[H++],vt[nt++]=Wt&128?et:Q,vt[nt++]=Wt&64?et:Q,vt[nt++]=Wt&32?et:Q,vt[nt++]=Wt&16?et:Q,vt[nt++]=Wt&8?et:Q,vt[nt++]=Wt&4?et:Q,vt[nt++]=Wt&2?et:Q,vt[nt++]=Wt&1?et:Q;for(;Tt<Ct;Tt++)zt===0&&(Wt=J[H++],zt=128),vt[nt++]=Wt&zt?et:Q,zt>>=1}for(;nt<Dt;)vt[nt++]=0;M.putImageData(O,0,ht*E)}}else if(i.kind===n.ImageKind.RGBA_32BPP){for(ft=0,wt=r*E*4,ht=0;ht<p;ht++)ot.set(J.subarray(H,H+wt)),H+=wt,M.putImageData(O,0,ft),ft+=E;ht<P&&(wt=r*h*4,ot.set(J.subarray(H,H+wt)),M.putImageData(O,0,ft))}else if(i.kind===n.ImageKind.RGB_24BPP)for(dt=E,wt=r*dt,ht=0;ht<P;ht++){for(ht>=p&&(dt=h,wt=r*dt),nt=0,ft=wt;ft--;)ot[nt++]=J[H++],ot[nt++]=J[H++],ot[nt++]=J[H++],ot[nt++]=255;M.putImageData(O,0,ht*E)}else throw new Error(`bad image kind: ${i.kind}`)}function _(M,i){if(i.bitmap){M.drawImage(i.bitmap,0,0);return}const o=i.height,r=i.width,h=o%E,p=(o-h)/E,P=h===0?p:p+1,O=M.createImageData(r,E);let H=0;const nt=i.data,J=O.data;for(let ot=0;ot<P;ot++){const ht=ot<p?E:h;({srcPos:H}=(0,j.convertBlackAndWhiteToRGBA)({src:nt,srcPos:H,dest:J,width:r,height:ht,nonBlackColor:0})),M.putImageData(O,0,ot*E)}}function a(M,i){const o=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const r of o)M[r]!==void 0&&(i[r]=M[r]);M.setLineDash!==void 0&&(i.setLineDash(M.getLineDash()),i.lineDashOffset=M.lineDashOffset)}function c(M){if(M.strokeStyle=M.fillStyle="#000000",M.fillRule="nonzero",M.globalAlpha=1,M.lineWidth=1,M.lineCap="butt",M.lineJoin="miter",M.miterLimit=10,M.globalCompositeOperation="source-over",M.font="10px sans-serif",M.setLineDash!==void 0&&(M.setLineDash([]),M.lineDashOffset=0),!n.isNodeJS){const{filter:i}=M;i!=="none"&&i!==""&&(M.filter="none")}}function L(M,i,o,r){const h=M.length;for(let p=3;p<h;p+=4){const P=M[p];if(P===0)M[p-3]=i,M[p-2]=o,M[p-1]=r;else if(P<255){const O=255-P;M[p-3]=M[p-3]*P+i*O>>8,M[p-2]=M[p-2]*P+o*O>>8,M[p-1]=M[p-1]*P+r*O>>8}}}function A(M,i,o){const r=M.length,h=1/255;for(let p=3;p<r;p+=4){const P=o?o[M[p]]:M[p];i[p]=i[p]*P*h|0}}function l(M,i,o){const r=M.length;for(let h=3;h<r;h+=4){const p=M[h-3]*77+M[h-2]*152+M[h-1]*28;i[h]=o?i[h]*o[p>>8]>>8:i[h]*p>>16}}function F(M,i,o,r,h,p,P,O,H,nt,J){const ot=!!p,ht=ot?p[0]:0,ft=ot?p[1]:0,dt=ot?p[2]:0,wt=h==="Luminosity"?l:A,vt=Math.min(r,Math.ceil(1048576/o));for(let Dt=0;Dt<r;Dt+=vt){const mt=Math.min(vt,r-Dt),et=M.getImageData(O-nt,Dt+(H-J),o,mt),Q=i.getImageData(O,Dt+H,o,mt);ot&&L(et.data,ht,ft,dt),wt(et.data,Q.data,P),i.putImageData(Q,O,Dt+H)}}function m(M,i,o,r){const h=r[0],p=r[1],P=r[2]-h,O=r[3]-p;P===0||O===0||(F(i.context,o,P,O,i.subtype,i.backdrop,i.transferMap,h,p,i.offsetX,i.offsetY),M.save(),M.globalAlpha=1,M.globalCompositeOperation="source-over",M.setTransform(1,0,0,1,0,0),M.drawImage(o.canvas,0,0),M.restore())}function $(M,i){const o=n.Util.singularValueDecompose2dScale(M);o[0]=Math.fround(o[0]),o[1]=Math.fround(o[1]);const r=Math.fround((globalThis.devicePixelRatio||1)*d.PixelsPerInch.PDF_TO_CSS_UNITS);return i!==void 0?i:o[0]<=r||o[1]<=r}const z=["butt","round","square"],R=["miter","round","bevel"],V={},st={},Et=class Et{constructor(i,o,r,h,p,{optionalContentConfig:P,markedContentStack:O=null},H,nt){U(this,G);U(this,gt);this.ctx=i,this.current=new C(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=o,this.objs=r,this.canvasFactory=h,this.filterFactory=p,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=O||[],this.optionalContentConfig=P,this.cachedCanvases=new x(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=H,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=nt,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(i,o=null){return typeof i=="string"?i.startsWith("g_")?this.commonObjs.get(i):this.objs.get(i):o}beginDrawing({transform:i,viewport:o,transparency:r=!1,background:h=null}){const p=this.ctx.canvas.width,P=this.ctx.canvas.height,O=this.ctx.fillStyle;if(this.ctx.fillStyle=h||"#ffffff",this.ctx.fillRect(0,0,p,P),this.ctx.fillStyle=O,r){const H=this.cachedCanvases.getCanvas("transparent",p,P);this.compositeCtx=this.ctx,this.transparentCanvas=H.canvas,this.ctx=H.context,this.ctx.save(),this.ctx.transform(...(0,d.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),c(this.ctx),i&&(this.ctx.transform(...i),this.outputScaleX=i[0],this.outputScaleY=i[0]),this.ctx.transform(...o.transform),this.viewportScale=o.scale,this.baseTransform=(0,d.getCurrentTransform)(this.ctx)}executeOperatorList(i,o,r,h){const p=i.argsArray,P=i.fnArray;let O=o||0;const H=p.length;if(H===O)return O;const nt=H-O>I&&typeof r=="function",J=nt?Date.now()+f:0;let ot=0;const ht=this.commonObjs,ft=this.objs;let dt;for(;;){if(h!==void 0&&O===h.nextBreakPoint)return h.breakIt(O,r),O;if(dt=P[O],dt!==n.OPS.dependency)this[dt].apply(this,p[O]);else for(const wt of p[O]){const Lt=wt.startsWith("g_")?ht:ft;if(!Lt.has(wt))return Lt.get(wt,r),O}if(O++,O===H)return O;if(nt&&++ot>I){if(Date.now()>J)return r(),O;ot=0}}}endDrawing(){X(this,G,Ze).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const i of this._cachedBitmapsMap.values()){for(const o of i.values())typeof HTMLCanvasElement<"u"&&o instanceof HTMLCanvasElement&&(o.width=o.height=0);i.clear()}this._cachedBitmapsMap.clear(),X(this,gt,Qe).call(this)}_scaleImage(i,o){const r=i.width,h=i.height;let p=Math.max(Math.hypot(o[0],o[1]),1),P=Math.max(Math.hypot(o[2],o[3]),1),O=r,H=h,nt="prescale1",J,ot;for(;p>2&&O>1||P>2&&H>1;){let ht=O,ft=H;p>2&&O>1&&(ht=O>=16384?Math.floor(O/2)-1||1:Math.ceil(O/2),p/=O/ht),P>2&&H>1&&(ft=H>=16384?Math.floor(H/2)-1||1:Math.ceil(H)/2,P/=H/ft),J=this.cachedCanvases.getCanvas(nt,ht,ft),ot=J.context,ot.clearRect(0,0,ht,ft),ot.drawImage(i,0,0,O,H,0,0,ht,ft),i=J.canvas,O=ht,H=ft,nt=nt==="prescale1"?"prescale2":"prescale1"}return{img:i,paintWidth:O,paintHeight:H}}_createMaskCanvas(i){const o=this.ctx,{width:r,height:h}=i,p=this.current.fillColor,P=this.current.patternFill,O=(0,d.getCurrentTransform)(o);let H,nt,J,ot;if((i.bitmap||i.data)&&i.count>1){const Tt=i.bitmap||i.data.buffer;nt=JSON.stringify(P?O:[O.slice(0,4),p]),H=this._cachedBitmapsMap.get(Tt),H||(H=new Map,this._cachedBitmapsMap.set(Tt,H));const Ct=H.get(nt);if(Ct&&!P){const Ut=Math.round(Math.min(O[0],O[2])+O[4]),zt=Math.round(Math.min(O[1],O[3])+O[5]);return{canvas:Ct,offsetX:Ut,offsetY:zt}}J=Ct}J||(ot=this.cachedCanvases.getCanvas("maskCanvas",r,h),_(ot.context,i));let ht=n.Util.transform(O,[1/r,0,0,-1/h,0,0]);ht=n.Util.transform(ht,[1,0,0,1,0,-h]);const ft=n.Util.applyTransform([0,0],ht),dt=n.Util.applyTransform([r,h],ht),wt=n.Util.normalizeRect([ft[0],ft[1],dt[0],dt[1]]),Lt=Math.round(wt[2]-wt[0])||1,vt=Math.round(wt[3]-wt[1])||1,Dt=this.cachedCanvases.getCanvas("fillCanvas",Lt,vt),mt=Dt.context,et=Math.min(ft[0],dt[0]),Q=Math.min(ft[1],dt[1]);mt.translate(-et,-Q),mt.transform(...ht),J||(J=this._scaleImage(ot.canvas,(0,d.getCurrentTransformInverse)(mt)),J=J.img,H&&P&&H.set(nt,J)),mt.imageSmoothingEnabled=$((0,d.getCurrentTransform)(mt),i.interpolate),u(mt,J,0,0,J.width,J.height,0,0,r,h),mt.globalCompositeOperation="source-in";const pt=n.Util.transform((0,d.getCurrentTransformInverse)(mt),[1,0,0,1,-et,-Q]);return mt.fillStyle=P?p.getPattern(o,this,pt,W.PathType.FILL):p,mt.fillRect(0,0,r,h),H&&!P&&(this.cachedCanvases.delete("fillCanvas"),H.set(nt,Dt.canvas)),{canvas:Dt.canvas,offsetX:Math.round(et),offsetY:Math.round(Q)}}setLineWidth(i){i!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=i,this.ctx.lineWidth=i}setLineCap(i){this.ctx.lineCap=z[i]}setLineJoin(i){this.ctx.lineJoin=R[i]}setMiterLimit(i){this.ctx.miterLimit=i}setDash(i,o){const r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(i),r.lineDashOffset=o)}setRenderingIntent(i){}setFlatness(i){}setGState(i){for(const[o,r]of i)switch(o){case"LW":this.setLineWidth(r);break;case"LC":this.setLineCap(r);break;case"LJ":this.setLineJoin(r);break;case"ML":this.setMiterLimit(r);break;case"D":this.setDash(r[0],r[1]);break;case"RI":this.setRenderingIntent(r);break;case"FL":this.setFlatness(r);break;case"Font":this.setFont(r[0],r[1]);break;case"CA":this.current.strokeAlpha=r;break;case"ca":this.current.fillAlpha=r,this.ctx.globalAlpha=r;break;case"BM":this.ctx.globalCompositeOperation=r;break;case"SMask":this.current.activeSMask=r?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(r);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const i=this.inSMaskMode;this.current.activeSMask&&!i?this.beginSMaskMode():!this.current.activeSMask&&i&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const i=this.ctx.canvas.width,o=this.ctx.canvas.height,r="smaskGroupAt"+this.groupLevel,h=this.cachedCanvases.getCanvas(r,i,o);this.suspendedCtx=this.ctx,this.ctx=h.context;const p=this.ctx;p.setTransform(...(0,d.getCurrentTransform)(this.suspendedCtx)),a(this.suspendedCtx,p),g(p,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),a(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(i){if(!this.current.activeSMask)return;i?(i[0]=Math.floor(i[0]),i[1]=Math.floor(i[1]),i[2]=Math.ceil(i[2]),i[3]=Math.ceil(i[3])):i=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const o=this.current.activeSMask,r=this.suspendedCtx;m(r,o,this.ctx,i),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(a(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const i=this.current;this.stateStack.push(i),this.current=i.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),a(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(i,o,r,h,p,P){this.ctx.transform(i,o,r,h,p,P),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(i,o,r){const h=this.ctx,p=this.current;let P=p.x,O=p.y,H,nt;const J=(0,d.getCurrentTransform)(h),ot=J[0]===0&&J[3]===0||J[1]===0&&J[2]===0,ht=ot?r.slice(0):null;for(let ft=0,dt=0,wt=i.length;ft<wt;ft++)switch(i[ft]|0){case n.OPS.rectangle:P=o[dt++],O=o[dt++];const Lt=o[dt++],vt=o[dt++],Dt=P+Lt,mt=O+vt;h.moveTo(P,O),Lt===0||vt===0?h.lineTo(Dt,mt):(h.lineTo(Dt,O),h.lineTo(Dt,mt),h.lineTo(P,mt)),ot||p.updateRectMinMax(J,[P,O,Dt,mt]),h.closePath();break;case n.OPS.moveTo:P=o[dt++],O=o[dt++],h.moveTo(P,O),ot||p.updatePathMinMax(J,P,O);break;case n.OPS.lineTo:P=o[dt++],O=o[dt++],h.lineTo(P,O),ot||p.updatePathMinMax(J,P,O);break;case n.OPS.curveTo:H=P,nt=O,P=o[dt+4],O=o[dt+5],h.bezierCurveTo(o[dt],o[dt+1],o[dt+2],o[dt+3],P,O),p.updateCurvePathMinMax(J,H,nt,o[dt],o[dt+1],o[dt+2],o[dt+3],P,O,ht),dt+=6;break;case n.OPS.curveTo2:H=P,nt=O,h.bezierCurveTo(P,O,o[dt],o[dt+1],o[dt+2],o[dt+3]),p.updateCurvePathMinMax(J,H,nt,P,O,o[dt],o[dt+1],o[dt+2],o[dt+3],ht),P=o[dt+2],O=o[dt+3],dt+=4;break;case n.OPS.curveTo3:H=P,nt=O,P=o[dt+2],O=o[dt+3],h.bezierCurveTo(o[dt],o[dt+1],P,O,P,O),p.updateCurvePathMinMax(J,H,nt,o[dt],o[dt+1],P,O,P,O,ht),dt+=4;break;case n.OPS.closePath:h.closePath();break}ot&&p.updateScalingPathMinMax(J,ht),p.setCurrentPoint(P,O)}closePath(){this.ctx.closePath()}stroke(i=!0){const o=this.ctx,r=this.current.strokeColor;o.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof r=="object"&&(r!=null&&r.getPattern)?(o.save(),o.strokeStyle=r.getPattern(o,this,(0,d.getCurrentTransformInverse)(o),W.PathType.STROKE),this.rescaleAndStroke(!1),o.restore()):this.rescaleAndStroke(!0)),i&&this.consumePath(this.current.getClippedPathBoundingBox()),o.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(i=!0){const o=this.ctx,r=this.current.fillColor,h=this.current.patternFill;let p=!1;h&&(o.save(),o.fillStyle=r.getPattern(o,this,(0,d.getCurrentTransformInverse)(o),W.PathType.FILL),p=!0);const P=this.current.getClippedPathBoundingBox();this.contentVisible&&P!==null&&(this.pendingEOFill?(o.fill("evenodd"),this.pendingEOFill=!1):o.fill()),p&&o.restore(),i&&this.consumePath(P)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=V}eoClip(){this.pendingClip=st}beginText(){this.current.textMatrix=n.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const i=this.pendingTextPaths,o=this.ctx;if(i===void 0){o.beginPath();return}o.save(),o.beginPath();for(const r of i)o.setTransform(...r.transform),o.translate(r.x,r.y),r.addToPath(o,r.fontSize);o.restore(),o.clip(),o.beginPath(),delete this.pendingTextPaths}setCharSpacing(i){this.current.charSpacing=i}setWordSpacing(i){this.current.wordSpacing=i}setHScale(i){this.current.textHScale=i/100}setLeading(i){this.current.leading=-i}setFont(i,o){var J;const r=this.commonObjs.get(i),h=this.current;if(!r)throw new Error(`Can't find font for ${i}`);if(h.fontMatrix=r.fontMatrix||n.FONT_IDENTITY_MATRIX,(h.fontMatrix[0]===0||h.fontMatrix[3]===0)&&(0,n.warn)("Invalid font matrix for font "+i),o<0?(o=-o,h.fontDirection=-1):h.fontDirection=1,this.current.font=r,this.current.fontSize=o,r.isType3Font)return;const p=r.loadedName||"sans-serif",P=((J=r.systemFontInfo)==null?void 0:J.css)||`"${p}", ${r.fallbackName}`;let O="normal";r.black?O="900":r.bold&&(O="bold");const H=r.italic?"italic":"normal";let nt=o;o<it?nt=it:o>k&&(nt=k),this.current.fontSizeScale=o/nt,this.ctx.font=`${H} ${O} ${nt}px ${P}`}setTextRenderingMode(i){this.current.textRenderingMode=i}setTextRise(i){this.current.textRise=i}moveText(i,o){this.current.x=this.current.lineX+=i,this.current.y=this.current.lineY+=o}setLeadingMoveText(i,o){this.setLeading(-o),this.moveText(i,o)}setTextMatrix(i,o,r,h,p,P){this.current.textMatrix=[i,o,r,h,p,P],this.current.textMatrixScale=Math.hypot(i,o),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(i,o,r,h){const p=this.ctx,P=this.current,O=P.font,H=P.textRenderingMode,nt=P.fontSize/P.fontSizeScale,J=H&n.TextRenderingMode.FILL_STROKE_MASK,ot=!!(H&n.TextRenderingMode.ADD_TO_PATH_FLAG),ht=P.patternFill&&!O.missingFile;let ft;(O.disableFontFace||ot||ht)&&(ft=O.getPathGenerator(this.commonObjs,i)),O.disableFontFace||ht?(p.save(),p.translate(o,r),p.beginPath(),ft(p,nt),h&&p.setTransform(...h),(J===n.TextRenderingMode.FILL||J===n.TextRenderingMode.FILL_STROKE)&&p.fill(),(J===n.TextRenderingMode.STROKE||J===n.TextRenderingMode.FILL_STROKE)&&p.stroke(),p.restore()):((J===n.TextRenderingMode.FILL||J===n.TextRenderingMode.FILL_STROKE)&&p.fillText(i,o,r),(J===n.TextRenderingMode.STROKE||J===n.TextRenderingMode.FILL_STROKE)&&p.strokeText(i,o,r)),ot&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,d.getCurrentTransform)(p),x:o,y:r,fontSize:nt,addToPath:ft})}get isFontSubpixelAAEnabled(){const{context:i}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);i.scale(1.5,1),i.fillText("I",0,10);const o=i.getImageData(0,0,10,10).data;let r=!1;for(let h=3;h<o.length;h+=4)if(o[h]>0&&o[h]<255){r=!0;break}return(0,n.shadow)(this,"isFontSubpixelAAEnabled",r)}showText(i){const o=this.current,r=o.font;if(r.isType3Font)return this.showType3Text(i);const h=o.fontSize;if(h===0)return;const p=this.ctx,P=o.fontSizeScale,O=o.charSpacing,H=o.wordSpacing,nt=o.fontDirection,J=o.textHScale*nt,ot=i.length,ht=r.vertical,ft=ht?1:-1,dt=r.defaultVMetrics,wt=h*o.fontMatrix[0],Lt=o.textRenderingMode===n.TextRenderingMode.FILL&&!r.disableFontFace&&!o.patternFill;p.save(),p.transform(...o.textMatrix),p.translate(o.x,o.y+o.textRise),nt>0?p.scale(J,-1):p.scale(J,1);let vt;if(o.patternFill){p.save();const pt=o.fillColor.getPattern(p,this,(0,d.getCurrentTransformInverse)(p),W.PathType.FILL);vt=(0,d.getCurrentTransform)(p),p.restore(),p.fillStyle=pt}let Dt=o.lineWidth;const mt=o.textMatrixScale;if(mt===0||Dt===0){const pt=o.textRenderingMode&n.TextRenderingMode.FILL_STROKE_MASK;(pt===n.TextRenderingMode.STROKE||pt===n.TextRenderingMode.FILL_STROKE)&&(Dt=this.getSinglePixelWidth())}else Dt/=mt;if(P!==1&&(p.scale(P,P),Dt/=P),p.lineWidth=Dt,r.isInvalidPDFjsFont){const pt=[];let Tt=0;for(const Ct of i)pt.push(Ct.unicode),Tt+=Ct.width;p.fillText(pt.join(""),0,0),o.x+=Tt*wt*J,p.restore(),this.compose();return}let et=0,Q;for(Q=0;Q<ot;++Q){const pt=i[Q];if(typeof pt=="number"){et+=ft*pt*h/1e3;continue}let Tt=!1;const Ct=(pt.isSpace?H:0)+O,Ut=pt.fontChar,zt=pt.accent;let Wt,$t,Gt=pt.width;if(ht){const Xt=pt.vmetric||dt,ut=-(pt.vmetric?Xt[1]:Gt*.5)*wt,tt=Xt[2]*wt;Gt=Xt?-Xt[0]:Gt,Wt=ut/P,$t=(et+tt)/P}else Wt=et/P,$t=0;if(r.remeasure&&Gt>0){const Xt=p.measureText(Ut).width*1e3/h*P;if(Gt<Xt&&this.isFontSubpixelAAEnabled){const ut=Gt/Xt;Tt=!0,p.save(),p.scale(ut,1),Wt/=ut}else Gt!==Xt&&(Wt+=(Gt-Xt)/2e3*h/P)}if(this.contentVisible&&(pt.isInFont||r.missingFile)){if(Lt&&!zt)p.fillText(Ut,Wt,$t);else if(this.paintChar(Ut,Wt,$t,vt),zt){const Xt=Wt+h*zt.offset.x/P,ut=$t-h*zt.offset.y/P;this.paintChar(zt.fontChar,Xt,ut,vt)}}const Bt=ht?Gt*wt-Ct*nt:Gt*wt+Ct*nt;et+=Bt,Tt&&p.restore()}ht?o.y-=et:o.x+=et*J,p.restore(),this.compose()}showType3Text(i){const o=this.ctx,r=this.current,h=r.font,p=r.fontSize,P=r.fontDirection,O=h.vertical?1:-1,H=r.charSpacing,nt=r.wordSpacing,J=r.textHScale*P,ot=r.fontMatrix||n.FONT_IDENTITY_MATRIX,ht=i.length,ft=r.textRenderingMode===n.TextRenderingMode.INVISIBLE;let dt,wt,Lt,vt;if(!(ft||p===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,o.save(),o.transform(...r.textMatrix),o.translate(r.x,r.y),o.scale(J,P),dt=0;dt<ht;++dt){if(wt=i[dt],typeof wt=="number"){vt=O*wt*p/1e3,this.ctx.translate(vt,0),r.x+=vt*J;continue}const Dt=(wt.isSpace?nt:0)+H,mt=h.charProcOperatorList[wt.operatorListId];if(!mt){(0,n.warn)(`Type3 character "${wt.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=wt,this.save(),o.scale(p,p),o.transform(...ot),this.executeOperatorList(mt),this.restore()),Lt=n.Util.applyTransform([wt.width,0],ot)[0]*p+Dt,o.translate(Lt,0),r.x+=Lt*J}o.restore(),this.processingType3=null}}setCharWidth(i,o){}setCharWidthAndBounds(i,o,r,h,p,P){this.ctx.rect(r,h,p-r,P-h),this.ctx.clip(),this.endPath()}getColorN_Pattern(i){let o;if(i[0]==="TilingPattern"){const r=i[1],h=this.baseTransform||(0,d.getCurrentTransform)(this.ctx),p={createCanvasGraphics:P=>new Et(P,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};o=new W.TilingPattern(i,r,this.ctx,p,h)}else o=this._getPattern(i[1],i[2]);return o}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(i,o,r){const h=n.Util.makeHexColor(i,o,r);this.ctx.strokeStyle=h,this.current.strokeColor=h}setFillRGBColor(i,o,r){const h=n.Util.makeHexColor(i,o,r);this.ctx.fillStyle=h,this.current.fillColor=h,this.current.patternFill=!1}_getPattern(i,o=null){let r;return this.cachedPatterns.has(i)?r=this.cachedPatterns.get(i):(r=(0,W.getShadingPattern)(this.getObject(i)),this.cachedPatterns.set(i,r)),o&&(r.matrix=o),r}shadingFill(i){if(!this.contentVisible)return;const o=this.ctx;this.save();const r=this._getPattern(i);o.fillStyle=r.getPattern(o,this,(0,d.getCurrentTransformInverse)(o),W.PathType.SHADING);const h=(0,d.getCurrentTransformInverse)(o);if(h){const{width:p,height:P}=o.canvas,[O,H,nt,J]=n.Util.getAxialAlignedBoundingBox([0,0,p,P],h);this.ctx.fillRect(O,H,nt-O,J-H)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,n.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,n.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(i,o){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(i)&&i.length===6&&this.transform(...i),this.baseTransform=(0,d.getCurrentTransform)(this.ctx),o)){const r=o[2]-o[0],h=o[3]-o[1];this.ctx.rect(o[0],o[1],r,h),this.current.updateRectMinMax((0,d.getCurrentTransform)(this.ctx),o),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(i){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const o=this.ctx;i.isolated||(0,n.info)("TODO: Support non-isolated groups."),i.knockout&&(0,n.warn)("Knockout groups not supported.");const r=(0,d.getCurrentTransform)(o);if(i.matrix&&o.transform(...i.matrix),!i.bbox)throw new Error("Bounding box is required.");let h=n.Util.getAxialAlignedBoundingBox(i.bbox,(0,d.getCurrentTransform)(o));const p=[0,0,o.canvas.width,o.canvas.height];h=n.Util.intersect(h,p)||[0,0,0,0];const P=Math.floor(h[0]),O=Math.floor(h[1]);let H=Math.max(Math.ceil(h[2])-P,1),nt=Math.max(Math.ceil(h[3])-O,1),J=1,ot=1;H>S&&(J=H/S,H=S),nt>S&&(ot=nt/S,nt=S),this.current.startNewPathAndClipBox([0,0,H,nt]);let ht="groupAt"+this.groupLevel;i.smask&&(ht+="_smask_"+this.smaskCounter++%2);const ft=this.cachedCanvases.getCanvas(ht,H,nt),dt=ft.context;dt.scale(1/J,1/ot),dt.translate(-P,-O),dt.transform(...r),i.smask?this.smaskStack.push({canvas:ft.canvas,context:dt,offsetX:P,offsetY:O,scaleX:J,scaleY:ot,subtype:i.smask.subtype,backdrop:i.smask.backdrop,transferMap:i.smask.transferMap||null,startTransformInverse:null}):(o.setTransform(1,0,0,1,0,0),o.translate(P,O),o.scale(J,ot),o.save()),a(o,dt),this.ctx=dt,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(o),this.groupLevel++}endGroup(i){if(!this.contentVisible)return;this.groupLevel--;const o=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,i.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const h=(0,d.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...h);const p=n.Util.getAxialAlignedBoundingBox([0,0,o.canvas.width,o.canvas.height],h);this.ctx.drawImage(o.canvas,0,0),this.ctx.restore(),this.compose(p)}}beginAnnotation(i,o,r,h,p){if(X(this,G,Ze).call(this),c(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(o)&&o.length===4){const P=o[2]-o[0],O=o[3]-o[1];if(p&&this.annotationCanvasMap){r=r.slice(),r[4]-=o[0],r[5]-=o[1],o=o.slice(),o[0]=o[1]=0,o[2]=P,o[3]=O;const[H,nt]=n.Util.singularValueDecompose2dScale((0,d.getCurrentTransform)(this.ctx)),{viewportScale:J}=this,ot=Math.ceil(P*this.outputScaleX*J),ht=Math.ceil(O*this.outputScaleY*J);this.annotationCanvas=this.canvasFactory.create(ot,ht);const{canvas:ft,context:dt}=this.annotationCanvas;this.annotationCanvasMap.set(i,ft),this.annotationCanvas.savedCtx=this.ctx,this.ctx=dt,this.ctx.save(),this.ctx.setTransform(H,0,0,-nt,0,O*nt),c(this.ctx)}else c(this.ctx),this.ctx.rect(o[0],o[1],P,O),this.ctx.clip(),this.endPath()}this.current=new C(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...r),this.transform(...h)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),X(this,gt,Qe).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(i){if(!this.contentVisible)return;const o=i.count;i=this.getObject(i.data,i),i.count=o;const r=this.ctx,h=this.processingType3;if(h&&(h.compiled===void 0&&(h.compiled=y(i)),h.compiled)){h.compiled(r);return}const p=this._createMaskCanvas(i),P=p.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(P,p.offsetX,p.offsetY),r.restore(),this.compose()}paintImageMaskXObjectRepeat(i,o,r=0,h=0,p,P){if(!this.contentVisible)return;i=this.getObject(i.data,i);const O=this.ctx;O.save();const H=(0,d.getCurrentTransform)(O);O.transform(o,r,h,p,0,0);const nt=this._createMaskCanvas(i);O.setTransform(1,0,0,1,nt.offsetX-H[4],nt.offsetY-H[5]);for(let J=0,ot=P.length;J<ot;J+=2){const ht=n.Util.transform(H,[o,r,h,p,P[J],P[J+1]]),[ft,dt]=n.Util.applyTransform([0,0],ht);O.drawImage(nt.canvas,ft,dt)}O.restore(),this.compose()}paintImageMaskXObjectGroup(i){if(!this.contentVisible)return;const o=this.ctx,r=this.current.fillColor,h=this.current.patternFill;for(const p of i){const{data:P,width:O,height:H,transform:nt}=p,J=this.cachedCanvases.getCanvas("maskCanvas",O,H),ot=J.context;ot.save();const ht=this.getObject(P,p);_(ot,ht),ot.globalCompositeOperation="source-in",ot.fillStyle=h?r.getPattern(ot,this,(0,d.getCurrentTransformInverse)(o),W.PathType.FILL):r,ot.fillRect(0,0,O,H),ot.restore(),o.save(),o.transform(...nt),o.scale(1,-1),u(o,J.canvas,0,0,O,H,0,-1,1,1),o.restore()}this.compose()}paintImageXObject(i){if(!this.contentVisible)return;const o=this.getObject(i);if(!o){(0,n.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(o)}paintImageXObjectRepeat(i,o,r,h){if(!this.contentVisible)return;const p=this.getObject(i);if(!p){(0,n.warn)("Dependent image isn't ready yet");return}const P=p.width,O=p.height,H=[];for(let nt=0,J=h.length;nt<J;nt+=2)H.push({transform:[o,0,0,r,h[nt],h[nt+1]],x:0,y:0,w:P,h:O});this.paintInlineImageXObjectGroup(p,H)}applyTransferMapsToCanvas(i){return this.current.transferMaps!=="none"&&(i.filter=this.current.transferMaps,i.drawImage(i.canvas,0,0),i.filter="none"),i.canvas}applyTransferMapsToBitmap(i){if(this.current.transferMaps==="none")return i.bitmap;const{bitmap:o,width:r,height:h}=i,p=this.cachedCanvases.getCanvas("inlineImage",r,h),P=p.context;return P.filter=this.current.transferMaps,P.drawImage(o,0,0),P.filter="none",p.canvas}paintInlineImageXObject(i){if(!this.contentVisible)return;const o=i.width,r=i.height,h=this.ctx;if(this.save(),!n.isNodeJS){const{filter:O}=h;O!=="none"&&O!==""&&(h.filter="none")}h.scale(1/o,-1/r);let p;if(i.bitmap)p=this.applyTransferMapsToBitmap(i);else if(typeof HTMLElement=="function"&&i instanceof HTMLElement||!i.data)p=i;else{const H=this.cachedCanvases.getCanvas("inlineImage",o,r).context;w(H,i),p=this.applyTransferMapsToCanvas(H)}const P=this._scaleImage(p,(0,d.getCurrentTransformInverse)(h));h.imageSmoothingEnabled=$((0,d.getCurrentTransform)(h),i.interpolate),u(h,P.img,0,0,P.paintWidth,P.paintHeight,0,-r,o,r),this.compose(),this.restore()}paintInlineImageXObjectGroup(i,o){if(!this.contentVisible)return;const r=this.ctx;let h;if(i.bitmap)h=i.bitmap;else{const p=i.width,P=i.height,H=this.cachedCanvases.getCanvas("inlineImage",p,P).context;w(H,i),h=this.applyTransferMapsToCanvas(H)}for(const p of o)r.save(),r.transform(...p.transform),r.scale(1,-1),u(r,h,p.x,p.y,p.w,p.h,0,-1,1,1),r.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(i){}markPointProps(i,o){}beginMarkedContent(i){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(i,o){i==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(o)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(i){const o=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const r=this.ctx;this.pendingClip&&(o||(this.pendingClip===st?r.clip("evenodd"):r.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),r.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const i=(0,d.getCurrentTransform)(this.ctx);if(i[1]===0&&i[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(i[0]),Math.abs(i[3]));else{const o=Math.abs(i[0]*i[3]-i[2]*i[1]),r=Math.hypot(i[0],i[2]),h=Math.hypot(i[1],i[3]);this._cachedGetSinglePixelWidth=Math.max(r,h)/o}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:i}=this.current,{a:o,b:r,c:h,d:p}=this.ctx.getTransform();let P,O;if(r===0&&h===0){const H=Math.abs(o),nt=Math.abs(p);if(H===nt)if(i===0)P=O=1/H;else{const J=H*i;P=O=J<1?1/J:1}else if(i===0)P=1/H,O=1/nt;else{const J=H*i,ot=nt*i;P=J<1?1/J:1,O=ot<1?1/ot:1}}else{const H=Math.abs(o*p-r*h),nt=Math.hypot(o,r),J=Math.hypot(h,p);if(i===0)P=J/H,O=nt/H;else{const ot=i*H;P=J>ot?J/ot:1,O=nt>ot?nt/ot:1}}this._cachedScaleForStroking[0]=P,this._cachedScaleForStroking[1]=O}return this._cachedScaleForStroking}rescaleAndStroke(i){const{ctx:o}=this,{lineWidth:r}=this.current,[h,p]=this.getScaleForStroking();if(o.lineWidth=r||1,h===1&&p===1){o.stroke();return}const P=o.getLineDash();if(i&&o.save(),o.scale(h,p),P.length>0){const O=Math.max(h,p);o.setLineDash(P.map(H=>H/O)),o.lineDashOffset/=O}o.stroke(),i&&o.restore()}isContentVisible(){for(let i=this.markedContentStack.length-1;i>=0;i--)if(!this.markedContentStack[i].visible)return!1;return!0}};G=new WeakSet,Ze=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},gt=new WeakSet,Qe=function(){if(this.pageColors){const i=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(i!=="none"){const o=this.ctx.filter;this.ctx.filter=i,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=o}}};let at=Et;e.CanvasGraphics=at;for(const M in n.OPS)at.prototype[M]!==void 0&&(at.prototype[n.OPS[M]]=at.prototype[M])},(b,e,v)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TilingPattern=e.PathType=void 0,e.getShadingPattern=E;var n=v(1),d=v(6);const W={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};e.PathType=W;function j(y,C){if(!C)return;const w=C[2]-C[0],_=C[3]-C[1],a=new Path2D;a.rect(C[0],C[1],w,_),y.clip(a)}class it{constructor(){this.constructor===it&&(0,n.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,n.unreachable)("Abstract method `getPattern` called.")}}class k extends it{constructor(C){super(),this._type=C[1],this._bbox=C[2],this._colorStops=C[3],this._p0=C[4],this._p1=C[5],this._r0=C[6],this._r1=C[7],this.matrix=null}_createGradient(C){let w;this._type==="axial"?w=C.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(w=C.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const _ of this._colorStops)w.addColorStop(_[0],_[1]);return w}getPattern(C,w,_,a){let c;if(a===W.STROKE||a===W.FILL){const L=w.current.getClippedPathBoundingBox(a,(0,d.getCurrentTransform)(C))||[0,0,0,0],A=Math.ceil(L[2]-L[0])||1,l=Math.ceil(L[3]-L[1])||1,F=w.cachedCanvases.getCanvas("pattern",A,l,!0),m=F.context;m.clearRect(0,0,m.canvas.width,m.canvas.height),m.beginPath(),m.rect(0,0,m.canvas.width,m.canvas.height),m.translate(-L[0],-L[1]),_=n.Util.transform(_,[1,0,0,1,L[0],L[1]]),m.transform(...w.baseTransform),this.matrix&&m.transform(...this.matrix),j(m,this._bbox),m.fillStyle=this._createGradient(m),m.fill(),c=C.createPattern(F.canvas,"no-repeat");const $=new DOMMatrix(_);c.setTransform($)}else j(C,this._bbox),c=this._createGradient(C);return c}}function S(y,C,w,_,a,c,L,A){const l=C.coords,F=C.colors,m=y.data,$=y.width*4;let z;l[w+1]>l[_+1]&&(z=w,w=_,_=z,z=c,c=L,L=z),l[_+1]>l[a+1]&&(z=_,_=a,a=z,z=L,L=A,A=z),l[w+1]>l[_+1]&&(z=w,w=_,_=z,z=c,c=L,L=z);const R=(l[w]+C.offsetX)*C.scaleX,V=(l[w+1]+C.offsetY)*C.scaleY,st=(l[_]+C.offsetX)*C.scaleX,at=(l[_+1]+C.offsetY)*C.scaleY,G=(l[a]+C.offsetX)*C.scaleX,ct=(l[a+1]+C.offsetY)*C.scaleY;if(V>=ct)return;const gt=F[c],xt=F[c+1],Et=F[c+2],M=F[L],i=F[L+1],o=F[L+2],r=F[A],h=F[A+1],p=F[A+2],P=Math.round(V),O=Math.round(ct);let H,nt,J,ot,ht,ft,dt,wt;for(let Lt=P;Lt<=O;Lt++){if(Lt<at){const Q=Lt<V?0:(V-Lt)/(V-at);H=R-(R-st)*Q,nt=gt-(gt-M)*Q,J=xt-(xt-i)*Q,ot=Et-(Et-o)*Q}else{let Q;Lt>ct?Q=1:at===ct?Q=0:Q=(at-Lt)/(at-ct),H=st-(st-G)*Q,nt=M-(M-r)*Q,J=i-(i-h)*Q,ot=o-(o-p)*Q}let vt;Lt<V?vt=0:Lt>ct?vt=1:vt=(V-Lt)/(V-ct),ht=R-(R-G)*vt,ft=gt-(gt-r)*vt,dt=xt-(xt-h)*vt,wt=Et-(Et-p)*vt;const Dt=Math.round(Math.min(H,ht)),mt=Math.round(Math.max(H,ht));let et=$*Lt+Dt*4;for(let Q=Dt;Q<=mt;Q++)vt=(H-Q)/(H-ht),vt<0?vt=0:vt>1&&(vt=1),m[et++]=nt-(nt-ft)*vt|0,m[et++]=J-(J-dt)*vt|0,m[et++]=ot-(ot-wt)*vt|0,m[et++]=255}}function f(y,C,w){const _=C.coords,a=C.colors;let c,L;switch(C.type){case"lattice":const A=C.verticesPerRow,l=Math.floor(_.length/A)-1,F=A-1;for(c=0;c<l;c++){let m=c*A;for(let $=0;$<F;$++,m++)S(y,w,_[m],_[m+1],_[m+A],a[m],a[m+1],a[m+A]),S(y,w,_[m+A+1],_[m+1],_[m+A],a[m+A+1],a[m+1],a[m+A])}break;case"triangles":for(c=0,L=_.length;c<L;c+=3)S(y,w,_[c],_[c+1],_[c+2],a[c],a[c+1],a[c+2]);break;default:throw new Error("illegal figure")}}class I extends it{constructor(C){super(),this._coords=C[2],this._colors=C[3],this._figures=C[4],this._bounds=C[5],this._bbox=C[7],this._background=C[8],this.matrix=null}_createMeshCanvas(C,w,_){const A=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),F=Math.ceil(this._bounds[2])-A,m=Math.ceil(this._bounds[3])-l,$=Math.min(Math.ceil(Math.abs(F*C[0]*1.1)),3e3),z=Math.min(Math.ceil(Math.abs(m*C[1]*1.1)),3e3),R=F/$,V=m/z,st={coords:this._coords,colors:this._colors,offsetX:-A,offsetY:-l,scaleX:1/R,scaleY:1/V},at=$+2*2,G=z+2*2,ct=_.getCanvas("mesh",at,G,!1),gt=ct.context,xt=gt.createImageData($,z);if(w){const M=xt.data;for(let i=0,o=M.length;i<o;i+=4)M[i]=w[0],M[i+1]=w[1],M[i+2]=w[2],M[i+3]=255}for(const M of this._figures)f(xt,M,st);return gt.putImageData(xt,2,2),{canvas:ct.canvas,offsetX:A-2*R,offsetY:l-2*V,scaleX:R,scaleY:V}}getPattern(C,w,_,a){j(C,this._bbox);let c;if(a===W.SHADING)c=n.Util.singularValueDecompose2dScale((0,d.getCurrentTransform)(C));else if(c=n.Util.singularValueDecompose2dScale(w.baseTransform),this.matrix){const A=n.Util.singularValueDecompose2dScale(this.matrix);c=[c[0]*A[0],c[1]*A[1]]}const L=this._createMeshCanvas(c,a===W.SHADING?null:this._background,w.cachedCanvases);return a!==W.SHADING&&(C.setTransform(...w.baseTransform),this.matrix&&C.transform(...this.matrix)),C.translate(L.offsetX,L.offsetY),C.scale(L.scaleX,L.scaleY),C.createPattern(L.canvas,"no-repeat")}}class D extends it{getPattern(){return"hotpink"}}function E(y){switch(y[0]){case"RadialAxial":return new k(y);case"Mesh":return new I(y);case"Dummy":return new D}throw new Error(`Unknown IR type: ${y[0]}`)}const g={COLORED:1,UNCOLORED:2},u=class u{constructor(C,w,_,a,c){this.operatorList=C[2],this.matrix=C[3]||[1,0,0,1,0,0],this.bbox=C[4],this.xstep=C[5],this.ystep=C[6],this.paintType=C[7],this.tilingType=C[8],this.color=w,this.ctx=_,this.canvasGraphicsFactory=a,this.baseTransform=c}createPatternCanvas(C){const w=this.operatorList,_=this.bbox,a=this.xstep,c=this.ystep,L=this.paintType,A=this.tilingType,l=this.color,F=this.canvasGraphicsFactory;(0,n.info)("TilingType: "+A);const m=_[0],$=_[1],z=_[2],R=_[3],V=n.Util.singularValueDecompose2dScale(this.matrix),st=n.Util.singularValueDecompose2dScale(this.baseTransform),at=[V[0]*st[0],V[1]*st[1]],G=this.getSizeAndScale(a,this.ctx.canvas.width,at[0]),ct=this.getSizeAndScale(c,this.ctx.canvas.height,at[1]),gt=C.cachedCanvases.getCanvas("pattern",G.size,ct.size,!0),xt=gt.context,Et=F.createCanvasGraphics(xt);Et.groupLevel=C.groupLevel,this.setFillAndStrokeStyleToContext(Et,L,l);let M=m,i=$,o=z,r=R;return m<0&&(M=0,o+=Math.abs(m)),$<0&&(i=0,r+=Math.abs($)),xt.translate(-(G.scale*M),-(ct.scale*i)),Et.transform(G.scale,0,0,ct.scale,0,0),xt.save(),this.clipBbox(Et,M,i,o,r),Et.baseTransform=(0,d.getCurrentTransform)(Et.ctx),Et.executeOperatorList(w),Et.endDrawing(),{canvas:gt.canvas,scaleX:G.scale,scaleY:ct.scale,offsetX:M,offsetY:i}}getSizeAndScale(C,w,_){C=Math.abs(C);const a=Math.max(u.MAX_PATTERN_SIZE,w);let c=Math.ceil(C*_);return c>=a?c=a:_=c/C,{scale:_,size:c}}clipBbox(C,w,_,a,c){const L=a-w,A=c-_;C.ctx.rect(w,_,L,A),C.current.updateRectMinMax((0,d.getCurrentTransform)(C.ctx),[w,_,a,c]),C.clip(),C.endPath()}setFillAndStrokeStyleToContext(C,w,_){const a=C.ctx,c=C.current;switch(w){case g.COLORED:const L=this.ctx;a.fillStyle=L.fillStyle,a.strokeStyle=L.strokeStyle,c.fillColor=L.fillStyle,c.strokeColor=L.strokeStyle;break;case g.UNCOLORED:const A=n.Util.makeHexColor(_[0],_[1],_[2]);a.fillStyle=A,a.strokeStyle=A,c.fillColor=A,c.strokeColor=A;break;default:throw new n.FormatError(`Unsupported paint type: ${w}`)}}getPattern(C,w,_,a){let c=_;a!==W.SHADING&&(c=n.Util.transform(c,w.baseTransform),this.matrix&&(c=n.Util.transform(c,this.matrix)));const L=this.createPatternCanvas(w);let A=new DOMMatrix(c);A=A.translate(L.offsetX,L.offsetY),A=A.scale(1/L.scaleX,1/L.scaleY);const l=C.createPattern(L.canvas,"repeat");return l.setTransform(A),l}};ee(u,"MAX_PATTERN_SIZE",3e3);let x=u;e.TilingPattern=x},(b,e,v)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.convertBlackAndWhiteToRGBA=W,e.convertToRGBA=d,e.grayToRGBA=it;var n=v(1);function d(k){switch(k.kind){case n.ImageKind.GRAYSCALE_1BPP:return W(k);case n.ImageKind.RGB_24BPP:return j(k)}return null}function W({src:k,srcPos:S=0,dest:f,width:I,height:D,nonBlackColor:E=4294967295,inverseDecode:g=!1}){const x=n.FeatureTest.isLittleEndian?4278190080:255,[u,y]=g?[E,x]:[x,E],C=I>>3,w=I&7,_=k.length;f=new Uint32Array(f.buffer);let a=0;for(let c=0;c<D;c++){for(const A=S+C;S<A;S++){const l=S<_?k[S]:255;f[a++]=l&128?y:u,f[a++]=l&64?y:u,f[a++]=l&32?y:u,f[a++]=l&16?y:u,f[a++]=l&8?y:u,f[a++]=l&4?y:u,f[a++]=l&2?y:u,f[a++]=l&1?y:u}if(w===0)continue;const L=S<_?k[S++]:255;for(let A=0;A<w;A++)f[a++]=L&1<<7-A?y:u}return{srcPos:S,destPos:a}}function j({src:k,srcPos:S=0,dest:f,destPos:I=0,width:D,height:E}){let g=0;const x=k.length>>2,u=new Uint32Array(k.buffer,S,x);if(n.FeatureTest.isLittleEndian){for(;g<x-2;g+=3,I+=4){const y=u[g],C=u[g+1],w=u[g+2];f[I]=y|4278190080,f[I+1]=y>>>24|C<<8|4278190080,f[I+2]=C>>>16|w<<16|4278190080,f[I+3]=w>>>8|4278190080}for(let y=g*4,C=k.length;y<C;y+=3)f[I++]=k[y]|k[y+1]<<8|k[y+2]<<16|4278190080}else{for(;g<x-2;g+=3,I+=4){const y=u[g],C=u[g+1],w=u[g+2];f[I]=y|255,f[I+1]=y<<24|C>>>8|255,f[I+2]=C<<16|w>>>16|255,f[I+3]=w<<8|255}for(let y=g*4,C=k.length;y<C;y+=3)f[I++]=k[y]<<24|k[y+1]<<16|k[y+2]<<8|255}return{srcPos:S,destPos:I}}function it(k,S){if(n.FeatureTest.isLittleEndian)for(let f=0,I=k.length;f<I;f++)S[f]=k[f]*65793|4278190080;else for(let f=0,I=k.length;f<I;f++)S[f]=k[f]*16843008|255}},(b,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalWorkerOptions=void 0;const v=Object.create(null);e.GlobalWorkerOptions=v,v.workerPort=null,v.workerSrc=""},(b,e,v)=>{var k,Pn,f,kn,D,Re;Object.defineProperty(e,"__esModule",{value:!0}),e.MessageHandler=void 0;var n=v(1);const d={UNKNOWN:0,DATA:1,ERROR:2},W={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function j(g){switch(g instanceof Error||typeof g=="object"&&g!==null||(0,n.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),g.name){case"AbortException":return new n.AbortException(g.message);case"MissingPDFException":return new n.MissingPDFException(g.message);case"PasswordException":return new n.PasswordException(g.message,g.code);case"UnexpectedResponseException":return new n.UnexpectedResponseException(g.message,g.status);case"UnknownErrorException":return new n.UnknownErrorException(g.message,g.details);default:return new n.UnknownErrorException(g.message,g.toString())}}class it{constructor(x,u,y){U(this,k);U(this,f);U(this,D);this.sourceName=x,this.targetName=u,this.comObj=y,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=C=>{const w=C.data;if(w.targetName!==this.sourceName)return;if(w.stream){X(this,f,kn).call(this,w);return}if(w.callback){const a=w.callbackId,c=this.callbackCapabilities[a];if(!c)throw new Error(`Cannot resolve callback ${a}`);if(delete this.callbackCapabilities[a],w.callback===d.DATA)c.resolve(w.data);else if(w.callback===d.ERROR)c.reject(j(w.reason));else throw new Error("Unexpected callback case");return}const _=this.actionHandler[w.action];if(!_)throw new Error(`Unknown action from worker: ${w.action}`);if(w.callbackId){const a=this.sourceName,c=w.sourceName;new Promise(function(L){L(_(w.data))}).then(function(L){y.postMessage({sourceName:a,targetName:c,callback:d.DATA,callbackId:w.callbackId,data:L})},function(L){y.postMessage({sourceName:a,targetName:c,callback:d.ERROR,callbackId:w.callbackId,reason:j(L)})});return}if(w.streamId){X(this,k,Pn).call(this,w);return}_(w.data)},y.addEventListener("message",this._onComObjOnMessage)}on(x,u){const y=this.actionHandler;if(y[x])throw new Error(`There is already an actionName called "${x}"`);y[x]=u}send(x,u,y){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:x,data:u},y)}sendWithPromise(x,u,y){const C=this.callbackId++,w=new n.PromiseCapability;this.callbackCapabilities[C]=w;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:x,callbackId:C,data:u},y)}catch(_){w.reject(_)}return w.promise}sendWithStream(x,u,y,C){const w=this.streamId++,_=this.sourceName,a=this.targetName,c=this.comObj;return new ReadableStream({start:L=>{const A=new n.PromiseCapability;return this.streamControllers[w]={controller:L,startCall:A,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:_,targetName:a,action:x,streamId:w,data:u,desiredSize:L.desiredSize},C),A.promise},pull:L=>{const A=new n.PromiseCapability;return this.streamControllers[w].pullCall=A,c.postMessage({sourceName:_,targetName:a,stream:W.PULL,streamId:w,desiredSize:L.desiredSize}),A.promise},cancel:L=>{(0,n.assert)(L instanceof Error,"cancel must have a valid reason");const A=new n.PromiseCapability;return this.streamControllers[w].cancelCall=A,this.streamControllers[w].isClosed=!0,c.postMessage({sourceName:_,targetName:a,stream:W.CANCEL,streamId:w,reason:j(L)}),A.promise}},y)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}k=new WeakSet,Pn=function(x){const u=x.streamId,y=this.sourceName,C=x.sourceName,w=this.comObj,_=this,a=this.actionHandler[x.action],c={enqueue(L,A=1,l){if(this.isCancelled)return;const F=this.desiredSize;this.desiredSize-=A,F>0&&this.desiredSize<=0&&(this.sinkCapability=new n.PromiseCapability,this.ready=this.sinkCapability.promise),w.postMessage({sourceName:y,targetName:C,stream:W.ENQUEUE,streamId:u,chunk:L},l)},close(){this.isCancelled||(this.isCancelled=!0,w.postMessage({sourceName:y,targetName:C,stream:W.CLOSE,streamId:u}),delete _.streamSinks[u])},error(L){(0,n.assert)(L instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,w.postMessage({sourceName:y,targetName:C,stream:W.ERROR,streamId:u,reason:j(L)}))},sinkCapability:new n.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:x.desiredSize,ready:null};c.sinkCapability.resolve(),c.ready=c.sinkCapability.promise,this.streamSinks[u]=c,new Promise(function(L){L(a(x.data,c))}).then(function(){w.postMessage({sourceName:y,targetName:C,stream:W.START_COMPLETE,streamId:u,success:!0})},function(L){w.postMessage({sourceName:y,targetName:C,stream:W.START_COMPLETE,streamId:u,reason:j(L)})})},f=new WeakSet,kn=function(x){const u=x.streamId,y=this.sourceName,C=x.sourceName,w=this.comObj,_=this.streamControllers[u],a=this.streamSinks[u];switch(x.stream){case W.START_COMPLETE:x.success?_.startCall.resolve():_.startCall.reject(j(x.reason));break;case W.PULL_COMPLETE:x.success?_.pullCall.resolve():_.pullCall.reject(j(x.reason));break;case W.PULL:if(!a){w.postMessage({sourceName:y,targetName:C,stream:W.PULL_COMPLETE,streamId:u,success:!0});break}a.desiredSize<=0&&x.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=x.desiredSize,new Promise(function(c){var L;c((L=a.onPull)==null?void 0:L.call(a))}).then(function(){w.postMessage({sourceName:y,targetName:C,stream:W.PULL_COMPLETE,streamId:u,success:!0})},function(c){w.postMessage({sourceName:y,targetName:C,stream:W.PULL_COMPLETE,streamId:u,reason:j(c)})});break;case W.ENQUEUE:if((0,n.assert)(_,"enqueue should have stream controller"),_.isClosed)break;_.controller.enqueue(x.chunk);break;case W.CLOSE:if((0,n.assert)(_,"close should have stream controller"),_.isClosed)break;_.isClosed=!0,_.controller.close(),X(this,D,Re).call(this,_,u);break;case W.ERROR:(0,n.assert)(_,"error should have stream controller"),_.controller.error(j(x.reason)),X(this,D,Re).call(this,_,u);break;case W.CANCEL_COMPLETE:x.success?_.cancelCall.resolve():_.cancelCall.reject(j(x.reason)),X(this,D,Re).call(this,_,u);break;case W.CANCEL:if(!a)break;new Promise(function(c){var L;c((L=a.onCancel)==null?void 0:L.call(a,j(x.reason)))}).then(function(){w.postMessage({sourceName:y,targetName:C,stream:W.CANCEL_COMPLETE,streamId:u,success:!0})},function(c){w.postMessage({sourceName:y,targetName:C,stream:W.CANCEL_COMPLETE,streamId:u,reason:j(c)})}),a.sinkCapability.reject(j(x.reason)),a.isCancelled=!0,delete this.streamSinks[u];break;default:throw new Error("Unexpected stream case")}},D=new WeakSet,Re=async function(x,u){var y,C,w;await Promise.allSettled([(y=x.startCall)==null?void 0:y.promise,(C=x.pullCall)==null?void 0:C.promise,(w=x.cancelCall)==null?void 0:w.promise]),delete this.streamControllers[u]},e.MessageHandler=it},(b,e,v)=>{var W,j;Object.defineProperty(e,"__esModule",{value:!0}),e.Metadata=void 0;var n=v(1);class d{constructor({parsedData:k,rawData:S}){U(this,W,void 0);U(this,j,void 0);rt(this,W,k),rt(this,j,S)}getRaw(){return t(this,j)}get(k){return t(this,W).get(k)??null}getAll(){return(0,n.objectFromMap)(t(this,W))}has(k){return t(this,W).has(k)}}W=new WeakMap,j=new WeakMap,e.Metadata=d},(b,e,v)=>{var k,S,f,I,D,E,tn;Object.defineProperty(e,"__esModule",{value:!0}),e.OptionalContentConfig=void 0;var n=v(1),d=v(8);const W=Symbol("INTERNAL");class j{constructor(u,y){U(this,k,!0);this.name=u,this.intent=y}get visible(){return t(this,k)}_setVisible(u,y){u!==W&&(0,n.unreachable)("Internal method `_setVisible` called."),rt(this,k,y)}}k=new WeakMap;class it{constructor(u){U(this,E);U(this,S,null);U(this,f,new Map);U(this,I,null);U(this,D,null);if(this.name=null,this.creator=null,u!==null){this.name=u.name,this.creator=u.creator,rt(this,D,u.order);for(const y of u.groups)t(this,f).set(y.id,new j(y.name,y.intent));if(u.baseState==="OFF")for(const y of t(this,f).values())y._setVisible(W,!1);for(const y of u.on)t(this,f).get(y)._setVisible(W,!0);for(const y of u.off)t(this,f).get(y)._setVisible(W,!1);rt(this,I,this.getHash())}}isVisible(u){if(t(this,f).size===0)return!0;if(!u)return(0,n.warn)("Optional content group not defined."),!0;if(u.type==="OCG")return t(this,f).has(u.id)?t(this,f).get(u.id).visible:((0,n.warn)(`Optional content group not found: ${u.id}`),!0);if(u.type==="OCMD"){if(u.expression)return X(this,E,tn).call(this,u.expression);if(!u.policy||u.policy==="AnyOn"){for(const y of u.ids){if(!t(this,f).has(y))return(0,n.warn)(`Optional content group not found: ${y}`),!0;if(t(this,f).get(y).visible)return!0}return!1}else if(u.policy==="AllOn"){for(const y of u.ids){if(!t(this,f).has(y))return(0,n.warn)(`Optional content group not found: ${y}`),!0;if(!t(this,f).get(y).visible)return!1}return!0}else if(u.policy==="AnyOff"){for(const y of u.ids){if(!t(this,f).has(y))return(0,n.warn)(`Optional content group not found: ${y}`),!0;if(!t(this,f).get(y).visible)return!0}return!1}else if(u.policy==="AllOff"){for(const y of u.ids){if(!t(this,f).has(y))return(0,n.warn)(`Optional content group not found: ${y}`),!0;if(t(this,f).get(y).visible)return!1}return!0}return(0,n.warn)(`Unknown optional content policy ${u.policy}.`),!0}return(0,n.warn)(`Unknown group type ${u.type}.`),!0}setVisibility(u,y=!0){if(!t(this,f).has(u)){(0,n.warn)(`Optional content group not found: ${u}`);return}t(this,f).get(u)._setVisible(W,!!y),rt(this,S,null)}get hasInitialVisibility(){return t(this,I)===null||this.getHash()===t(this,I)}getOrder(){return t(this,f).size?t(this,D)?t(this,D).slice():[...t(this,f).keys()]:null}getGroups(){return t(this,f).size>0?(0,n.objectFromMap)(t(this,f)):null}getGroup(u){return t(this,f).get(u)||null}getHash(){if(t(this,S)!==null)return t(this,S);const u=new d.MurmurHash3_64;for(const[y,C]of t(this,f))u.update(`${y}:${C.visible}`);return rt(this,S,u.hexdigest())}}S=new WeakMap,f=new WeakMap,I=new WeakMap,D=new WeakMap,E=new WeakSet,tn=function(u){const y=u.length;if(y<2)return!0;const C=u[0];for(let w=1;w<y;w++){const _=u[w];let a;if(Array.isArray(_))a=X(this,E,tn).call(this,_);else if(t(this,f).has(_))a=t(this,f).get(_).visible;else return(0,n.warn)(`Optional content group not found: ${_}`),!0;switch(C){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return C==="And"},e.OptionalContentConfig=it},(b,e,v)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFDataTransportStream=void 0;var n=v(1),d=v(6);class W{constructor({length:S,initialData:f,progressiveDone:I=!1,contentDispositionFilename:D=null,disableRange:E=!1,disableStream:g=!1},x){if((0,n.assert)(x,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=I,this._contentDispositionFilename=D,(f==null?void 0:f.length)>0){const u=f instanceof Uint8Array&&f.byteLength===f.buffer.byteLength?f.buffer:new Uint8Array(f).buffer;this._queuedChunks.push(u)}this._pdfDataRangeTransport=x,this._isStreamingSupported=!g,this._isRangeSupported=!E,this._contentLength=S,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((u,y)=>{this._onReceiveData({begin:u,chunk:y})}),this._pdfDataRangeTransport.addProgressListener((u,y)=>{this._onProgress({loaded:u,total:y})}),this._pdfDataRangeTransport.addProgressiveReadListener(u=>{this._onReceiveData({chunk:u})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:S,chunk:f}){const I=f instanceof Uint8Array&&f.byteLength===f.buffer.byteLength?f.buffer:new Uint8Array(f).buffer;if(S===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(I):this._queuedChunks.push(I);else{const D=this._rangeReaders.some(function(E){return E._begin!==S?!1:(E._enqueue(I),!0)});(0,n.assert)(D,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var S;return((S=this._fullRequestReader)==null?void 0:S._loaded)??0}_onProgress(S){var f,I,D,E;S.total===void 0?(I=(f=this._rangeReaders[0])==null?void 0:f.onProgress)==null||I.call(f,{loaded:S.loaded}):(E=(D=this._fullRequestReader)==null?void 0:D.onProgress)==null||E.call(D,{loaded:S.loaded,total:S.total})}_onProgressiveDone(){var S;(S=this._fullRequestReader)==null||S.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(S){const f=this._rangeReaders.indexOf(S);f>=0&&this._rangeReaders.splice(f,1)}getFullReader(){(0,n.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const S=this._queuedChunks;return this._queuedChunks=null,new j(this,S,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(S,f){if(f<=this._progressiveDataLength)return null;const I=new it(this,S,f);return this._pdfDataRangeTransport.requestDataRange(S,f),this._rangeReaders.push(I),I}cancelAllRequests(S){var f;(f=this._fullRequestReader)==null||f.cancel(S);for(const I of this._rangeReaders.slice(0))I.cancel(S);this._pdfDataRangeTransport.abort()}}e.PDFDataTransportStream=W;class j{constructor(S,f,I=!1,D=null){this._stream=S,this._done=I||!1,this._filename=(0,d.isPdfFile)(D)?D:null,this._queuedChunks=f||[],this._loaded=0;for(const E of this._queuedChunks)this._loaded+=E.byteLength;this._requests=[],this._headersReady=Promise.resolve(),S._fullRequestReader=this,this.onProgress=null}_enqueue(S){this._done||(this._requests.length>0?this._requests.shift().resolve({value:S,done:!1}):this._queuedChunks.push(S),this._loaded+=S.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const S=new n.PromiseCapability;return this._requests.push(S),S.promise}cancel(S){this._done=!0;for(const f of this._requests)f.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class it{constructor(S,f,I){this._stream=S,this._begin=f,this._end=I,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(S){if(!this._done){if(this._requests.length===0)this._queuedChunk=S;else{this._requests.shift().resolve({value:S,done:!1});for(const I of this._requests)I.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const f=this._queuedChunk;return this._queuedChunk=null,{value:f,done:!1}}if(this._done)return{value:void 0,done:!0};const S=new n.PromiseCapability;return this._requests.push(S),S.promise}cancel(S){this._done=!0;for(const f of this._requests)f.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(b,e,v)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFFetchStream=void 0;var n=v(1),d=v(20);function W(I,D,E){return{method:"GET",headers:I,signal:E.signal,mode:"cors",credentials:D?"include":"same-origin",redirect:"follow"}}function j(I){const D=new Headers;for(const E in I){const g=I[E];g!==void 0&&D.append(E,g)}return D}function it(I){return I instanceof Uint8Array?I.buffer:I instanceof ArrayBuffer?I:((0,n.warn)(`getArrayBuffer - unexpected data format: ${I}`),new Uint8Array(I).buffer)}class k{constructor(D){this.source=D,this.isHttp=/^https?:/i.test(D.url),this.httpHeaders=this.isHttp&&D.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var D;return((D=this._fullRequestReader)==null?void 0:D._loaded)??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new S(this),this._fullRequestReader}getRangeReader(D,E){if(E<=this._progressiveDataLength)return null;const g=new f(this,D,E);return this._rangeRequestReaders.push(g),g}cancelAllRequests(D){var E;(E=this._fullRequestReader)==null||E.cancel(D);for(const g of this._rangeRequestReaders.slice(0))g.cancel(D)}}e.PDFFetchStream=k;class S{constructor(D){this._stream=D,this._reader=null,this._loaded=0,this._filename=null;const E=D.source;this._withCredentials=E.withCredentials||!1,this._contentLength=E.length,this._headersCapability=new n.PromiseCapability,this._disableRange=E.disableRange||!1,this._rangeChunkSize=E.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!E.disableStream,this._isRangeSupported=!E.disableRange,this._headers=j(this._stream.httpHeaders);const g=E.url;fetch(g,W(this._headers,this._withCredentials,this._abortController)).then(x=>{if(!(0,d.validateResponseStatus)(x.status))throw(0,d.createResponseStatusError)(x.status,g);this._reader=x.body.getReader(),this._headersCapability.resolve();const u=w=>x.headers.get(w),{allowRangeRequests:y,suggestedLength:C}=(0,d.validateRangeRequestCapabilities)({getResponseHeader:u,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=y,this._contentLength=C||this._contentLength,this._filename=(0,d.extractFilenameFromHeader)(u),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new n.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var g;await this._headersCapability.promise;const{value:D,done:E}=await this._reader.read();return E?{value:D,done:E}:(this._loaded+=D.byteLength,(g=this.onProgress)==null||g.call(this,{loaded:this._loaded,total:this._contentLength}),{value:it(D),done:!1})}cancel(D){var E;(E=this._reader)==null||E.cancel(D),this._abortController.abort()}}class f{constructor(D,E,g){this._stream=D,this._reader=null,this._loaded=0;const x=D.source;this._withCredentials=x.withCredentials||!1,this._readCapability=new n.PromiseCapability,this._isStreamingSupported=!x.disableStream,this._abortController=new AbortController,this._headers=j(this._stream.httpHeaders),this._headers.append("Range",`bytes=${E}-${g-1}`);const u=x.url;fetch(u,W(this._headers,this._withCredentials,this._abortController)).then(y=>{if(!(0,d.validateResponseStatus)(y.status))throw(0,d.createResponseStatusError)(y.status,u);this._readCapability.resolve(),this._reader=y.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var g;await this._readCapability.promise;const{value:D,done:E}=await this._reader.read();return E?{value:D,done:E}:(this._loaded+=D.byteLength,(g=this.onProgress)==null||g.call(this,{loaded:this._loaded}),{value:it(D),done:!1})}cancel(D){var E;(E=this._reader)==null||E.cancel(D),this._abortController.abort()}}},(b,e,v)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createResponseStatusError=k,e.extractFilenameFromHeader=it,e.validateRangeRequestCapabilities=j,e.validateResponseStatus=S;var n=v(1),d=v(21),W=v(6);function j({getResponseHeader:f,isHttp:I,rangeChunkSize:D,disableRange:E}){const g={allowRangeRequests:!1,suggestedLength:void 0},x=parseInt(f("Content-Length"),10);return!Number.isInteger(x)||(g.suggestedLength=x,x<=2*D)||E||!I||f("Accept-Ranges")!=="bytes"||(f("Content-Encoding")||"identity")!=="identity"||(g.allowRangeRequests=!0),g}function it(f){const I=f("Content-Disposition");if(I){let D=(0,d.getFilenameFromContentDispositionHeader)(I);if(D.includes("%"))try{D=decodeURIComponent(D)}catch{}if((0,W.isPdfFile)(D))return D}return null}function k(f,I){return f===404||f===0&&I.startsWith("file:")?new n.MissingPDFException('Missing PDF "'+I+'".'):new n.UnexpectedResponseException(`Unexpected server response (${f}) while retrieving PDF "${I}".`,f)}function S(f){return f===200||f===206}},(b,e,v)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getFilenameFromContentDispositionHeader=d;var n=v(1);function d(W){let j=!0,it=k("filename\\*","i").exec(W);if(it){it=it[1];let x=D(it);return x=unescape(x),x=E(x),x=g(x),f(x)}if(it=I(W),it){const x=g(it);return f(x)}if(it=k("filename","i").exec(W),it){it=it[1];let x=D(it);return x=g(x),f(x)}function k(x,u){return new RegExp("(?:^|;)\\s*"+x+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',u)}function S(x,u){if(x){if(!/^[\x00-\xFF]+$/.test(u))return u;try{const y=new TextDecoder(x,{fatal:!0}),C=(0,n.stringToBytes)(u);u=y.decode(C),j=!1}catch{}}return u}function f(x){return j&&/[\x80-\xff]/.test(x)&&(x=S("utf-8",x),j&&(x=S("iso-8859-1",x))),x}function I(x){const u=[];let y;const C=k("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(y=C.exec(x))!==null;){let[,_,a,c]=y;if(_=parseInt(_,10),_ in u){if(_===0)break;continue}u[_]=[a,c]}const w=[];for(let _=0;_<u.length&&_ in u;++_){let[a,c]=u[_];c=D(c),a&&(c=unescape(c),_===0&&(c=E(c))),w.push(c)}return w.join("")}function D(x){if(x.startsWith('"')){const u=x.slice(1).split('\\"');for(let y=0;y<u.length;++y){const C=u[y].indexOf('"');C!==-1&&(u[y]=u[y].slice(0,C),u.length=y+1),u[y]=u[y].replaceAll(/\\(.)/g,"$1")}x=u.join('"')}return x}function E(x){const u=x.indexOf("'");if(u===-1)return x;const y=x.slice(0,u),w=x.slice(u+1).replace(/^[^']*'/,"");return S(y,w)}function g(x){return!x.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(x)?x:x.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(u,y,C,w){if(C==="q"||C==="Q")return w=w.replaceAll("_"," "),w=w.replaceAll(/=([0-9a-fA-F]{2})/g,function(_,a){return String.fromCharCode(parseInt(a,16))}),S(y,w);try{w=atob(w)}catch{}return S(y,w)})}return""}},(b,e,v)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNetworkStream=void 0;var n=v(1),d=v(20);const W=200,j=206;function it(D){const E=D.response;return typeof E!="string"?E:(0,n.stringToBytes)(E).buffer}class k{constructor(E,g={}){this.url=E,this.isHttp=/^https?:/i.test(E),this.httpHeaders=this.isHttp&&g.httpHeaders||Object.create(null),this.withCredentials=g.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(E,g,x){const u={begin:E,end:g};for(const y in x)u[y]=x[y];return this.request(u)}requestFull(E){return this.request(E)}request(E){const g=new XMLHttpRequest,x=this.currXhrId++,u=this.pendingRequests[x]={xhr:g};g.open("GET",this.url),g.withCredentials=this.withCredentials;for(const y in this.httpHeaders){const C=this.httpHeaders[y];C!==void 0&&g.setRequestHeader(y,C)}return this.isHttp&&"begin"in E&&"end"in E?(g.setRequestHeader("Range",`bytes=${E.begin}-${E.end-1}`),u.expectedStatus=j):u.expectedStatus=W,g.responseType="arraybuffer",E.onError&&(g.onerror=function(y){E.onError(g.status)}),g.onreadystatechange=this.onStateChange.bind(this,x),g.onprogress=this.onProgress.bind(this,x),u.onHeadersReceived=E.onHeadersReceived,u.onDone=E.onDone,u.onError=E.onError,u.onProgress=E.onProgress,g.send(null),x}onProgress(E,g){var u;const x=this.pendingRequests[E];x&&((u=x.onProgress)==null||u.call(x,g))}onStateChange(E,g){var _,a,c;const x=this.pendingRequests[E];if(!x)return;const u=x.xhr;if(u.readyState>=2&&x.onHeadersReceived&&(x.onHeadersReceived(),delete x.onHeadersReceived),u.readyState!==4||!(E in this.pendingRequests))return;if(delete this.pendingRequests[E],u.status===0&&this.isHttp){(_=x.onError)==null||_.call(x,u.status);return}const y=u.status||W;if(!(y===W&&x.expectedStatus===j)&&y!==x.expectedStatus){(a=x.onError)==null||a.call(x,u.status);return}const w=it(u);if(y===j){const L=u.getResponseHeader("Content-Range"),A=/bytes (\d+)-(\d+)\/(\d+)/.exec(L);x.onDone({begin:parseInt(A[1],10),chunk:w})}else w?x.onDone({begin:0,chunk:w}):(c=x.onError)==null||c.call(x,u.status)}getRequestXhr(E){return this.pendingRequests[E].xhr}isPendingRequest(E){return E in this.pendingRequests}abortRequest(E){const g=this.pendingRequests[E].xhr;delete this.pendingRequests[E],g.abort()}}class S{constructor(E){this._source=E,this._manager=new k(E.url,{httpHeaders:E.httpHeaders,withCredentials:E.withCredentials}),this._rangeChunkSize=E.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(E){const g=this._rangeRequestReaders.indexOf(E);g>=0&&this._rangeRequestReaders.splice(g,1)}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new f(this._manager,this._source),this._fullRequestReader}getRangeReader(E,g){const x=new I(this._manager,E,g);return x.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(x),x}cancelAllRequests(E){var g;(g=this._fullRequestReader)==null||g.cancel(E);for(const x of this._rangeRequestReaders.slice(0))x.cancel(E)}}e.PDFNetworkStream=S;class f{constructor(E,g){this._manager=E;const x={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=g.url,this._fullRequestId=E.requestFull(x),this._headersReceivedCapability=new n.PromiseCapability,this._disableRange=g.disableRange||!1,this._contentLength=g.length,this._rangeChunkSize=g.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const E=this._fullRequestId,g=this._manager.getRequestXhr(E),x=C=>g.getResponseHeader(C),{allowRangeRequests:u,suggestedLength:y}=(0,d.validateRangeRequestCapabilities)({getResponseHeader:x,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});u&&(this._isRangeSupported=!0),this._contentLength=y||this._contentLength,this._filename=(0,d.extractFilenameFromHeader)(x),this._isRangeSupported&&this._manager.abortRequest(E),this._headersReceivedCapability.resolve()}_onDone(E){if(E&&(this._requests.length>0?this._requests.shift().resolve({value:E.chunk,done:!1}):this._cachedChunks.push(E.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(E){this._storedError=(0,d.createResponseStatusError)(E,this._url),this._headersReceivedCapability.reject(this._storedError);for(const g of this._requests)g.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(E){var g;(g=this.onProgress)==null||g.call(this,{loaded:E.loaded,total:E.lengthComputable?E.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const E=new n.PromiseCapability;return this._requests.push(E),E.promise}cancel(E){this._done=!0,this._headersReceivedCapability.reject(E);for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class I{constructor(E,g,x){this._manager=E;const u={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=E.url,this._requestId=E.requestRange(g,x,u),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var E;(E=this.onClosed)==null||E.call(this,this)}_onDone(E){const g=E.chunk;this._requests.length>0?this._requests.shift().resolve({value:g,done:!1}):this._queuedChunk=g,this._done=!0;for(const x of this._requests)x.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(E){this._storedError=(0,d.createResponseStatusError)(E,this._url);for(const g of this._requests)g.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(E){var g;this.isStreamingSupported||(g=this.onProgress)==null||g.call(this,{loaded:E.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const g=this._queuedChunk;return this._queuedChunk=null,{value:g,done:!1}}if(this._done)return{value:void 0,done:!0};const E=new n.PromiseCapability;return this._requests.push(E),E.promise}cancel(E){this._done=!0;for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(b,e,v)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNodeStream=void 0;var n=v(1),d=v(20);const W=/^file:\/\/\/[a-zA-Z]:\//;function j(x){const u=require$$5,y=u.parse(x);return y.protocol==="file:"||y.host?y:/^[a-z]:[/\\]/i.test(x)?u.parse(`file:///${x}`):(y.host||(y.protocol="file:"),y)}class it{constructor(u){this.source=u,this.url=j(u.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&u.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var u;return((u=this._fullRequestReader)==null?void 0:u._loaded)??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new E(this):new I(this),this._fullRequestReader}getRangeReader(u,y){if(y<=this._progressiveDataLength)return null;const C=this.isFsUrl?new g(this,u,y):new D(this,u,y);return this._rangeRequestReaders.push(C),C}cancelAllRequests(u){var y;(y=this._fullRequestReader)==null||y.cancel(u);for(const C of this._rangeRequestReaders.slice(0))C.cancel(u)}}e.PDFNodeStream=it;class k{constructor(u){this._url=u.url,this._done=!1,this._storedError=null,this.onProgress=null;const y=u.source;this._contentLength=y.length,this._loaded=0,this._filename=null,this._disableRange=y.disableRange||!1,this._rangeChunkSize=y.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!y.disableStream,this._isRangeSupported=!y.disableRange,this._readableStream=null,this._readCapability=new n.PromiseCapability,this._headersCapability=new n.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var C;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const u=this._readableStream.read();return u===null?(this._readCapability=new n.PromiseCapability,this.read()):(this._loaded+=u.length,(C=this.onProgress)==null||C.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(u).buffer,done:!1})}cancel(u){if(!this._readableStream){this._error(u);return}this._readableStream.destroy(u)}_error(u){this._storedError=u,this._readCapability.resolve()}_setReadableStream(u){this._readableStream=u,u.on("readable",()=>{this._readCapability.resolve()}),u.on("end",()=>{u.destroy(),this._done=!0,this._readCapability.resolve()}),u.on("error",y=>{this._error(y)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new n.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class S{constructor(u){this._url=u.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new n.PromiseCapability;const y=u.source;this._isStreamingSupported=!y.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var C;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const u=this._readableStream.read();return u===null?(this._readCapability=new n.PromiseCapability,this.read()):(this._loaded+=u.length,(C=this.onProgress)==null||C.call(this,{loaded:this._loaded}),{value:new Uint8Array(u).buffer,done:!1})}cancel(u){if(!this._readableStream){this._error(u);return}this._readableStream.destroy(u)}_error(u){this._storedError=u,this._readCapability.resolve()}_setReadableStream(u){this._readableStream=u,u.on("readable",()=>{this._readCapability.resolve()}),u.on("end",()=>{u.destroy(),this._done=!0,this._readCapability.resolve()}),u.on("error",y=>{this._error(y)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function f(x,u){return{protocol:x.protocol,auth:x.auth,host:x.hostname,port:x.port,path:x.path,method:"GET",headers:u}}class I extends k{constructor(u){super(u);const y=C=>{if(C.statusCode===404){const c=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=c,this._headersCapability.reject(c);return}this._headersCapability.resolve(),this._setReadableStream(C);const w=c=>this._readableStream.headers[c.toLowerCase()],{allowRangeRequests:_,suggestedLength:a}=(0,d.validateRangeRequestCapabilities)({getResponseHeader:w,isHttp:u.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=_,this._contentLength=a||this._contentLength,this._filename=(0,d.extractFilenameFromHeader)(w)};if(this._request=null,this._url.protocol==="http:"){const C=require$$5;this._request=C.request(f(this._url,u.httpHeaders),y)}else{const C=require$$5;this._request=C.request(f(this._url,u.httpHeaders),y)}this._request.on("error",C=>{this._storedError=C,this._headersCapability.reject(C)}),this._request.end()}}class D extends S{constructor(u,y,C){super(u),this._httpHeaders={};for(const _ in u.httpHeaders){const a=u.httpHeaders[_];a!==void 0&&(this._httpHeaders[_]=a)}this._httpHeaders.Range=`bytes=${y}-${C-1}`;const w=_=>{if(_.statusCode===404){const a=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=a;return}this._setReadableStream(_)};if(this._request=null,this._url.protocol==="http:"){const _=require$$5;this._request=_.request(f(this._url,this._httpHeaders),w)}else{const _=require$$5;this._request=_.request(f(this._url,this._httpHeaders),w)}this._request.on("error",_=>{this._storedError=_}),this._request.end()}}class E extends k{constructor(u){super(u);let y=decodeURIComponent(this._url.path);W.test(this._url.href)&&(y=y.replace(/^\//,""));const C=require$$5;C.lstat(y,(w,_)=>{if(w){w.code==="ENOENT"&&(w=new n.MissingPDFException(`Missing PDF "${y}".`)),this._storedError=w,this._headersCapability.reject(w);return}this._contentLength=_.size,this._setReadableStream(C.createReadStream(y)),this._headersCapability.resolve()})}}class g extends S{constructor(u,y,C){super(u);let w=decodeURIComponent(this._url.path);W.test(this._url.href)&&(w=w.replace(/^\//,""));const _=require$$5;this._setReadableStream(_.createReadStream(w,{start:y,end:C-1}))}}},(b,e,v)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SVGGraphics=void 0;var n=v(6),d=v(1);const W={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},j="http://www.w3.org/XML/1998/namespace",it="http://www.w3.org/1999/xlink",k=["butt","round","square"],S=["miter","round","bevel"],f=function(_,a="",c=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!c)return URL.createObjectURL(new Blob([_],{type:a}));const L="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let A=`data:${a};base64,`;for(let l=0,F=_.length;l<F;l+=3){const m=_[l]&255,$=_[l+1]&255,z=_[l+2]&255,R=m>>2,V=(m&3)<<4|$>>4,st=l+1<F?($&15)<<2|z>>6:64,at=l+2<F?z&63:64;A+=L[R]+L[V]+L[st]+L[at]}return A},I=function(){const _=new Uint8Array([137,80,78,71,13,10,26,10]),a=12,c=new Int32Array(256);for(let z=0;z<256;z++){let R=z;for(let V=0;V<8;V++)R=R&1?3988292384^R>>1&2147483647:R>>1&2147483647;c[z]=R}function L(z,R,V){let st=-1;for(let at=R;at<V;at++){const G=(st^z[at])&255,ct=c[G];st=st>>>8^ct}return st^-1}function A(z,R,V,st){let at=st;const G=R.length;V[at]=G>>24&255,V[at+1]=G>>16&255,V[at+2]=G>>8&255,V[at+3]=G&255,at+=4,V[at]=z.charCodeAt(0)&255,V[at+1]=z.charCodeAt(1)&255,V[at+2]=z.charCodeAt(2)&255,V[at+3]=z.charCodeAt(3)&255,at+=4,V.set(R,at),at+=R.length;const ct=L(V,st+4,at);V[at]=ct>>24&255,V[at+1]=ct>>16&255,V[at+2]=ct>>8&255,V[at+3]=ct&255}function l(z,R,V){let st=1,at=0;for(let G=R;G<V;++G)st=(st+(z[G]&255))%65521,at=(at+st)%65521;return at<<16|st}function F(z){if(!d.isNodeJS)return m(z);try{const R=parseInt(process.versions.node)>=8?z:Buffer.from(z),V=require$$5.deflateSync(R,{level:9});return V instanceof Uint8Array?V:new Uint8Array(V)}catch(R){(0,d.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+R)}return m(z)}function m(z){let R=z.length;const V=65535,st=Math.ceil(R/V),at=new Uint8Array(2+R+st*5+4);let G=0;at[G++]=120,at[G++]=156;let ct=0;for(;R>V;)at[G++]=0,at[G++]=255,at[G++]=255,at[G++]=0,at[G++]=0,at.set(z.subarray(ct,ct+V),G),G+=V,ct+=V,R-=V;at[G++]=1,at[G++]=R&255,at[G++]=R>>8&255,at[G++]=~R&65535&255,at[G++]=(~R&65535)>>8&255,at.set(z.subarray(ct),G),G+=z.length-ct;const gt=l(z,0,z.length);return at[G++]=gt>>24&255,at[G++]=gt>>16&255,at[G++]=gt>>8&255,at[G++]=gt&255,at}function $(z,R,V,st){const at=z.width,G=z.height;let ct,gt,xt;const Et=z.data;switch(R){case d.ImageKind.GRAYSCALE_1BPP:gt=0,ct=1,xt=at+7>>3;break;case d.ImageKind.RGB_24BPP:gt=2,ct=8,xt=at*3;break;case d.ImageKind.RGBA_32BPP:gt=6,ct=8,xt=at*4;break;default:throw new Error("invalid format")}const M=new Uint8Array((1+xt)*G);let i=0,o=0;for(let H=0;H<G;++H)M[i++]=0,M.set(Et.subarray(o,o+xt),i),o+=xt,i+=xt;if(R===d.ImageKind.GRAYSCALE_1BPP&&st){i=0;for(let H=0;H<G;H++){i++;for(let nt=0;nt<xt;nt++)M[i++]^=255}}const r=new Uint8Array([at>>24&255,at>>16&255,at>>8&255,at&255,G>>24&255,G>>16&255,G>>8&255,G&255,ct,gt,0,0,0]),h=F(M),p=_.length+a*3+r.length+h.length,P=new Uint8Array(p);let O=0;return P.set(_,O),O+=_.length,A("IHDR",r,P,O),O+=a+r.length,A("IDATA",h,P,O),O+=a+h.length,A("IEND",new Uint8Array(0),P,O),f(P,"image/png",V)}return function(R,V,st){const at=R.kind===void 0?d.ImageKind.GRAYSCALE_1BPP:R.kind;return $(R,at,V,st)}}();class D{constructor(){this.fontSizeScale=1,this.fontWeight=W.fontWeight,this.fontSize=0,this.textMatrix=d.IDENTITY_MATRIX,this.fontMatrix=d.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=d.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=W.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(a,c){this.x=a,this.y=c}}function E(_){let a=[];const c=[];for(const L of _){if(L.fn==="save"){a.push({fnId:92,fn:"group",items:[]}),c.push(a),a=a.at(-1).items;continue}L.fn==="restore"?a=c.pop():a.push(L)}return a}function g(_){if(Number.isInteger(_))return _.toString();const a=_.toFixed(10);let c=a.length-1;if(a[c]!=="0")return a;do c--;while(a[c]==="0");return a.substring(0,a[c]==="."?c:c+1)}function x(_){if(_[4]===0&&_[5]===0){if(_[1]===0&&_[2]===0)return _[0]===1&&_[3]===1?"":`scale(${g(_[0])} ${g(_[3])})`;if(_[0]===_[3]&&_[1]===-_[2]){const a=Math.acos(_[0])*180/Math.PI;return`rotate(${g(a)})`}}else if(_[0]===1&&_[1]===0&&_[2]===0&&_[3]===1)return`translate(${g(_[4])} ${g(_[5])})`;return`matrix(${g(_[0])} ${g(_[1])} ${g(_[2])} ${g(_[3])} ${g(_[4])} ${g(_[5])})`}let u=0,y=0,C=0;class w{constructor(a,c,L=!1){(0,n.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new n.DOMSVGFactory,this.current=new D,this.transformMatrix=d.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=a,this.objs=c,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!L,this._operatorIdMapping=[];for(const A in d.OPS)this._operatorIdMapping[d.OPS[A]]=A}getObject(a,c=null){return typeof a=="string"?a.startsWith("g_")?this.commonObjs.get(a):this.objs.get(a):c}save(){this.transformStack.push(this.transformMatrix);const a=this.current;this.extraStack.push(a),this.current=a.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(a){this.save(),this.executeOpTree(a),this.restore()}loadDependencies(a){const c=a.fnArray,L=a.argsArray;for(let A=0,l=c.length;A<l;A++)if(c[A]===d.OPS.dependency)for(const F of L[A]){const m=F.startsWith("g_")?this.commonObjs:this.objs,$=new Promise(z=>{m.get(F,z)});this.current.dependencies.push($)}return Promise.all(this.current.dependencies)}transform(a,c,L,A,l,F){const m=[a,c,L,A,l,F];this.transformMatrix=d.Util.transform(this.transformMatrix,m),this.tgrp=null}getSVG(a,c){this.viewport=c;const L=this._initialize(c);return this.loadDependencies(a).then(()=>(this.transformMatrix=d.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(a)),L))}convertOpList(a){const c=this._operatorIdMapping,L=a.argsArray,A=a.fnArray,l=[];for(let F=0,m=A.length;F<m;F++){const $=A[F];l.push({fnId:$,fn:c[$],args:L[F]})}return E(l)}executeOpTree(a){for(const c of a){const L=c.fn,A=c.fnId,l=c.args;switch(A|0){case d.OPS.beginText:this.beginText();break;case d.OPS.dependency:break;case d.OPS.setLeading:this.setLeading(l);break;case d.OPS.setLeadingMoveText:this.setLeadingMoveText(l[0],l[1]);break;case d.OPS.setFont:this.setFont(l);break;case d.OPS.showText:this.showText(l[0]);break;case d.OPS.showSpacedText:this.showText(l[0]);break;case d.OPS.endText:this.endText();break;case d.OPS.moveText:this.moveText(l[0],l[1]);break;case d.OPS.setCharSpacing:this.setCharSpacing(l[0]);break;case d.OPS.setWordSpacing:this.setWordSpacing(l[0]);break;case d.OPS.setHScale:this.setHScale(l[0]);break;case d.OPS.setTextMatrix:this.setTextMatrix(l[0],l[1],l[2],l[3],l[4],l[5]);break;case d.OPS.setTextRise:this.setTextRise(l[0]);break;case d.OPS.setTextRenderingMode:this.setTextRenderingMode(l[0]);break;case d.OPS.setLineWidth:this.setLineWidth(l[0]);break;case d.OPS.setLineJoin:this.setLineJoin(l[0]);break;case d.OPS.setLineCap:this.setLineCap(l[0]);break;case d.OPS.setMiterLimit:this.setMiterLimit(l[0]);break;case d.OPS.setFillRGBColor:this.setFillRGBColor(l[0],l[1],l[2]);break;case d.OPS.setStrokeRGBColor:this.setStrokeRGBColor(l[0],l[1],l[2]);break;case d.OPS.setStrokeColorN:this.setStrokeColorN(l);break;case d.OPS.setFillColorN:this.setFillColorN(l);break;case d.OPS.shadingFill:this.shadingFill(l[0]);break;case d.OPS.setDash:this.setDash(l[0],l[1]);break;case d.OPS.setRenderingIntent:this.setRenderingIntent(l[0]);break;case d.OPS.setFlatness:this.setFlatness(l[0]);break;case d.OPS.setGState:this.setGState(l[0]);break;case d.OPS.fill:this.fill();break;case d.OPS.eoFill:this.eoFill();break;case d.OPS.stroke:this.stroke();break;case d.OPS.fillStroke:this.fillStroke();break;case d.OPS.eoFillStroke:this.eoFillStroke();break;case d.OPS.clip:this.clip("nonzero");break;case d.OPS.eoClip:this.clip("evenodd");break;case d.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case d.OPS.paintImageXObject:this.paintImageXObject(l[0]);break;case d.OPS.paintInlineImageXObject:this.paintInlineImageXObject(l[0]);break;case d.OPS.paintImageMaskXObject:this.paintImageMaskXObject(l[0]);break;case d.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(l[0],l[1]);break;case d.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case d.OPS.closePath:this.closePath();break;case d.OPS.closeStroke:this.closeStroke();break;case d.OPS.closeFillStroke:this.closeFillStroke();break;case d.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case d.OPS.nextLine:this.nextLine();break;case d.OPS.transform:this.transform(l[0],l[1],l[2],l[3],l[4],l[5]);break;case d.OPS.constructPath:this.constructPath(l[0],l[1]);break;case d.OPS.endPath:this.endPath();break;case 92:this.group(c.items);break;default:(0,d.warn)(`Unimplemented operator ${L}`);break}}}setWordSpacing(a){this.current.wordSpacing=a}setCharSpacing(a){this.current.charSpacing=a}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(a,c,L,A,l,F){const m=this.current;m.textMatrix=m.lineMatrix=[a,c,L,A,l,F],m.textMatrixScale=Math.hypot(a,c),m.x=m.lineX=0,m.y=m.lineY=0,m.xcoords=[],m.ycoords=[],m.tspan=this.svgFactory.createElement("svg:tspan"),m.tspan.setAttributeNS(null,"font-family",m.fontFamily),m.tspan.setAttributeNS(null,"font-size",`${g(m.fontSize)}px`),m.tspan.setAttributeNS(null,"y",g(-m.y)),m.txtElement=this.svgFactory.createElement("svg:text"),m.txtElement.append(m.tspan)}beginText(){const a=this.current;a.x=a.lineX=0,a.y=a.lineY=0,a.textMatrix=d.IDENTITY_MATRIX,a.lineMatrix=d.IDENTITY_MATRIX,a.textMatrixScale=1,a.tspan=this.svgFactory.createElement("svg:tspan"),a.txtElement=this.svgFactory.createElement("svg:text"),a.txtgrp=this.svgFactory.createElement("svg:g"),a.xcoords=[],a.ycoords=[]}moveText(a,c){const L=this.current;L.x=L.lineX+=a,L.y=L.lineY+=c,L.xcoords=[],L.ycoords=[],L.tspan=this.svgFactory.createElement("svg:tspan"),L.tspan.setAttributeNS(null,"font-family",L.fontFamily),L.tspan.setAttributeNS(null,"font-size",`${g(L.fontSize)}px`),L.tspan.setAttributeNS(null,"y",g(-L.y))}showText(a){const c=this.current,L=c.font,A=c.fontSize;if(A===0)return;const l=c.fontSizeScale,F=c.charSpacing,m=c.wordSpacing,$=c.fontDirection,z=c.textHScale*$,R=L.vertical,V=R?1:-1,st=L.defaultVMetrics,at=A*c.fontMatrix[0];let G=0;for(const xt of a){if(xt===null){G+=$*m;continue}else if(typeof xt=="number"){G+=V*xt*A/1e3;continue}const Et=(xt.isSpace?m:0)+F,M=xt.fontChar;let i,o,r=xt.width;if(R){let p;const P=xt.vmetric||st;p=xt.vmetric?P[1]:r*.5,p=-p*at;const O=P[2]*at;r=P?-P[0]:r,i=p/l,o=(G+O)/l}else i=G/l,o=0;(xt.isInFont||L.missingFile)&&(c.xcoords.push(c.x+i),R&&c.ycoords.push(-c.y+o),c.tspan.textContent+=M);const h=R?r*at-Et*$:r*at+Et*$;G+=h}c.tspan.setAttributeNS(null,"x",c.xcoords.map(g).join(" ")),R?c.tspan.setAttributeNS(null,"y",c.ycoords.map(g).join(" ")):c.tspan.setAttributeNS(null,"y",g(-c.y)),R?c.y-=G:c.x+=G*z,c.tspan.setAttributeNS(null,"font-family",c.fontFamily),c.tspan.setAttributeNS(null,"font-size",`${g(c.fontSize)}px`),c.fontStyle!==W.fontStyle&&c.tspan.setAttributeNS(null,"font-style",c.fontStyle),c.fontWeight!==W.fontWeight&&c.tspan.setAttributeNS(null,"font-weight",c.fontWeight);const ct=c.textRenderingMode&d.TextRenderingMode.FILL_STROKE_MASK;if(ct===d.TextRenderingMode.FILL||ct===d.TextRenderingMode.FILL_STROKE?(c.fillColor!==W.fillColor&&c.tspan.setAttributeNS(null,"fill",c.fillColor),c.fillAlpha<1&&c.tspan.setAttributeNS(null,"fill-opacity",c.fillAlpha)):c.textRenderingMode===d.TextRenderingMode.ADD_TO_PATH?c.tspan.setAttributeNS(null,"fill","transparent"):c.tspan.setAttributeNS(null,"fill","none"),ct===d.TextRenderingMode.STROKE||ct===d.TextRenderingMode.FILL_STROKE){const xt=1/(c.textMatrixScale||1);this._setStrokeAttributes(c.tspan,xt)}let gt=c.textMatrix;c.textRise!==0&&(gt=gt.slice(),gt[5]+=c.textRise),c.txtElement.setAttributeNS(null,"transform",`${x(gt)} scale(${g(z)}, -1)`),c.txtElement.setAttributeNS(j,"xml:space","preserve"),c.txtElement.append(c.tspan),c.txtgrp.append(c.txtElement),this._ensureTransformGroup().append(c.txtElement)}setLeadingMoveText(a,c){this.setLeading(-c),this.moveText(a,c)}addFontStyle(a){if(!a.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const c=f(a.data,a.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${a.loadedName}"; src: url(${c}); }
`}setFont(a){const c=this.current,L=this.commonObjs.get(a[0]);let A=a[1];c.font=L,this.embedFonts&&!L.missingFile&&!this.embeddedFonts[L.loadedName]&&(this.addFontStyle(L),this.embeddedFonts[L.loadedName]=L),c.fontMatrix=L.fontMatrix||d.FONT_IDENTITY_MATRIX;let l="normal";L.black?l="900":L.bold&&(l="bold");const F=L.italic?"italic":"normal";A<0?(A=-A,c.fontDirection=-1):c.fontDirection=1,c.fontSize=A,c.fontFamily=L.loadedName,c.fontWeight=l,c.fontStyle=F,c.tspan=this.svgFactory.createElement("svg:tspan"),c.tspan.setAttributeNS(null,"y",g(-c.y)),c.xcoords=[],c.ycoords=[]}endText(){var c;const a=this.current;a.textRenderingMode&d.TextRenderingMode.ADD_TO_PATH_FLAG&&((c=a.txtElement)!=null&&c.hasChildNodes())&&(a.element=a.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(a){a>0&&(this.current.lineWidth=a)}setLineCap(a){this.current.lineCap=k[a]}setLineJoin(a){this.current.lineJoin=S[a]}setMiterLimit(a){this.current.miterLimit=a}setStrokeAlpha(a){this.current.strokeAlpha=a}setStrokeRGBColor(a,c,L){this.current.strokeColor=d.Util.makeHexColor(a,c,L)}setFillAlpha(a){this.current.fillAlpha=a}setFillRGBColor(a,c,L){this.current.fillColor=d.Util.makeHexColor(a,c,L),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(a){this.current.strokeColor=this._makeColorN_Pattern(a)}setFillColorN(a){this.current.fillColor=this._makeColorN_Pattern(a)}shadingFill(a){const{width:c,height:L}=this.viewport,A=d.Util.inverseTransform(this.transformMatrix),[l,F,m,$]=d.Util.getAxialAlignedBoundingBox([0,0,c,L],A),z=this.svgFactory.createElement("svg:rect");z.setAttributeNS(null,"x",l),z.setAttributeNS(null,"y",F),z.setAttributeNS(null,"width",m-l),z.setAttributeNS(null,"height",$-F),z.setAttributeNS(null,"fill",this._makeShadingPattern(a)),this.current.fillAlpha<1&&z.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(z)}_makeColorN_Pattern(a){return a[0]==="TilingPattern"?this._makeTilingPattern(a):this._makeShadingPattern(a)}_makeTilingPattern(a){const c=a[1],L=a[2],A=a[3]||d.IDENTITY_MATRIX,[l,F,m,$]=a[4],z=a[5],R=a[6],V=a[7],st=`shading${C++}`,[at,G,ct,gt]=d.Util.normalizeRect([...d.Util.applyTransform([l,F],A),...d.Util.applyTransform([m,$],A)]),[xt,Et]=d.Util.singularValueDecompose2dScale(A),M=z*xt,i=R*Et,o=this.svgFactory.createElement("svg:pattern");o.setAttributeNS(null,"id",st),o.setAttributeNS(null,"patternUnits","userSpaceOnUse"),o.setAttributeNS(null,"width",M),o.setAttributeNS(null,"height",i),o.setAttributeNS(null,"x",`${at}`),o.setAttributeNS(null,"y",`${G}`);const r=this.svg,h=this.transformMatrix,p=this.current.fillColor,P=this.current.strokeColor,O=this.svgFactory.create(ct-at,gt-G);if(this.svg=O,this.transformMatrix=A,V===2){const H=d.Util.makeHexColor(...c);this.current.fillColor=H,this.current.strokeColor=H}return this.executeOpTree(this.convertOpList(L)),this.svg=r,this.transformMatrix=h,this.current.fillColor=p,this.current.strokeColor=P,o.append(O.childNodes[0]),this.defs.append(o),`url(#${st})`}_makeShadingPattern(a){switch(typeof a=="string"&&(a=this.objs.get(a)),a[0]){case"RadialAxial":const c=`shading${C++}`,L=a[3];let A;switch(a[1]){case"axial":const l=a[4],F=a[5];A=this.svgFactory.createElement("svg:linearGradient"),A.setAttributeNS(null,"id",c),A.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),A.setAttributeNS(null,"x1",l[0]),A.setAttributeNS(null,"y1",l[1]),A.setAttributeNS(null,"x2",F[0]),A.setAttributeNS(null,"y2",F[1]);break;case"radial":const m=a[4],$=a[5],z=a[6],R=a[7];A=this.svgFactory.createElement("svg:radialGradient"),A.setAttributeNS(null,"id",c),A.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),A.setAttributeNS(null,"cx",$[0]),A.setAttributeNS(null,"cy",$[1]),A.setAttributeNS(null,"r",R),A.setAttributeNS(null,"fx",m[0]),A.setAttributeNS(null,"fy",m[1]),A.setAttributeNS(null,"fr",z);break;default:throw new Error(`Unknown RadialAxial type: ${a[1]}`)}for(const l of L){const F=this.svgFactory.createElement("svg:stop");F.setAttributeNS(null,"offset",l[0]),F.setAttributeNS(null,"stop-color",l[1]),A.append(F)}return this.defs.append(A),`url(#${c})`;case"Mesh":return(0,d.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${a[0]}`)}}setDash(a,c){this.current.dashArray=a,this.current.dashPhase=c}constructPath(a,c){const L=this.current;let A=L.x,l=L.y,F=[],m=0;for(const $ of a)switch($|0){case d.OPS.rectangle:A=c[m++],l=c[m++];const z=c[m++],R=c[m++],V=A+z,st=l+R;F.push("M",g(A),g(l),"L",g(V),g(l),"L",g(V),g(st),"L",g(A),g(st),"Z");break;case d.OPS.moveTo:A=c[m++],l=c[m++],F.push("M",g(A),g(l));break;case d.OPS.lineTo:A=c[m++],l=c[m++],F.push("L",g(A),g(l));break;case d.OPS.curveTo:A=c[m+4],l=c[m+5],F.push("C",g(c[m]),g(c[m+1]),g(c[m+2]),g(c[m+3]),g(A),g(l)),m+=6;break;case d.OPS.curveTo2:F.push("C",g(A),g(l),g(c[m]),g(c[m+1]),g(c[m+2]),g(c[m+3])),A=c[m+2],l=c[m+3],m+=4;break;case d.OPS.curveTo3:A=c[m+2],l=c[m+3],F.push("C",g(c[m]),g(c[m+1]),g(A),g(l),g(A),g(l)),m+=4;break;case d.OPS.closePath:F.push("Z");break}F=F.join(" "),L.path&&a.length>0&&a[0]!==d.OPS.rectangle&&a[0]!==d.OPS.moveTo?F=L.path.getAttributeNS(null,"d")+F:(L.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(L.path)),L.path.setAttributeNS(null,"d",F),L.path.setAttributeNS(null,"fill","none"),L.element=L.path,L.setCurrentPoint(A,l)}endPath(){const a=this.current;if(a.path=null,!this.pendingClip)return;if(!a.element){this.pendingClip=null;return}const c=`clippath${u++}`,L=this.svgFactory.createElement("svg:clipPath");L.setAttributeNS(null,"id",c),L.setAttributeNS(null,"transform",x(this.transformMatrix));const A=a.element.cloneNode(!0);if(this.pendingClip==="evenodd"?A.setAttributeNS(null,"clip-rule","evenodd"):A.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,L.append(A),this.defs.append(L),a.activeClipUrl){a.clipGroup=null;for(const l of this.extraStack)l.clipGroup=null;L.setAttributeNS(null,"clip-path",a.activeClipUrl)}a.activeClipUrl=`url(#${c})`,this.tgrp=null}clip(a){this.pendingClip=a}closePath(){const a=this.current;if(a.path){const c=`${a.path.getAttributeNS(null,"d")}Z`;a.path.setAttributeNS(null,"d",c)}}setLeading(a){this.current.leading=-a}setTextRise(a){this.current.textRise=a}setTextRenderingMode(a){this.current.textRenderingMode=a}setHScale(a){this.current.textHScale=a/100}setRenderingIntent(a){}setFlatness(a){}setGState(a){for(const[c,L]of a)switch(c){case"LW":this.setLineWidth(L);break;case"LC":this.setLineCap(L);break;case"LJ":this.setLineJoin(L);break;case"ML":this.setMiterLimit(L);break;case"D":this.setDash(L[0],L[1]);break;case"RI":this.setRenderingIntent(L);break;case"FL":this.setFlatness(L);break;case"Font":this.setFont(L);break;case"CA":this.setStrokeAlpha(L);break;case"ca":this.setFillAlpha(L);break;default:(0,d.warn)(`Unimplemented graphic state operator ${c}`);break}}fill(){const a=this.current;a.element&&(a.element.setAttributeNS(null,"fill",a.fillColor),a.element.setAttributeNS(null,"fill-opacity",a.fillAlpha),this.endPath())}stroke(){const a=this.current;a.element&&(this._setStrokeAttributes(a.element),a.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(a,c=1){const L=this.current;let A=L.dashArray;c!==1&&A.length>0&&(A=A.map(function(l){return c*l})),a.setAttributeNS(null,"stroke",L.strokeColor),a.setAttributeNS(null,"stroke-opacity",L.strokeAlpha),a.setAttributeNS(null,"stroke-miterlimit",g(L.miterLimit)),a.setAttributeNS(null,"stroke-linecap",L.lineCap),a.setAttributeNS(null,"stroke-linejoin",L.lineJoin),a.setAttributeNS(null,"stroke-width",g(c*L.lineWidth)+"px"),a.setAttributeNS(null,"stroke-dasharray",A.map(g).join(" ")),a.setAttributeNS(null,"stroke-dashoffset",g(c*L.dashPhase)+"px")}eoFill(){var a;(a=this.current.element)==null||a.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var a;(a=this.current.element)==null||a.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const a=this.svgFactory.createElement("svg:rect");a.setAttributeNS(null,"x","0"),a.setAttributeNS(null,"y","0"),a.setAttributeNS(null,"width","1px"),a.setAttributeNS(null,"height","1px"),a.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(a)}paintImageXObject(a){const c=this.getObject(a);if(!c){(0,d.warn)(`Dependent image with object ID ${a} is not ready yet`);return}this.paintInlineImageXObject(c)}paintInlineImageXObject(a,c){const L=a.width,A=a.height,l=I(a,this.forceDataSchema,!!c),F=this.svgFactory.createElement("svg:rect");F.setAttributeNS(null,"x","0"),F.setAttributeNS(null,"y","0"),F.setAttributeNS(null,"width",g(L)),F.setAttributeNS(null,"height",g(A)),this.current.element=F,this.clip("nonzero");const m=this.svgFactory.createElement("svg:image");m.setAttributeNS(it,"xlink:href",l),m.setAttributeNS(null,"x","0"),m.setAttributeNS(null,"y",g(-A)),m.setAttributeNS(null,"width",g(L)+"px"),m.setAttributeNS(null,"height",g(A)+"px"),m.setAttributeNS(null,"transform",`scale(${g(1/L)} ${g(-1/A)})`),c?c.append(m):this._ensureTransformGroup().append(m)}paintImageMaskXObject(a){const c=this.getObject(a.data,a);if(c.bitmap){(0,d.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const L=this.current,A=c.width,l=c.height,F=L.fillColor;L.maskId=`mask${y++}`;const m=this.svgFactory.createElement("svg:mask");m.setAttributeNS(null,"id",L.maskId);const $=this.svgFactory.createElement("svg:rect");$.setAttributeNS(null,"x","0"),$.setAttributeNS(null,"y","0"),$.setAttributeNS(null,"width",g(A)),$.setAttributeNS(null,"height",g(l)),$.setAttributeNS(null,"fill",F),$.setAttributeNS(null,"mask",`url(#${L.maskId})`),this.defs.append(m),this._ensureTransformGroup().append($),this.paintInlineImageXObject(c,m)}paintFormXObjectBegin(a,c){if(Array.isArray(a)&&a.length===6&&this.transform(a[0],a[1],a[2],a[3],a[4],a[5]),c){const L=c[2]-c[0],A=c[3]-c[1],l=this.svgFactory.createElement("svg:rect");l.setAttributeNS(null,"x",c[0]),l.setAttributeNS(null,"y",c[1]),l.setAttributeNS(null,"width",g(L)),l.setAttributeNS(null,"height",g(A)),this.current.element=l,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(a){const c=this.svgFactory.create(a.width,a.height),L=this.svgFactory.createElement("svg:defs");c.append(L),this.defs=L;const A=this.svgFactory.createElement("svg:g");return A.setAttributeNS(null,"transform",x(a.transform)),c.append(A),this.svg=A,c}_ensureClipGroup(){if(!this.current.clipGroup){const a=this.svgFactory.createElement("svg:g");a.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(a),this.current.clipGroup=a}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",x(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}e.SVGGraphics=w},(b,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaText=void 0;class v{static textContent(d){const W=[],j={items:W,styles:Object.create(null)};function it(k){var I;if(!k)return;let S=null;const f=k.name;if(f==="#text")S=k.value;else if(v.shouldBuildText(f))(I=k==null?void 0:k.attributes)!=null&&I.textContent?S=k.attributes.textContent:k.value&&(S=k.value);else return;if(S!==null&&W.push({str:S}),!!k.children)for(const D of k.children)it(D)}return it(d),j}static shouldBuildText(d){return!(d==="textarea"||d==="input"||d==="option"||d==="select")}}e.XfaText=v},(b,e,v)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TextLayerRenderTask=void 0,e.renderTextLayer=x,e.updateTextLayer=u;var n=v(1),d=v(6);const W=1e5,j=30,it=.8,k=new Map;function S(y,C){let w;if(C&&n.FeatureTest.isOffscreenCanvasSupported)w=new OffscreenCanvas(y,y).getContext("2d",{alpha:!1});else{const _=document.createElement("canvas");_.width=_.height=y,w=_.getContext("2d",{alpha:!1})}return w}function f(y,C){const w=k.get(y);if(w)return w;const _=S(j,C);_.font=`${j}px ${y}`;const a=_.measureText("");let c=a.fontBoundingBoxAscent,L=Math.abs(a.fontBoundingBoxDescent);if(c){const l=c/(c+L);return k.set(y,l),_.canvas.width=_.canvas.height=0,l}_.strokeStyle="red",_.clearRect(0,0,j,j),_.strokeText("g",0,0);let A=_.getImageData(0,0,j,j).data;L=0;for(let l=A.length-1-3;l>=0;l-=4)if(A[l]>0){L=Math.ceil(l/4/j);break}_.clearRect(0,0,j,j),_.strokeText("A",0,j),A=_.getImageData(0,0,j,j).data,c=0;for(let l=0,F=A.length;l<F;l+=4)if(A[l]>0){c=j-Math.floor(l/4/j);break}if(_.canvas.width=_.canvas.height=0,c){const l=c/(c+L);return k.set(y,l),l}return k.set(y,it),it}function I(y,C,w){const _=document.createElement("span"),a={angle:0,canvasWidth:0,hasText:C.str!=="",hasEOL:C.hasEOL,fontSize:0};y._textDivs.push(_);const c=n.Util.transform(y._transform,C.transform);let L=Math.atan2(c[1],c[0]);const A=w[C.fontName];A.vertical&&(L+=Math.PI/2);const l=Math.hypot(c[2],c[3]),F=l*f(A.fontFamily,y._isOffscreenCanvasSupported);let m,$;L===0?(m=c[4],$=c[5]-F):(m=c[4]+F*Math.sin(L),$=c[5]-F*Math.cos(L));const z="calc(var(--scale-factor)*",R=_.style;y._container===y._rootContainer?(R.left=`${(100*m/y._pageWidth).toFixed(2)}%`,R.top=`${(100*$/y._pageHeight).toFixed(2)}%`):(R.left=`${z}${m.toFixed(2)}px)`,R.top=`${z}${$.toFixed(2)}px)`),R.fontSize=`${z}${l.toFixed(2)}px)`,R.fontFamily=A.fontFamily,a.fontSize=l,_.setAttribute("role","presentation"),_.textContent=C.str,_.dir=C.dir,y._fontInspectorEnabled&&(_.dataset.fontName=C.fontName),L!==0&&(a.angle=L*(180/Math.PI));let V=!1;if(C.str.length>1)V=!0;else if(C.str!==" "&&C.transform[0]!==C.transform[3]){const st=Math.abs(C.transform[0]),at=Math.abs(C.transform[3]);st!==at&&Math.max(st,at)/Math.min(st,at)>1.5&&(V=!0)}V&&(a.canvasWidth=A.vertical?C.height:C.width),y._textDivProperties.set(_,a),y._isReadableStream&&y._layoutText(_)}function D(y){const{div:C,scale:w,properties:_,ctx:a,prevFontSize:c,prevFontFamily:L}=y,{style:A}=C;let l="";if(_.canvasWidth!==0&&_.hasText){const{fontFamily:F}=A,{canvasWidth:m,fontSize:$}=_;(c!==$||L!==F)&&(a.font=`${$*w}px ${F}`,y.prevFontSize=$,y.prevFontFamily=F);const{width:z}=a.measureText(C.textContent);z>0&&(l=`scaleX(${m*w/z})`)}_.angle!==0&&(l=`rotate(${_.angle}deg) ${l}`),l.length>0&&(A.transform=l)}function E(y){if(y._canceled)return;const C=y._textDivs,w=y._capability;if(C.length>W){w.resolve();return}if(!y._isReadableStream)for(const a of C)y._layoutText(a);w.resolve()}class g{constructor({textContentSource:C,container:w,viewport:_,textDivs:a,textDivProperties:c,textContentItemsStr:L,isOffscreenCanvasSupported:A}){var z;this._textContentSource=C,this._isReadableStream=C instanceof ReadableStream,this._container=this._rootContainer=w,this._textDivs=a||[],this._textContentItemsStr=L||[],this._isOffscreenCanvasSupported=A,this._fontInspectorEnabled=!!((z=globalThis.FontInspector)!=null&&z.enabled),this._reader=null,this._textDivProperties=c||new WeakMap,this._canceled=!1,this._capability=new n.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:_.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:S(0,A)};const{pageWidth:l,pageHeight:F,pageX:m,pageY:$}=_.rawDims;this._transform=[1,0,0,-1,-m,$+F],this._pageWidth=l,this._pageHeight=F,(0,d.setLayerDimensions)(w,_),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new n.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new n.AbortException("TextLayer task cancelled."))}_processItems(C,w){for(const _ of C){if(_.str===void 0){if(_.type==="beginMarkedContentProps"||_.type==="beginMarkedContent"){const a=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),_.id!==null&&this._container.setAttribute("id",`${_.id}`),a.append(this._container)}else _.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(_.str),I(this,_,w)}}_layoutText(C){const w=this._layoutTextParams.properties=this._textDivProperties.get(C);if(this._layoutTextParams.div=C,D(this._layoutTextParams),w.hasText&&this._container.append(C),w.hasEOL){const _=document.createElement("br");_.setAttribute("role","presentation"),this._container.append(_)}}_render(){const C=new n.PromiseCapability;let w=Object.create(null);if(this._isReadableStream){const _=()=>{this._reader.read().then(({value:a,done:c})=>{if(c){C.resolve();return}Object.assign(w,a.styles),this._processItems(a.items,w),_()},C.reject)};this._reader=this._textContentSource.getReader(),_()}else if(this._textContentSource){const{items:_,styles:a}=this._textContentSource;this._processItems(_,a),C.resolve()}else throw new Error('No "textContentSource" parameter specified.');C.promise.then(()=>{w=null,E(this)},this._capability.reject)}}e.TextLayerRenderTask=g;function x(y){!y.textContentSource&&(y.textContent||y.textContentStream)&&((0,d.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),y.textContentSource=y.textContent||y.textContentStream);const{container:C,viewport:w}=y,_=getComputedStyle(C),a=_.getPropertyValue("visibility"),c=parseFloat(_.getPropertyValue("--scale-factor"));a==="visible"&&(!c||Math.abs(c-w.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const L=new g(y);return L._render(),L}function u({container:y,viewport:C,textDivs:w,textDivProperties:_,isOffscreenCanvasSupported:a,mustRotate:c=!0,mustRescale:L=!0}){if(c&&(0,d.setLayerDimensions)(y,{rotation:C.rotation}),L){const A=S(0,a),F={prevFontSize:null,prevFontFamily:null,div:null,scale:C.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:A};for(const m of w)F.properties=_.get(m),F.div=m,D(F)}}},(b,e,v)=>{var f,I,D,E,g,x,u,y,C,w,_,en,c,Pe,A,nn,F,sn;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditorLayer=void 0;var n=v(1),d=v(4),W=v(28),j=v(33),it=v(6),k=v(34);const $=class ${constructor({uiManager:R,pageIndex:V,div:st,accessibilityManager:at,annotationLayer:G,viewport:ct,l10n:gt}){U(this,_);U(this,c);U(this,A);U(this,F);U(this,f,void 0);U(this,I,!1);U(this,D,null);U(this,E,this.pointerup.bind(this));U(this,g,this.pointerdown.bind(this));U(this,x,new Map);U(this,u,!1);U(this,y,!1);U(this,C,!1);U(this,w,void 0);const xt=[W.FreeTextEditor,j.InkEditor,k.StampEditor];if(!$._initialized){$._initialized=!0;for(const Et of xt)Et.initialize(gt)}R.registerEditorTypes(xt),rt(this,w,R),this.pageIndex=V,this.div=st,rt(this,f,at),rt(this,D,G),this.viewport=ct,t(this,w).addLayer(this)}get isEmpty(){return t(this,x).size===0}updateToolbar(R){t(this,w).updateToolbar(R)}updateMode(R=t(this,w).getMode()){X(this,F,sn).call(this),R===n.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),R!==n.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",R===n.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",R===n.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",R===n.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(R){if(!R&&t(this,w).getMode()!==n.AnnotationEditorType.INK)return;if(!R){for(const st of t(this,x).values())if(st.isEmpty()){st.setInBackground();return}}X(this,c,Pe).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(R){t(this,w).setEditingState(R)}addCommands(R){t(this,w).addCommands(R)}enable(){this.div.style.pointerEvents="auto";const R=new Set;for(const st of t(this,x).values())st.enableEditing(),st.annotationElementId&&R.add(st.annotationElementId);if(!t(this,D))return;const V=t(this,D).getEditableAnnotations();for(const st of V){if(st.hide(),t(this,w).isDeletedAnnotationElement(st.data.id)||R.has(st.data.id))continue;const at=this.deserialize(st);at&&(this.addOrRebuild(at),at.enableEditing())}}disable(){var V;rt(this,C,!0),this.div.style.pointerEvents="none";const R=new Set;for(const st of t(this,x).values()){if(st.disableEditing(),!st.annotationElementId||st.serialize()!==null){R.add(st.annotationElementId);continue}(V=this.getEditableAnnotation(st.annotationElementId))==null||V.show(),st.remove()}if(t(this,D)){const st=t(this,D).getEditableAnnotations();for(const at of st){const{id:G}=at.data;R.has(G)||t(this,w).isDeletedAnnotationElement(G)||at.show()}}X(this,F,sn).call(this),this.isEmpty&&(this.div.hidden=!0),rt(this,C,!1)}getEditableAnnotation(R){var V;return((V=t(this,D))==null?void 0:V.getEditableAnnotation(R))||null}setActiveEditor(R){t(this,w).getActive()!==R&&t(this,w).setActiveEditor(R)}enableClick(){this.div.addEventListener("pointerdown",t(this,g)),this.div.addEventListener("pointerup",t(this,E))}disableClick(){this.div.removeEventListener("pointerdown",t(this,g)),this.div.removeEventListener("pointerup",t(this,E))}attach(R){t(this,x).set(R.id,R);const{annotationElementId:V}=R;V&&t(this,w).isDeletedAnnotationElement(V)&&t(this,w).removeDeletedAnnotationElement(R)}detach(R){var V;t(this,x).delete(R.id),(V=t(this,f))==null||V.removePointerInTextLayer(R.contentDiv),!t(this,C)&&R.annotationElementId&&t(this,w).addDeletedAnnotationElement(R)}remove(R){this.detach(R),t(this,w).removeEditor(R),R.div.contains(document.activeElement)&&setTimeout(()=>{t(this,w).focusMainContainer()},0),R.div.remove(),R.isAttachedToDOM=!1,t(this,y)||this.addInkEditorIfNeeded(!1)}changeParent(R){var V;R.parent!==this&&(R.annotationElementId&&(t(this,w).addDeletedAnnotationElement(R.annotationElementId),d.AnnotationEditor.deleteAnnotationElement(R),R.annotationElementId=null),this.attach(R),(V=R.parent)==null||V.detach(R),R.setParent(this),R.div&&R.isAttachedToDOM&&(R.div.remove(),this.div.append(R.div)))}add(R){if(this.changeParent(R),t(this,w).addEditor(R),this.attach(R),!R.isAttachedToDOM){const V=R.render();this.div.append(V),R.isAttachedToDOM=!0}R.fixAndSetPosition(),R.onceAdded(),t(this,w).addToAnnotationStorage(R)}moveEditorInDOM(R){var st;if(!R.isAttachedToDOM)return;const{activeElement:V}=document;R.div.contains(V)&&(R._focusEventsAllowed=!1,setTimeout(()=>{R.div.contains(document.activeElement)?R._focusEventsAllowed=!0:(R.div.addEventListener("focusin",()=>{R._focusEventsAllowed=!0},{once:!0}),V.focus())},0)),R._structTreeParentId=(st=t(this,f))==null?void 0:st.moveElementInDOM(this.div,R.div,R.contentDiv,!0)}addOrRebuild(R){R.needsToBeRebuilt()?R.rebuild():this.add(R)}addUndoableEditor(R){const V=()=>R._uiManager.rebuild(R),st=()=>{R.remove()};this.addCommands({cmd:V,undo:st,mustExec:!1})}getNextId(){return t(this,w).getId()}pasteEditor(R,V){t(this,w).updateToolbar(R),t(this,w).updateMode(R);const{offsetX:st,offsetY:at}=X(this,A,nn).call(this),G=this.getNextId(),ct=X(this,_,en).call(this,{parent:this,id:G,x:st,y:at,uiManager:t(this,w),isCentered:!0,...V});ct&&this.add(ct)}deserialize(R){switch(R.annotationType??R.annotationEditorType){case n.AnnotationEditorType.FREETEXT:return W.FreeTextEditor.deserialize(R,this,t(this,w));case n.AnnotationEditorType.INK:return j.InkEditor.deserialize(R,this,t(this,w));case n.AnnotationEditorType.STAMP:return k.StampEditor.deserialize(R,this,t(this,w))}return null}addNewEditor(){X(this,c,Pe).call(this,X(this,A,nn).call(this),!0)}setSelected(R){t(this,w).setSelected(R)}toggleSelected(R){t(this,w).toggleSelected(R)}isSelected(R){return t(this,w).isSelected(R)}unselect(R){t(this,w).unselect(R)}pointerup(R){const{isMac:V}=n.FeatureTest.platform;if(!(R.button!==0||R.ctrlKey&&V)&&R.target===this.div&&t(this,u)){if(rt(this,u,!1),!t(this,I)){rt(this,I,!0);return}if(t(this,w).getMode()===n.AnnotationEditorType.STAMP){t(this,w).unselectAll();return}X(this,c,Pe).call(this,R,!1)}}pointerdown(R){if(t(this,u)){rt(this,u,!1);return}const{isMac:V}=n.FeatureTest.platform;if(R.button!==0||R.ctrlKey&&V||R.target!==this.div)return;rt(this,u,!0);const st=t(this,w).getActive();rt(this,I,!st||st.isEmpty())}findNewParent(R,V,st){const at=t(this,w).findParent(V,st);return at===null||at===this?!1:(at.changeParent(R),!0)}destroy(){var R,V;((R=t(this,w).getActive())==null?void 0:R.parent)===this&&(t(this,w).commitOrRemove(),t(this,w).setActiveEditor(null));for(const st of t(this,x).values())(V=t(this,f))==null||V.removePointerInTextLayer(st.contentDiv),st.setParent(null),st.isAttachedToDOM=!1,st.div.remove();this.div=null,t(this,x).clear(),t(this,w).removeLayer(this)}render({viewport:R}){this.viewport=R,(0,it.setLayerDimensions)(this.div,R);for(const V of t(this,w).getEditors(this.pageIndex))this.add(V);this.updateMode()}update({viewport:R}){t(this,w).commitOrRemove(),this.viewport=R,(0,it.setLayerDimensions)(this.div,{rotation:R.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:R,pageHeight:V}=this.viewport.rawDims;return[R,V]}};f=new WeakMap,I=new WeakMap,D=new WeakMap,E=new WeakMap,g=new WeakMap,x=new WeakMap,u=new WeakMap,y=new WeakMap,C=new WeakMap,w=new WeakMap,_=new WeakSet,en=function(R){switch(t(this,w).getMode()){case n.AnnotationEditorType.FREETEXT:return new W.FreeTextEditor(R);case n.AnnotationEditorType.INK:return new j.InkEditor(R);case n.AnnotationEditorType.STAMP:return new k.StampEditor(R)}return null},c=new WeakSet,Pe=function(R,V){const st=this.getNextId(),at=X(this,_,en).call(this,{parent:this,id:st,x:R.offsetX,y:R.offsetY,uiManager:t(this,w),isCentered:V});return at&&this.add(at),at},A=new WeakSet,nn=function(){const{x:R,y:V,width:st,height:at}=this.div.getBoundingClientRect(),G=Math.max(0,R),ct=Math.max(0,V),gt=Math.min(window.innerWidth,R+st),xt=Math.min(window.innerHeight,V+at),Et=(G+gt)/2-R,M=(ct+xt)/2-V,[i,o]=this.viewport.rotation%180===0?[Et,M]:[M,Et];return{offsetX:i,offsetY:o}},F=new WeakSet,sn=function(){rt(this,y,!0);for(const R of t(this,x).values())R.isEmpty()&&R.remove();rt(this,y,!1)},ee($,"_initialized",!1);let S=$;e.AnnotationEditorLayer=S},(b,e,v)=>{var k,S,f,I,D,E,g,x,u,y,Fn,w,Mn,a,Dn,L,Ae,l,rn,m,Ln,z,an;Object.defineProperty(e,"__esModule",{value:!0}),e.FreeTextEditor=void 0;var n=v(1),d=v(5),W=v(4),j=v(29);const V=class V extends W.AnnotationEditor{constructor(G){super({...G,name:"freeTextEditor"});U(this,y);U(this,w);U(this,a);U(this,L);U(this,l);U(this,m);U(this,z);U(this,k,this.editorDivBlur.bind(this));U(this,S,this.editorDivFocus.bind(this));U(this,f,this.editorDivInput.bind(this));U(this,I,this.editorDivKeydown.bind(this));U(this,D,void 0);U(this,E,"");U(this,g,`${this.id}-editor`);U(this,x,void 0);U(this,u,null);rt(this,D,G.color||V._defaultColor||W.AnnotationEditor._defaultLineColor),rt(this,x,G.fontSize||V._defaultFontSize)}static get _keyboardManager(){const G=V.prototype,ct=Et=>Et.isEmpty(),gt=d.AnnotationEditorUIManager.TRANSLATE_SMALL,xt=d.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new d.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],G.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],G.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],G._translateEmpty,{args:[-gt,0],checker:ct}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],G._translateEmpty,{args:[-xt,0],checker:ct}],[["ArrowRight","mac+ArrowRight"],G._translateEmpty,{args:[gt,0],checker:ct}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],G._translateEmpty,{args:[xt,0],checker:ct}],[["ArrowUp","mac+ArrowUp"],G._translateEmpty,{args:[0,-gt],checker:ct}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],G._translateEmpty,{args:[0,-xt],checker:ct}],[["ArrowDown","mac+ArrowDown"],G._translateEmpty,{args:[0,gt],checker:ct}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],G._translateEmpty,{args:[0,xt],checker:ct}]]))}static initialize(G){W.AnnotationEditor.initialize(G,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const ct=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(ct.getPropertyValue("--freetext-padding"))}static updateDefaultParams(G,ct){switch(G){case n.AnnotationEditorParamsType.FREETEXT_SIZE:V._defaultFontSize=ct;break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:V._defaultColor=ct;break}}updateParams(G,ct){switch(G){case n.AnnotationEditorParamsType.FREETEXT_SIZE:X(this,y,Fn).call(this,ct);break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:X(this,w,Mn).call(this,ct);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,V._defaultFontSize],[n.AnnotationEditorParamsType.FREETEXT_COLOR,V._defaultColor||W.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,t(this,x)],[n.AnnotationEditorParamsType.FREETEXT_COLOR,t(this,D)]]}_translateEmpty(G,ct){this._uiManager.translateSelectedEditors(G,ct,!0)}getInitialTranslation(){const G=this.parentScale;return[-V._internalPadding*G,-(V._internalPadding+t(this,x))*G]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(n.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",t(this,I)),this.editorDiv.addEventListener("focus",t(this,S)),this.editorDiv.addEventListener("blur",t(this,k)),this.editorDiv.addEventListener("input",t(this,f)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",t(this,g)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",t(this,I)),this.editorDiv.removeEventListener("focus",t(this,S)),this.editorDiv.removeEventListener("blur",t(this,k)),this.editorDiv.removeEventListener("input",t(this,f)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(G){this._focusEventsAllowed&&(super.focusin(G),G.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var G;if(this.width){X(this,z,an).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(G=this._initialOptions)!=null&&G.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const G=t(this,E),ct=rt(this,E,X(this,a,Dn).call(this).trimEnd());if(G===ct)return;const gt=xt=>{if(rt(this,E,xt),!xt){this.remove();return}X(this,l,rn).call(this),this._uiManager.rebuild(this),X(this,L,Ae).call(this)};this.addCommands({cmd:()=>{gt(ct)},undo:()=>{gt(G)},mustExec:!1}),X(this,L,Ae).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(G){this.enterInEditMode()}keydown(G){G.target===this.div&&G.key==="Enter"&&(this.enterInEditMode(),G.preventDefault())}editorDivKeydown(G){V._keyboardManager.exec(this,G)}editorDivFocus(G){this.isEditing=!0}editorDivBlur(G){this.isEditing=!1}editorDivInput(G){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let G,ct;this.width&&(G=this.x,ct=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",t(this,g)),this.enableEditing(),W.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(xt=>{var Et;return(Et=this.editorDiv)==null?void 0:Et.setAttribute("aria-label",xt)}),W.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(xt=>{var Et;return(Et=this.editorDiv)==null?void 0:Et.setAttribute("default-content",xt)}),this.editorDiv.contentEditable=!0;const{style:gt}=this.editorDiv;if(gt.fontSize=`calc(${t(this,x)}px * var(--scale-factor))`,gt.color=t(this,D),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,d.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[xt,Et]=this.parentDimensions;if(this.annotationElementId){const{position:M}=t(this,u);let[i,o]=this.getInitialTranslation();[i,o]=this.pageTranslationToScreen(i,o);const[r,h]=this.pageDimensions,[p,P]=this.pageTranslation;let O,H;switch(this.rotation){case 0:O=G+(M[0]-p)/r,H=ct+this.height-(M[1]-P)/h;break;case 90:O=G+(M[0]-p)/r,H=ct-(M[1]-P)/h,[i,o]=[o,-i];break;case 180:O=G-this.width+(M[0]-p)/r,H=ct-(M[1]-P)/h,[i,o]=[-i,-o];break;case 270:O=G+(M[0]-p-this.height*h)/r,H=ct+(M[1]-P-this.width*r)/h,[i,o]=[-o,i];break}this.setAt(O*xt,H*Et,i,o)}else this.setAt(G*xt,ct*Et,this.width*xt,this.height*Et);X(this,l,rn).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(G,ct,gt){let xt=null;if(G instanceof j.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:M,fontColor:i},rect:o,rotation:r,id:h},textContent:p,textPosition:P,parent:{page:{pageNumber:O}}}=G;if(!p||p.length===0)return null;xt=G={annotationType:n.AnnotationEditorType.FREETEXT,color:Array.from(i),fontSize:M,value:p.join(`
`),position:P,pageIndex:O-1,rect:o,rotation:r,id:h,deleted:!1}}const Et=super.deserialize(G,ct,gt);return rt(Et,x,G.fontSize),rt(Et,D,n.Util.makeHexColor(...G.color)),rt(Et,E,G.value),Et.annotationElementId=G.id||null,rt(Et,u,xt),Et}serialize(G=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const ct=V._internalPadding*this.parentScale,gt=this.getRect(ct,ct),xt=W.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:t(this,D)),Et={annotationType:n.AnnotationEditorType.FREETEXT,color:xt,fontSize:t(this,x),value:t(this,E),pageIndex:this.pageIndex,rect:gt,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return G?Et:this.annotationElementId&&!X(this,m,Ln).call(this,Et)?null:(Et.id=this.annotationElementId,Et)}};k=new WeakMap,S=new WeakMap,f=new WeakMap,I=new WeakMap,D=new WeakMap,E=new WeakMap,g=new WeakMap,x=new WeakMap,u=new WeakMap,y=new WeakSet,Fn=function(G){const ct=xt=>{this.editorDiv.style.fontSize=`calc(${xt}px * var(--scale-factor))`,this.translate(0,-(xt-t(this,x))*this.parentScale),rt(this,x,xt),X(this,L,Ae).call(this)},gt=t(this,x);this.addCommands({cmd:()=>{ct(G)},undo:()=>{ct(gt)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},w=new WeakSet,Mn=function(G){const ct=t(this,D);this.addCommands({cmd:()=>{rt(this,D,this.editorDiv.style.color=G)},undo:()=>{rt(this,D,this.editorDiv.style.color=ct)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},a=new WeakSet,Dn=function(){const G=this.editorDiv.getElementsByTagName("div");if(G.length===0)return this.editorDiv.innerText;const ct=[];for(const gt of G)ct.push(gt.innerText.replace(/\r\n?|\n/,""));return ct.join(`
`)},L=new WeakSet,Ae=function(){const[G,ct]=this.parentDimensions;let gt;if(this.isAttachedToDOM)gt=this.div.getBoundingClientRect();else{const{currentLayer:xt,div:Et}=this,M=Et.style.display;Et.style.display="hidden",xt.div.append(this.div),gt=Et.getBoundingClientRect(),Et.remove(),Et.style.display=M}this.rotation%180===this.parentRotation%180?(this.width=gt.width/G,this.height=gt.height/ct):(this.width=gt.height/G,this.height=gt.width/ct),this.fixAndSetPosition()},l=new WeakSet,rn=function(){if(this.editorDiv.replaceChildren(),!!t(this,E))for(const G of t(this,E).split(`
`)){const ct=document.createElement("div");ct.append(G?document.createTextNode(G):document.createElement("br")),this.editorDiv.append(ct)}},m=new WeakSet,Ln=function(G){const{value:ct,fontSize:gt,color:xt,rect:Et,pageIndex:M}=t(this,u);return G.value!==ct||G.fontSize!==gt||G.rect.some((i,o)=>Math.abs(i-Et[o])>=1)||G.color.some((i,o)=>i!==xt[o])||G.pageIndex!==M},z=new WeakSet,an=function(G=!1){if(!this.annotationElementId)return;if(X(this,L,Ae).call(this),!G&&(this.width===0||this.height===0)){setTimeout(()=>X(this,z,an).call(this,!0),0);return}const ct=V._internalPadding*this.parentScale;t(this,u).rect=this.getRect(ct,ct)},ee(V,"_freeTextDefaultContent",""),ee(V,"_internalPadding",0),ee(V,"_defaultColor",null),ee(V,"_defaultFontSize",10),ee(V,"_type","freetext");let it=V;e.FreeTextEditor=it},(b,e,v)=>{var o,h,ce,P,In,H,nt,J,ot,ht,ft,dt,wt,Lt,vt,Dt,mt,et,Q,pt,Tt,Ct,Ut,On,Wt,ke,Gt,on,Xt,ln,tt,Y,yt,At,te,Qt,Z,cn,Ot,Rt,jt,Nt,jn,_t,hn;Object.defineProperty(e,"__esModule",{value:!0}),e.StampAnnotationElement=e.InkAnnotationElement=e.FreeTextAnnotationElement=e.AnnotationLayer=void 0;var n=v(1),d=v(6),W=v(3),j=v(30),it=v(31),k=v(32);const S=1e3,f=9,I=new WeakSet;function D(It){return{width:It[2]-It[0],height:It[3]-It[1]}}class E{static create(N){switch(N.data.annotationType){case n.AnnotationType.LINK:return new x(N);case n.AnnotationType.TEXT:return new u(N);case n.AnnotationType.WIDGET:switch(N.data.fieldType){case"Tx":return new C(N);case"Btn":return N.data.radioButton?new a(N):N.data.checkBox?new _(N):new c(N);case"Ch":return new L(N);case"Sig":return new w(N)}return new y(N);case n.AnnotationType.POPUP:return new A(N);case n.AnnotationType.FREETEXT:return new F(N);case n.AnnotationType.LINE:return new m(N);case n.AnnotationType.SQUARE:return new $(N);case n.AnnotationType.CIRCLE:return new z(N);case n.AnnotationType.POLYLINE:return new R(N);case n.AnnotationType.CARET:return new st(N);case n.AnnotationType.INK:return new at(N);case n.AnnotationType.POLYGON:return new V(N);case n.AnnotationType.HIGHLIGHT:return new G(N);case n.AnnotationType.UNDERLINE:return new ct(N);case n.AnnotationType.SQUIGGLY:return new gt(N);case n.AnnotationType.STRIKEOUT:return new xt(N);case n.AnnotationType.STAMP:return new Et(N);case n.AnnotationType.FILEATTACHMENT:return new M(N);default:return new g(N)}}}const r=class r{constructor(N,{isRenderable:s=!1,ignoreBorder:T=!1,createQuadrilaterals:B=!1}={}){U(this,o,!1);this.isRenderable=s,this.data=N.data,this.layer=N.layer,this.linkService=N.linkService,this.downloadManager=N.downloadManager,this.imageResourcesPath=N.imageResourcesPath,this.renderForms=N.renderForms,this.svgFactory=N.svgFactory,this.annotationStorage=N.annotationStorage,this.enableScripting=N.enableScripting,this.hasJSActions=N.hasJSActions,this._fieldObjects=N.fieldObjects,this.parent=N.parent,s&&(this.container=this._createContainer(T)),B&&this._createQuadrilaterals()}static _hasPopupData({titleObj:N,contentsObj:s,richText:T}){return!!(N!=null&&N.str||s!=null&&s.str||T!=null&&T.str)}get hasPopupData(){return r._hasPopupData(this.data)}_createContainer(N){const{data:s,parent:{page:T,viewport:B}}=this,q=document.createElement("section");q.setAttribute("data-annotation-id",s.id),this instanceof y||(q.tabIndex=S),q.style.zIndex=this.parent.zIndex++,this.data.popupRef&&q.setAttribute("aria-haspopup","dialog"),s.noRotate&&q.classList.add("norotate");const{pageWidth:K,pageHeight:lt,pageX:bt,pageY:kt}=B.rawDims;if(!s.rect||this instanceof A){const{rotation:Ht}=s;return!s.hasOwnCanvas&&Ht!==0&&this.setRotation(Ht,q),q}const{width:Pt,height:qt}=D(s.rect),Ft=n.Util.normalizeRect([s.rect[0],T.view[3]-s.rect[1]+T.view[1],s.rect[2],T.view[3]-s.rect[3]+T.view[1]]);if(!N&&s.borderStyle.width>0){q.style.borderWidth=`${s.borderStyle.width}px`;const Ht=s.borderStyle.horizontalCornerRadius,Vt=s.borderStyle.verticalCornerRadius;if(Ht>0||Vt>0){const Zt=`calc(${Ht}px * var(--scale-factor)) / calc(${Vt}px * var(--scale-factor))`;q.style.borderRadius=Zt}else if(this instanceof a){const Zt=`calc(${Pt}px * var(--scale-factor)) / calc(${qt}px * var(--scale-factor))`;q.style.borderRadius=Zt}switch(s.borderStyle.style){case n.AnnotationBorderStyleType.SOLID:q.style.borderStyle="solid";break;case n.AnnotationBorderStyleType.DASHED:q.style.borderStyle="dashed";break;case n.AnnotationBorderStyleType.BEVELED:(0,n.warn)("Unimplemented border style: beveled");break;case n.AnnotationBorderStyleType.INSET:(0,n.warn)("Unimplemented border style: inset");break;case n.AnnotationBorderStyleType.UNDERLINE:q.style.borderBottomStyle="solid";break}const Kt=s.borderColor||null;Kt?(rt(this,o,!0),q.style.borderColor=n.Util.makeHexColor(Kt[0]|0,Kt[1]|0,Kt[2]|0)):q.style.borderWidth=0}q.style.left=`${100*(Ft[0]-bt)/K}%`,q.style.top=`${100*(Ft[1]-kt)/lt}%`;const{rotation:Mt}=s;return s.hasOwnCanvas||Mt===0?(q.style.width=`${100*Pt/K}%`,q.style.height=`${100*qt/lt}%`):this.setRotation(Mt,q),q}setRotation(N,s=this.container){if(!this.data.rect)return;const{pageWidth:T,pageHeight:B}=this.parent.viewport.rawDims,{width:q,height:K}=D(this.data.rect);let lt,bt;N%180===0?(lt=100*q/T,bt=100*K/B):(lt=100*K/T,bt=100*q/B),s.style.width=`${lt}%`,s.style.height=`${bt}%`,s.setAttribute("data-main-rotation",(360-N)%360)}get _commonActions(){const N=(s,T,B)=>{const q=B.detail[s],K=q[0],lt=q.slice(1);B.target.style[T]=j.ColorConverters[`${K}_HTML`](lt),this.annotationStorage.setValue(this.data.id,{[T]:j.ColorConverters[`${K}_rgb`](lt)})};return(0,n.shadow)(this,"_commonActions",{display:s=>{const{display:T}=s.detail,B=T%2===1;this.container.style.visibility=B?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:B,noPrint:T===1||T===2})},print:s=>{this.annotationStorage.setValue(this.data.id,{noPrint:!s.detail.print})},hidden:s=>{const{hidden:T}=s.detail;this.container.style.visibility=T?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:T,noView:T})},focus:s=>{setTimeout(()=>s.target.focus({preventScroll:!1}),0)},userName:s=>{s.target.title=s.detail.userName},readonly:s=>{s.target.disabled=s.detail.readonly},required:s=>{this._setRequired(s.target,s.detail.required)},bgColor:s=>{N("bgColor","backgroundColor",s)},fillColor:s=>{N("fillColor","backgroundColor",s)},fgColor:s=>{N("fgColor","color",s)},textColor:s=>{N("textColor","color",s)},borderColor:s=>{N("borderColor","borderColor",s)},strokeColor:s=>{N("strokeColor","borderColor",s)},rotation:s=>{const T=s.detail.rotation;this.setRotation(T),this.annotationStorage.setValue(this.data.id,{rotation:T})}})}_dispatchEventFromSandbox(N,s){const T=this._commonActions;for(const B of Object.keys(s.detail)){const q=N[B]||T[B];q==null||q(s)}}_setDefaultPropertiesFromJS(N){if(!this.enableScripting)return;const s=this.annotationStorage.getRawValue(this.data.id);if(!s)return;const T=this._commonActions;for(const[B,q]of Object.entries(s)){const K=T[B];if(K){const lt={detail:{[B]:q},target:N};K(lt),delete s[B]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:N}=this.data;if(!N)return;const[s,T,B,q]=this.data.rect;if(N.length===1){const[,{x:Vt,y:Kt},{x:Zt,y:se}]=N[0];if(B===Vt&&q===Kt&&s===Zt&&T===se)return}const{style:K}=this.container;let lt;if(t(this,o)){const{borderColor:Vt,borderWidth:Kt}=K;K.borderWidth=0,lt=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Vt}" stroke-width="${Kt}">`],this.container.classList.add("hasBorder")}const bt=B-s,kt=q-T,{svgFactory:Pt}=this,qt=Pt.createElement("svg");qt.classList.add("quadrilateralsContainer"),qt.setAttribute("width",0),qt.setAttribute("height",0);const Ft=Pt.createElement("defs");qt.append(Ft);const Mt=Pt.createElement("clipPath"),Ht=`clippath_${this.data.id}`;Mt.setAttribute("id",Ht),Mt.setAttribute("clipPathUnits","objectBoundingBox"),Ft.append(Mt);for(const[,{x:Vt,y:Kt},{x:Zt,y:se}]of N){const ne=Pt.createElement("rect"),ie=(Zt-s)/bt,oe=(q-Kt)/kt,le=(Vt-Zt)/bt,_n=(Kt-se)/kt;ne.setAttribute("x",ie),ne.setAttribute("y",oe),ne.setAttribute("width",le),ne.setAttribute("height",_n),Mt.append(ne),lt==null||lt.push(`<rect vector-effect="non-scaling-stroke" x="${ie}" y="${oe}" width="${le}" height="${_n}"/>`)}t(this,o)&&(lt.push("</g></svg>')"),K.backgroundImage=lt.join("")),this.container.append(qt),this.container.style.clipPath=`url(#${Ht})`}_createPopup(){const{container:N,data:s}=this;N.setAttribute("aria-haspopup","dialog");const T=new A({data:{color:s.color,titleObj:s.titleObj,modificationDate:s.modificationDate,contentsObj:s.contentsObj,richText:s.richText,parentRect:s.rect,borderStyle:0,id:`popup_${s.id}`,rotation:s.rotation},parent:this.parent,elements:[this]});this.parent.div.append(T.render())}render(){(0,n.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(N,s=null){const T=[];if(this._fieldObjects){const B=this._fieldObjects[N];if(B)for(const{page:q,id:K,exportValues:lt}of B){if(q===-1||K===s)continue;const bt=typeof lt=="string"?lt:null,kt=document.querySelector(`[data-element-id="${K}"]`);if(kt&&!I.has(kt)){(0,n.warn)(`_getElementsByName - element not allowed: ${K}`);continue}T.push({id:K,exportValue:bt,domElement:kt})}return T}for(const B of document.getElementsByName(N)){const{exportValue:q}=B,K=B.getAttribute("data-element-id");K!==s&&I.has(B)&&T.push({id:K,exportValue:q,domElement:B})}return T}show(){var N;this.container&&(this.container.hidden=!1),(N=this.popup)==null||N.maybeShow()}hide(){var N;this.container&&(this.container.hidden=!0),(N=this.popup)==null||N.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const N=this.getElementsToTriggerPopup();if(Array.isArray(N))for(const s of N)s.classList.add("highlightArea");else N.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:N,data:{id:s}}=this;this.container.addEventListener("dblclick",()=>{var T;(T=this.linkService.eventBus)==null||T.dispatch("switchannotationeditormode",{source:this,mode:N,editId:s})})}};o=new WeakMap;let g=r;class x extends g{constructor(s,T=null){super(s,{isRenderable:!0,ignoreBorder:!!(T!=null&&T.ignoreBorder),createQuadrilaterals:!0});U(this,h);U(this,P);this.isTooltipOnly=s.data.isTooltipOnly}render(){const{data:s,linkService:T}=this,B=document.createElement("a");B.setAttribute("data-element-id",s.id);let q=!1;return s.url?(T.addLinkAttributes(B,s.url,s.newWindow),q=!0):s.action?(this._bindNamedAction(B,s.action),q=!0):s.attachment?(this._bindAttachment(B,s.attachment),q=!0):s.setOCGState?(X(this,P,In).call(this,B,s.setOCGState),q=!0):s.dest?(this._bindLink(B,s.dest),q=!0):(s.actions&&(s.actions.Action||s.actions["Mouse Up"]||s.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(B,s),q=!0),s.resetForm?(this._bindResetFormAction(B,s.resetForm),q=!0):this.isTooltipOnly&&!q&&(this._bindLink(B,""),q=!0)),this.container.classList.add("linkAnnotation"),q&&this.container.append(B),this.container}_bindLink(s,T){s.href=this.linkService.getDestinationHash(T),s.onclick=()=>(T&&this.linkService.goToDestination(T),!1),(T||T==="")&&X(this,h,ce).call(this)}_bindNamedAction(s,T){s.href=this.linkService.getAnchorUrl(""),s.onclick=()=>(this.linkService.executeNamedAction(T),!1),X(this,h,ce).call(this)}_bindAttachment(s,T){s.href=this.linkService.getAnchorUrl(""),s.onclick=()=>{var B;return(B=this.downloadManager)==null||B.openOrDownloadData(this.container,T.content,T.filename),!1},X(this,h,ce).call(this)}_bindJSAction(s,T){s.href=this.linkService.getAnchorUrl("");const B=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const q of Object.keys(T.actions)){const K=B.get(q);K&&(s[K]=()=>{var lt;return(lt=this.linkService.eventBus)==null||lt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:T.id,name:q}}),!1})}s.onclick||(s.onclick=()=>!1),X(this,h,ce).call(this)}_bindResetFormAction(s,T){const B=s.onclick;if(B||(s.href=this.linkService.getAnchorUrl("")),X(this,h,ce).call(this),!this._fieldObjects){(0,n.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),B||(s.onclick=()=>!1);return}s.onclick=()=>{var qt;B==null||B();const{fields:q,refs:K,include:lt}=T,bt=[];if(q.length!==0||K.length!==0){const Ft=new Set(K);for(const Mt of q){const Ht=this._fieldObjects[Mt]||[];for(const{id:Vt}of Ht)Ft.add(Vt)}for(const Mt of Object.values(this._fieldObjects))for(const Ht of Mt)Ft.has(Ht.id)===lt&&bt.push(Ht)}else for(const Ft of Object.values(this._fieldObjects))bt.push(...Ft);const kt=this.annotationStorage,Pt=[];for(const Ft of bt){const{id:Mt}=Ft;switch(Pt.push(Mt),Ft.type){case"text":{const Vt=Ft.defaultValue||"";kt.setValue(Mt,{value:Vt});break}case"checkbox":case"radiobutton":{const Vt=Ft.defaultValue===Ft.exportValues;kt.setValue(Mt,{value:Vt});break}case"combobox":case"listbox":{const Vt=Ft.defaultValue||"";kt.setValue(Mt,{value:Vt});break}default:continue}const Ht=document.querySelector(`[data-element-id="${Mt}"]`);if(Ht){if(!I.has(Ht)){(0,n.warn)(`_bindResetFormAction - element not allowed: ${Mt}`);continue}}else continue;Ht.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((qt=this.linkService.eventBus)==null||qt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Pt,name:"ResetForm"}})),!1}}}h=new WeakSet,ce=function(){this.container.setAttribute("data-internal-link","")},P=new WeakSet,In=function(s,T){s.href=this.linkService.getAnchorUrl(""),s.onclick=()=>(this.linkService.executeSetOCGState(T),!1),X(this,h,ce).call(this)};class u extends g{constructor(N){super(N,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const N=document.createElement("img");return N.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",N.alt="[{{type}} Annotation]",N.dataset.l10nId="text_annotation_type",N.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(N),this.container}}class y extends g{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(N){var s;this.data.hasOwnCanvas&&(((s=N.previousSibling)==null?void 0:s.nodeName)==="CANVAS"&&(N.previousSibling.hidden=!0),N.hidden=!1)}_getKeyModifier(N){const{isWin:s,isMac:T}=n.FeatureTest.platform;return s&&N.ctrlKey||T&&N.metaKey}_setEventListener(N,s,T,B,q){T.includes("mouse")?N.addEventListener(T,K=>{var lt;(lt=this.linkService.eventBus)==null||lt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:B,value:q(K),shift:K.shiftKey,modifier:this._getKeyModifier(K)}})}):N.addEventListener(T,K=>{var lt;if(T==="blur"){if(!s.focused||!K.relatedTarget)return;s.focused=!1}else if(T==="focus"){if(s.focused)return;s.focused=!0}q&&((lt=this.linkService.eventBus)==null||lt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:B,value:q(K)}}))})}_setEventListeners(N,s,T,B){var q,K,lt;for(const[bt,kt]of T)(kt==="Action"||(q=this.data.actions)!=null&&q[kt])&&((kt==="Focus"||kt==="Blur")&&(s||(s={focused:!1})),this._setEventListener(N,s,bt,kt,B),kt==="Focus"&&!((K=this.data.actions)!=null&&K.Blur)?this._setEventListener(N,s,"blur","Blur",null):kt==="Blur"&&!((lt=this.data.actions)!=null&&lt.Focus)&&this._setEventListener(N,s,"focus","Focus",null))}_setBackgroundColor(N){const s=this.data.backgroundColor||null;N.style.backgroundColor=s===null?"transparent":n.Util.makeHexColor(s[0],s[1],s[2])}_setTextStyle(N){const s=["left","center","right"],{fontColor:T}=this.data.defaultAppearanceData,B=this.data.defaultAppearanceData.fontSize||f,q=N.style;let K;const lt=2,bt=kt=>Math.round(10*kt)/10;if(this.data.multiLine){const kt=Math.abs(this.data.rect[3]-this.data.rect[1]-lt),Pt=Math.round(kt/(n.LINE_FACTOR*B))||1,qt=kt/Pt;K=Math.min(B,bt(qt/n.LINE_FACTOR))}else{const kt=Math.abs(this.data.rect[3]-this.data.rect[1]-lt);K=Math.min(B,bt(kt/n.LINE_FACTOR))}q.fontSize=`calc(${K}px * var(--scale-factor))`,q.color=n.Util.makeHexColor(T[0],T[1],T[2]),this.data.textAlignment!==null&&(q.textAlign=s[this.data.textAlignment])}_setRequired(N,s){s?N.setAttribute("required",!0):N.removeAttribute("required"),N.setAttribute("aria-required",s)}}class C extends y{constructor(N){const s=N.renderForms||!N.data.hasAppearance&&!!N.data.fieldValue;super(N,{isRenderable:s})}setPropertyOnSiblings(N,s,T,B){const q=this.annotationStorage;for(const K of this._getElementsByName(N.name,N.id))K.domElement&&(K.domElement[s]=T),q.setValue(K.id,{[B]:T})}render(){var B,q;const N=this.annotationStorage,s=this.data.id;this.container.classList.add("textWidgetAnnotation");let T=null;if(this.renderForms){const K=N.getValue(s,{value:this.data.fieldValue});let lt=K.value||"";const bt=N.getValue(s,{charLimit:this.data.maxLen}).charLimit;bt&&lt.length>bt&&(lt=lt.slice(0,bt));let kt=K.formattedValue||((B=this.data.textContent)==null?void 0:B.join(`
`))||null;kt&&this.data.comb&&(kt=kt.replaceAll(/\s+/g,""));const Pt={userValue:lt,formattedValue:kt,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(T=document.createElement("textarea"),T.textContent=kt??lt,this.data.doNotScroll&&(T.style.overflowY="hidden")):(T=document.createElement("input"),T.type="text",T.setAttribute("value",kt??lt),this.data.doNotScroll&&(T.style.overflowX="hidden")),this.data.hasOwnCanvas&&(T.hidden=!0),I.add(T),T.setAttribute("data-element-id",s),T.disabled=this.data.readOnly,T.name=this.data.fieldName,T.tabIndex=S,this._setRequired(T,this.data.required),bt&&(T.maxLength=bt),T.addEventListener("input",Ft=>{N.setValue(s,{value:Ft.target.value}),this.setPropertyOnSiblings(T,"value",Ft.target.value,"value"),Pt.formattedValue=null}),T.addEventListener("resetform",Ft=>{const Mt=this.data.defaultFieldValue??"";T.value=Pt.userValue=Mt,Pt.formattedValue=null});let qt=Ft=>{const{formattedValue:Mt}=Pt;Mt!=null&&(Ft.target.value=Mt),Ft.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){T.addEventListener("focus",Mt=>{if(Pt.focused)return;const{target:Ht}=Mt;Pt.userValue&&(Ht.value=Pt.userValue),Pt.lastCommittedValue=Ht.value,Pt.commitKey=1,Pt.focused=!0}),T.addEventListener("updatefromsandbox",Mt=>{this.showElementAndHideCanvas(Mt.target);const Ht={value(Vt){Pt.userValue=Vt.detail.value??"",N.setValue(s,{value:Pt.userValue.toString()}),Vt.target.value=Pt.userValue},formattedValue(Vt){const{formattedValue:Kt}=Vt.detail;Pt.formattedValue=Kt,Kt!=null&&Vt.target!==document.activeElement&&(Vt.target.value=Kt),N.setValue(s,{formattedValue:Kt})},selRange(Vt){Vt.target.setSelectionRange(...Vt.detail.selRange)},charLimit:Vt=>{var ne;const{charLimit:Kt}=Vt.detail,{target:Zt}=Vt;if(Kt===0){Zt.removeAttribute("maxLength");return}Zt.setAttribute("maxLength",Kt);let se=Pt.userValue;!se||se.length<=Kt||(se=se.slice(0,Kt),Zt.value=Pt.userValue=se,N.setValue(s,{value:se}),(ne=this.linkService.eventBus)==null||ne.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:se,willCommit:!0,commitKey:1,selStart:Zt.selectionStart,selEnd:Zt.selectionEnd}}))}};this._dispatchEventFromSandbox(Ht,Mt)}),T.addEventListener("keydown",Mt=>{var Kt;Pt.commitKey=1;let Ht=-1;if(Mt.key==="Escape"?Ht=0:Mt.key==="Enter"&&!this.data.multiLine?Ht=2:Mt.key==="Tab"&&(Pt.commitKey=3),Ht===-1)return;const{value:Vt}=Mt.target;Pt.lastCommittedValue!==Vt&&(Pt.lastCommittedValue=Vt,Pt.userValue=Vt,(Kt=this.linkService.eventBus)==null||Kt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:Vt,willCommit:!0,commitKey:Ht,selStart:Mt.target.selectionStart,selEnd:Mt.target.selectionEnd}}))});const Ft=qt;qt=null,T.addEventListener("blur",Mt=>{var Vt;if(!Pt.focused||!Mt.relatedTarget)return;Pt.focused=!1;const{value:Ht}=Mt.target;Pt.userValue=Ht,Pt.lastCommittedValue!==Ht&&((Vt=this.linkService.eventBus)==null||Vt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:Ht,willCommit:!0,commitKey:Pt.commitKey,selStart:Mt.target.selectionStart,selEnd:Mt.target.selectionEnd}})),Ft(Mt)}),(q=this.data.actions)!=null&&q.Keystroke&&T.addEventListener("beforeinput",Mt=>{var oe;Pt.lastCommittedValue=null;const{data:Ht,target:Vt}=Mt,{value:Kt,selectionStart:Zt,selectionEnd:se}=Vt;let ne=Zt,ie=se;switch(Mt.inputType){case"deleteWordBackward":{const le=Kt.substring(0,Zt).match(/\w*[^\w]*$/);le&&(ne-=le[0].length);break}case"deleteWordForward":{const le=Kt.substring(Zt).match(/^[^\w]*\w*/);le&&(ie+=le[0].length);break}case"deleteContentBackward":Zt===se&&(ne-=1);break;case"deleteContentForward":Zt===se&&(ie+=1);break}Mt.preventDefault(),(oe=this.linkService.eventBus)==null||oe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:Kt,change:Ht||"",willCommit:!1,selStart:ne,selEnd:ie}})}),this._setEventListeners(T,Pt,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Mt=>Mt.target.value)}if(qt&&T.addEventListener("blur",qt),this.data.comb){const Mt=(this.data.rect[2]-this.data.rect[0])/bt;T.classList.add("comb"),T.style.letterSpacing=`calc(${Mt}px * var(--scale-factor) - 1ch)`}}else T=document.createElement("div"),T.textContent=this.data.fieldValue,T.style.verticalAlign="middle",T.style.display="table-cell";return this._setTextStyle(T),this._setBackgroundColor(T),this._setDefaultPropertiesFromJS(T),this.container.append(T),this.container}}class w extends y{constructor(N){super(N,{isRenderable:!!N.data.hasOwnCanvas})}}class _ extends y{constructor(N){super(N,{isRenderable:N.renderForms})}render(){const N=this.annotationStorage,s=this.data,T=s.id;let B=N.getValue(T,{value:s.exportValue===s.fieldValue}).value;typeof B=="string"&&(B=B!=="Off",N.setValue(T,{value:B})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const q=document.createElement("input");return I.add(q),q.setAttribute("data-element-id",T),q.disabled=s.readOnly,this._setRequired(q,this.data.required),q.type="checkbox",q.name=s.fieldName,B&&q.setAttribute("checked",!0),q.setAttribute("exportValue",s.exportValue),q.tabIndex=S,q.addEventListener("change",K=>{const{name:lt,checked:bt}=K.target;for(const kt of this._getElementsByName(lt,T)){const Pt=bt&&kt.exportValue===s.exportValue;kt.domElement&&(kt.domElement.checked=Pt),N.setValue(kt.id,{value:Pt})}N.setValue(T,{value:bt})}),q.addEventListener("resetform",K=>{const lt=s.defaultFieldValue||"Off";K.target.checked=lt===s.exportValue}),this.enableScripting&&this.hasJSActions&&(q.addEventListener("updatefromsandbox",K=>{const lt={value(bt){bt.target.checked=bt.detail.value!=="Off",N.setValue(T,{value:bt.target.checked})}};this._dispatchEventFromSandbox(lt,K)}),this._setEventListeners(q,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],K=>K.target.checked)),this._setBackgroundColor(q),this._setDefaultPropertiesFromJS(q),this.container.append(q),this.container}}class a extends y{constructor(N){super(N,{isRenderable:N.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const N=this.annotationStorage,s=this.data,T=s.id;let B=N.getValue(T,{value:s.fieldValue===s.buttonValue}).value;typeof B=="string"&&(B=B!==s.buttonValue,N.setValue(T,{value:B}));const q=document.createElement("input");if(I.add(q),q.setAttribute("data-element-id",T),q.disabled=s.readOnly,this._setRequired(q,this.data.required),q.type="radio",q.name=s.fieldName,B&&q.setAttribute("checked",!0),q.tabIndex=S,q.addEventListener("change",K=>{const{name:lt,checked:bt}=K.target;for(const kt of this._getElementsByName(lt,T))N.setValue(kt.id,{value:!1});N.setValue(T,{value:bt})}),q.addEventListener("resetform",K=>{const lt=s.defaultFieldValue;K.target.checked=lt!=null&&lt===s.buttonValue}),this.enableScripting&&this.hasJSActions){const K=s.buttonValue;q.addEventListener("updatefromsandbox",lt=>{const bt={value:kt=>{const Pt=K===kt.detail.value;for(const qt of this._getElementsByName(kt.target.name)){const Ft=Pt&&qt.id===T;qt.domElement&&(qt.domElement.checked=Ft),N.setValue(qt.id,{value:Ft})}}};this._dispatchEventFromSandbox(bt,lt)}),this._setEventListeners(q,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],lt=>lt.target.checked)}return this._setBackgroundColor(q),this._setDefaultPropertiesFromJS(q),this.container.append(q),this.container}}class c extends x{constructor(N){super(N,{ignoreBorder:N.data.hasAppearance})}render(){const N=super.render();N.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(N.title=this.data.alternativeText);const s=N.lastChild;return this.enableScripting&&this.hasJSActions&&s&&(this._setDefaultPropertiesFromJS(s),s.addEventListener("updatefromsandbox",T=>{this._dispatchEventFromSandbox({},T)})),N}}class L extends y{constructor(N){super(N,{isRenderable:N.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const N=this.annotationStorage,s=this.data.id,T=N.getValue(s,{value:this.data.fieldValue}),B=document.createElement("select");I.add(B),B.setAttribute("data-element-id",s),B.disabled=this.data.readOnly,this._setRequired(B,this.data.required),B.name=this.data.fieldName,B.tabIndex=S;let q=this.data.combo&&this.data.options.length>0;this.data.combo||(B.size=this.data.options.length,this.data.multiSelect&&(B.multiple=!0)),B.addEventListener("resetform",Pt=>{const qt=this.data.defaultFieldValue;for(const Ft of B.options)Ft.selected=Ft.value===qt});for(const Pt of this.data.options){const qt=document.createElement("option");qt.textContent=Pt.displayValue,qt.value=Pt.exportValue,T.value.includes(Pt.exportValue)&&(qt.setAttribute("selected",!0),q=!1),B.append(qt)}let K=null;if(q){const Pt=document.createElement("option");Pt.value=" ",Pt.setAttribute("hidden",!0),Pt.setAttribute("selected",!0),B.prepend(Pt),K=()=>{Pt.remove(),B.removeEventListener("input",K),K=null},B.addEventListener("input",K)}const lt=Pt=>{const qt=Pt?"value":"textContent",{options:Ft,multiple:Mt}=B;return Mt?Array.prototype.filter.call(Ft,Ht=>Ht.selected).map(Ht=>Ht[qt]):Ft.selectedIndex===-1?null:Ft[Ft.selectedIndex][qt]};let bt=lt(!1);const kt=Pt=>{const qt=Pt.target.options;return Array.prototype.map.call(qt,Ft=>({displayValue:Ft.textContent,exportValue:Ft.value}))};return this.enableScripting&&this.hasJSActions?(B.addEventListener("updatefromsandbox",Pt=>{const qt={value(Ft){K==null||K();const Mt=Ft.detail.value,Ht=new Set(Array.isArray(Mt)?Mt:[Mt]);for(const Vt of B.options)Vt.selected=Ht.has(Vt.value);N.setValue(s,{value:lt(!0)}),bt=lt(!1)},multipleSelection(Ft){B.multiple=!0},remove(Ft){const Mt=B.options,Ht=Ft.detail.remove;Mt[Ht].selected=!1,B.remove(Ht),Mt.length>0&&Array.prototype.findIndex.call(Mt,Kt=>Kt.selected)===-1&&(Mt[0].selected=!0),N.setValue(s,{value:lt(!0),items:kt(Ft)}),bt=lt(!1)},clear(Ft){for(;B.length!==0;)B.remove(0);N.setValue(s,{value:null,items:[]}),bt=lt(!1)},insert(Ft){const{index:Mt,displayValue:Ht,exportValue:Vt}=Ft.detail.insert,Kt=B.children[Mt],Zt=document.createElement("option");Zt.textContent=Ht,Zt.value=Vt,Kt?Kt.before(Zt):B.append(Zt),N.setValue(s,{value:lt(!0),items:kt(Ft)}),bt=lt(!1)},items(Ft){const{items:Mt}=Ft.detail;for(;B.length!==0;)B.remove(0);for(const Ht of Mt){const{displayValue:Vt,exportValue:Kt}=Ht,Zt=document.createElement("option");Zt.textContent=Vt,Zt.value=Kt,B.append(Zt)}B.options.length>0&&(B.options[0].selected=!0),N.setValue(s,{value:lt(!0),items:kt(Ft)}),bt=lt(!1)},indices(Ft){const Mt=new Set(Ft.detail.indices);for(const Ht of Ft.target.options)Ht.selected=Mt.has(Ht.index);N.setValue(s,{value:lt(!0)}),bt=lt(!1)},editable(Ft){Ft.target.disabled=!Ft.detail.editable}};this._dispatchEventFromSandbox(qt,Pt)}),B.addEventListener("input",Pt=>{var Ft;const qt=lt(!0);N.setValue(s,{value:qt}),Pt.preventDefault(),(Ft=this.linkService.eventBus)==null||Ft.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:bt,changeEx:qt,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(B,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Pt=>Pt.target.value)):B.addEventListener("input",function(Pt){N.setValue(s,{value:lt(!0)})}),this.data.combo&&this._setTextStyle(B),this._setBackgroundColor(B),this._setDefaultPropertiesFromJS(B),this.container.append(B),this.container}}class A extends g{constructor(N){const{data:s,elements:T}=N;super(N,{isRenderable:g._hasPopupData(s)}),this.elements=T}render(){this.container.classList.add("popupAnnotation");const N=new l({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),s=[];for(const T of this.elements)T.popup=N,s.push(T.data.id),T.addHighlightArea();return this.container.setAttribute("aria-controls",s.map(T=>`${n.AnnotationPrefix}${T}`).join(",")),this.container}}class l{constructor({container:N,color:s,elements:T,titleObj:B,modificationDate:q,contentsObj:K,richText:lt,parent:bt,rect:kt,parentRect:Pt,open:qt}){U(this,Ut);U(this,Wt);U(this,Gt);U(this,Xt);U(this,H,null);U(this,nt,X(this,Ut,On).bind(this));U(this,J,X(this,Xt,ln).bind(this));U(this,ot,X(this,Gt,on).bind(this));U(this,ht,X(this,Wt,ke).bind(this));U(this,ft,null);U(this,dt,null);U(this,wt,null);U(this,Lt,null);U(this,vt,null);U(this,Dt,null);U(this,mt,!1);U(this,et,null);U(this,Q,null);U(this,pt,null);U(this,Tt,null);U(this,Ct,!1);var Mt;rt(this,dt,N),rt(this,Tt,B),rt(this,wt,K),rt(this,pt,lt),rt(this,vt,bt),rt(this,ft,s),rt(this,Q,kt),rt(this,Dt,Pt),rt(this,Lt,T);const Ft=d.PDFDateString.toDateObject(q);Ft&&rt(this,H,bt.l10n.get("annotation_date_string",{date:Ft.toLocaleDateString(),time:Ft.toLocaleTimeString()})),this.trigger=T.flatMap(Ht=>Ht.getElementsToTriggerPopup());for(const Ht of this.trigger)Ht.addEventListener("click",t(this,ht)),Ht.addEventListener("mouseenter",t(this,ot)),Ht.addEventListener("mouseleave",t(this,J)),Ht.classList.add("popupTriggerArea");for(const Ht of T)(Mt=Ht.container)==null||Mt.addEventListener("keydown",t(this,nt));t(this,dt).hidden=!0,qt&&X(this,Wt,ke).call(this)}render(){if(t(this,et))return;const{page:{view:N},viewport:{rawDims:{pageWidth:s,pageHeight:T,pageX:B,pageY:q}}}=t(this,vt),K=rt(this,et,document.createElement("div"));if(K.className="popup",t(this,ft)){const ne=K.style.outlineColor=n.Util.makeHexColor(...t(this,ft));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?K.style.backgroundColor=`color-mix(in srgb, ${ne} 30%, white)`:K.style.backgroundColor=n.Util.makeHexColor(...t(this,ft).map(oe=>Math.floor(.7*(255-oe)+oe)))}const lt=document.createElement("span");lt.className="header";const bt=document.createElement("h1");if(lt.append(bt),{dir:bt.dir,str:bt.textContent}=t(this,Tt),K.append(lt),t(this,H)){const ne=document.createElement("span");ne.classList.add("popupDate"),t(this,H).then(ie=>{ne.textContent=ie}),lt.append(ne)}const kt=t(this,wt),Pt=t(this,pt);if(Pt!=null&&Pt.str&&(!(kt!=null&&kt.str)||kt.str===Pt.str))k.XfaLayer.render({xfaHtml:Pt.html,intent:"richText",div:K}),K.lastChild.classList.add("richText","popupContent");else{const ne=this._formatContents(kt);K.append(ne)}let qt=!!t(this,Dt),Ft=qt?t(this,Dt):t(this,Q);for(const ne of t(this,Lt))if(!Ft||n.Util.intersect(ne.data.rect,Ft)!==null){Ft=ne.data.rect,qt=!0;break}const Mt=n.Util.normalizeRect([Ft[0],N[3]-Ft[1]+N[1],Ft[2],N[3]-Ft[3]+N[1]]),Vt=qt?Ft[2]-Ft[0]+5:0,Kt=Mt[0]+Vt,Zt=Mt[1],{style:se}=t(this,dt);se.left=`${100*(Kt-B)/s}%`,se.top=`${100*(Zt-q)/T}%`,t(this,dt).append(K)}_formatContents({str:N,dir:s}){const T=document.createElement("p");T.classList.add("popupContent"),T.dir=s;const B=N.split(/(?:\r\n?|\n)/);for(let q=0,K=B.length;q<K;++q){const lt=B[q];T.append(document.createTextNode(lt)),q<K-1&&T.append(document.createElement("br"))}return T}forceHide(){rt(this,Ct,this.isVisible),t(this,Ct)&&(t(this,dt).hidden=!0)}maybeShow(){t(this,Ct)&&(rt(this,Ct,!1),t(this,dt).hidden=!1)}get isVisible(){return t(this,dt).hidden===!1}}H=new WeakMap,nt=new WeakMap,J=new WeakMap,ot=new WeakMap,ht=new WeakMap,ft=new WeakMap,dt=new WeakMap,wt=new WeakMap,Lt=new WeakMap,vt=new WeakMap,Dt=new WeakMap,mt=new WeakMap,et=new WeakMap,Q=new WeakMap,pt=new WeakMap,Tt=new WeakMap,Ct=new WeakMap,Ut=new WeakSet,On=function(N){N.altKey||N.shiftKey||N.ctrlKey||N.metaKey||(N.key==="Enter"||N.key==="Escape"&&t(this,mt))&&X(this,Wt,ke).call(this)},Wt=new WeakSet,ke=function(){rt(this,mt,!t(this,mt)),t(this,mt)?(X(this,Gt,on).call(this),t(this,dt).addEventListener("click",t(this,ht)),t(this,dt).addEventListener("keydown",t(this,nt))):(X(this,Xt,ln).call(this),t(this,dt).removeEventListener("click",t(this,ht)),t(this,dt).removeEventListener("keydown",t(this,nt)))},Gt=new WeakSet,on=function(){t(this,et)||this.render(),this.isVisible?t(this,mt)&&t(this,dt).classList.add("focused"):(t(this,dt).hidden=!1,t(this,dt).style.zIndex=parseInt(t(this,dt).style.zIndex)+1e3)},Xt=new WeakSet,ln=function(){t(this,dt).classList.remove("focused"),!(t(this,mt)||!this.isVisible)&&(t(this,dt).hidden=!0,t(this,dt).style.zIndex=parseInt(t(this,dt).style.zIndex)-1e3)};class F extends g{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0}),this.textContent=N.data.textContent,this.textPosition=N.data.textPosition,this.annotationEditorType=n.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const N=document.createElement("div");N.classList.add("annotationTextContent"),N.setAttribute("role","comment");for(const s of this.textContent){const T=document.createElement("span");T.textContent=s,N.append(T)}this.container.append(N)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}e.FreeTextAnnotationElement=F;class m extends g{constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0});U(this,tt,null)}render(){this.container.classList.add("lineAnnotation");const s=this.data,{width:T,height:B}=D(s.rect),q=this.svgFactory.create(T,B,!0),K=rt(this,tt,this.svgFactory.createElement("svg:line"));return K.setAttribute("x1",s.rect[2]-s.lineCoordinates[0]),K.setAttribute("y1",s.rect[3]-s.lineCoordinates[1]),K.setAttribute("x2",s.rect[2]-s.lineCoordinates[2]),K.setAttribute("y2",s.rect[3]-s.lineCoordinates[3]),K.setAttribute("stroke-width",s.borderStyle.width||1),K.setAttribute("stroke","transparent"),K.setAttribute("fill","transparent"),q.append(K),this.container.append(q),!s.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,tt)}addHighlightArea(){this.container.classList.add("highlightArea")}}tt=new WeakMap;class $ extends g{constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0});U(this,Y,null)}render(){this.container.classList.add("squareAnnotation");const s=this.data,{width:T,height:B}=D(s.rect),q=this.svgFactory.create(T,B,!0),K=s.borderStyle.width,lt=rt(this,Y,this.svgFactory.createElement("svg:rect"));return lt.setAttribute("x",K/2),lt.setAttribute("y",K/2),lt.setAttribute("width",T-K),lt.setAttribute("height",B-K),lt.setAttribute("stroke-width",K||1),lt.setAttribute("stroke","transparent"),lt.setAttribute("fill","transparent"),q.append(lt),this.container.append(q),!s.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,Y)}addHighlightArea(){this.container.classList.add("highlightArea")}}Y=new WeakMap;class z extends g{constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0});U(this,yt,null)}render(){this.container.classList.add("circleAnnotation");const s=this.data,{width:T,height:B}=D(s.rect),q=this.svgFactory.create(T,B,!0),K=s.borderStyle.width,lt=rt(this,yt,this.svgFactory.createElement("svg:ellipse"));return lt.setAttribute("cx",T/2),lt.setAttribute("cy",B/2),lt.setAttribute("rx",T/2-K/2),lt.setAttribute("ry",B/2-K/2),lt.setAttribute("stroke-width",K||1),lt.setAttribute("stroke","transparent"),lt.setAttribute("fill","transparent"),q.append(lt),this.container.append(q),!s.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,yt)}addHighlightArea(){this.container.classList.add("highlightArea")}}yt=new WeakMap;class R extends g{constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0});U(this,At,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const s=this.data,{width:T,height:B}=D(s.rect),q=this.svgFactory.create(T,B,!0);let K=[];for(const bt of s.vertices){const kt=bt.x-s.rect[0],Pt=s.rect[3]-bt.y;K.push(kt+","+Pt)}K=K.join(" ");const lt=rt(this,At,this.svgFactory.createElement(this.svgElementName));return lt.setAttribute("points",K),lt.setAttribute("stroke-width",s.borderStyle.width||1),lt.setAttribute("stroke","transparent"),lt.setAttribute("fill","transparent"),q.append(lt),this.container.append(q),!s.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,At)}addHighlightArea(){this.container.classList.add("highlightArea")}}At=new WeakMap;class V extends R{constructor(N){super(N),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class st extends g{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class at extends g{constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0});U(this,te,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=n.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const s=this.data,{width:T,height:B}=D(s.rect),q=this.svgFactory.create(T,B,!0);for(const K of s.inkLists){let lt=[];for(const kt of K){const Pt=kt.x-s.rect[0],qt=s.rect[3]-kt.y;lt.push(`${Pt},${qt}`)}lt=lt.join(" ");const bt=this.svgFactory.createElement(this.svgElementName);t(this,te).push(bt),bt.setAttribute("points",lt),bt.setAttribute("stroke-width",s.borderStyle.width||1),bt.setAttribute("stroke","transparent"),bt.setAttribute("fill","transparent"),!s.popupRef&&this.hasPopupData&&this._createPopup(),q.append(bt)}return this.container.append(q),this.container}getElementsToTriggerPopup(){return t(this,te)}addHighlightArea(){this.container.classList.add("highlightArea")}}te=new WeakMap,e.InkAnnotationElement=at;class G extends g{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class ct extends g{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class gt extends g{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class xt extends g{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class Et extends g{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}e.StampAnnotationElement=Et;class M extends g{constructor(s){var q;super(s,{isRenderable:!0});U(this,Z);U(this,Qt,null);const{filename:T,content:B}=this.data.file;this.filename=(0,d.getFilenameFromUrl)(T,!0),this.content=B,(q=this.linkService.eventBus)==null||q.dispatch("fileattachmentannotation",{source:this,filename:T,content:B})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:s,data:T}=this;let B;T.hasAppearance||T.fillAlpha===0?B=document.createElement("div"):(B=document.createElement("img"),B.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(T.name)?"paperclip":"pushpin"}.svg`,T.fillAlpha&&T.fillAlpha<1&&(B.style=`filter: opacity(${Math.round(T.fillAlpha*100)}%);`)),B.addEventListener("dblclick",X(this,Z,cn).bind(this)),rt(this,Qt,B);const{isMac:q}=n.FeatureTest.platform;return s.addEventListener("keydown",K=>{K.key==="Enter"&&(q?K.metaKey:K.ctrlKey)&&X(this,Z,cn).call(this)}),!T.popupRef&&this.hasPopupData?this._createPopup():B.classList.add("popupTriggerArea"),s.append(B),s}getElementsToTriggerPopup(){return t(this,Qt)}addHighlightArea(){this.container.classList.add("highlightArea")}}Qt=new WeakMap,Z=new WeakSet,cn=function(){var s;(s=this.downloadManager)==null||s.openOrDownloadData(this.container,this.content,this.filename)};class i{constructor({div:N,accessibilityManager:s,annotationCanvasMap:T,l10n:B,page:q,viewport:K}){U(this,Nt);U(this,_t);U(this,Ot,null);U(this,Rt,null);U(this,jt,new Map);this.div=N,rt(this,Ot,s),rt(this,Rt,T),this.l10n=B,this.page=q,this.viewport=K,this.zIndex=0,this.l10n||(this.l10n=it.NullL10n)}async render(N){const{annotations:s}=N,T=this.div;(0,d.setLayerDimensions)(T,this.viewport);const B=new Map,q={data:null,layer:T,linkService:N.linkService,downloadManager:N.downloadManager,imageResourcesPath:N.imageResourcesPath||"",renderForms:N.renderForms!==!1,svgFactory:new d.DOMSVGFactory,annotationStorage:N.annotationStorage||new W.AnnotationStorage,enableScripting:N.enableScripting===!0,hasJSActions:N.hasJSActions,fieldObjects:N.fieldObjects,parent:this,elements:null};for(const K of s){if(K.noHTML)continue;const lt=K.annotationType===n.AnnotationType.POPUP;if(lt){const Pt=B.get(K.id);if(!Pt)continue;q.elements=Pt}else{const{width:Pt,height:qt}=D(K.rect);if(Pt<=0||qt<=0)continue}q.data=K;const bt=E.create(q);if(!bt.isRenderable)continue;if(!lt&&K.popupRef){const Pt=B.get(K.popupRef);Pt?Pt.push(bt):B.set(K.popupRef,[bt])}bt.annotationEditorType>0&&t(this,jt).set(bt.data.id,bt);const kt=bt.render();K.hidden&&(kt.style.visibility="hidden"),X(this,Nt,jn).call(this,kt,K.id)}X(this,_t,hn).call(this),await this.l10n.translate(T)}update({viewport:N}){const s=this.div;this.viewport=N,(0,d.setLayerDimensions)(s,{rotation:N.rotation}),X(this,_t,hn).call(this),s.hidden=!1}getEditableAnnotations(){return Array.from(t(this,jt).values())}getEditableAnnotation(N){return t(this,jt).get(N)}}Ot=new WeakMap,Rt=new WeakMap,jt=new WeakMap,Nt=new WeakSet,jn=function(N,s){var B;const T=N.firstChild||N;T.id=`${n.AnnotationPrefix}${s}`,this.div.append(N),(B=t(this,Ot))==null||B.moveElementInDOM(this.div,N,T,!1)},_t=new WeakSet,hn=function(){if(!t(this,Rt))return;const N=this.div;for(const[s,T]of t(this,Rt)){const B=N.querySelector(`[data-annotation-id="${s}"]`);if(!B)continue;const{firstChild:q}=B;q?q.nodeName==="CANVAS"?q.replaceWith(T):q.before(T):B.append(T)}t(this,Rt).clear()},e.AnnotationLayer=i},(b,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorConverters=void 0;function v(W){return Math.floor(Math.max(0,Math.min(1,W))*255).toString(16).padStart(2,"0")}function n(W){return Math.max(0,Math.min(255,255*W))}class d{static CMYK_G([j,it,k,S]){return["G",1-Math.min(1,.3*j+.59*k+.11*it+S)]}static G_CMYK([j]){return["CMYK",0,0,0,1-j]}static G_RGB([j]){return["RGB",j,j,j]}static G_rgb([j]){return j=n(j),[j,j,j]}static G_HTML([j]){const it=v(j);return`#${it}${it}${it}`}static RGB_G([j,it,k]){return["G",.3*j+.59*it+.11*k]}static RGB_rgb(j){return j.map(n)}static RGB_HTML(j){return`#${j.map(v).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([j,it,k,S]){return["RGB",1-Math.min(1,j+S),1-Math.min(1,k+S),1-Math.min(1,it+S)]}static CMYK_rgb([j,it,k,S]){return[n(1-Math.min(1,j+S)),n(1-Math.min(1,k+S)),n(1-Math.min(1,it+S))]}static CMYK_HTML(j){const it=this.CMYK_RGB(j).slice(1);return this.RGB_HTML(it)}static RGB_CMYK([j,it,k]){const S=1-j,f=1-it,I=1-k,D=Math.min(S,f,I);return["CMYK",S,f,I,D]}}e.ColorConverters=d},(b,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NullL10n=void 0,e.getL10nFallback=n;const v={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};v.print_progress_percent="{{progress}}%";function n(j,it){switch(j){case"find_match_count":j=`find_match_count[${it.total===1?"one":"other"}]`;break;case"find_match_count_limit":j=`find_match_count_limit[${it.limit===1?"one":"other"}]`;break}return v[j]||""}function d(j,it){return it?j.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(k,S)=>S in it?it[S]:"{{"+S+"}}"):j}const W={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(j,it=null,k=n(j,it)){return d(k,it)},async translate(j){}};e.NullL10n=W},(b,e,v)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaLayer=void 0;var n=v(25);class d{static setupStorage(j,it,k,S,f){const I=S.getValue(it,{value:null});switch(k.name){case"textarea":if(I.value!==null&&(j.textContent=I.value),f==="print")break;j.addEventListener("input",D=>{S.setValue(it,{value:D.target.value})});break;case"input":if(k.attributes.type==="radio"||k.attributes.type==="checkbox"){if(I.value===k.attributes.xfaOn?j.setAttribute("checked",!0):I.value===k.attributes.xfaOff&&j.removeAttribute("checked"),f==="print")break;j.addEventListener("change",D=>{S.setValue(it,{value:D.target.checked?D.target.getAttribute("xfaOn"):D.target.getAttribute("xfaOff")})})}else{if(I.value!==null&&j.setAttribute("value",I.value),f==="print")break;j.addEventListener("input",D=>{S.setValue(it,{value:D.target.value})})}break;case"select":if(I.value!==null){j.setAttribute("value",I.value);for(const D of k.children)D.attributes.value===I.value?D.attributes.selected=!0:D.attributes.hasOwnProperty("selected")&&delete D.attributes.selected}j.addEventListener("input",D=>{const E=D.target.options,g=E.selectedIndex===-1?"":E[E.selectedIndex].value;S.setValue(it,{value:g})});break}}static setAttributes({html:j,element:it,storage:k=null,intent:S,linkService:f}){const{attributes:I}=it,D=j instanceof HTMLAnchorElement;I.type==="radio"&&(I.name=`${I.name}-${S}`);for(const[E,g]of Object.entries(I))if(g!=null)switch(E){case"class":g.length&&j.setAttribute(E,g.join(" "));break;case"dataId":break;case"id":j.setAttribute("data-element-id",g);break;case"style":Object.assign(j.style,g);break;case"textContent":j.textContent=g;break;default:(!D||E!=="href"&&E!=="newWindow")&&j.setAttribute(E,g)}D&&f.addLinkAttributes(j,I.href,I.newWindow),k&&I.dataId&&this.setupStorage(j,I.dataId,it,k)}static render(j){var x;const it=j.annotationStorage,k=j.linkService,S=j.xfaHtml,f=j.intent||"display",I=document.createElement(S.name);S.attributes&&this.setAttributes({html:I,element:S,intent:f,linkService:k});const D=[[S,-1,I]],E=j.div;if(E.append(I),j.viewport){const u=`matrix(${j.viewport.transform.join(",")})`;E.style.transform=u}f!=="richText"&&E.setAttribute("class","xfaLayer xfaFont");const g=[];for(;D.length>0;){const[u,y,C]=D.at(-1);if(y+1===u.children.length){D.pop();continue}const w=u.children[++D.at(-1)[1]];if(w===null)continue;const{name:_}=w;if(_==="#text"){const c=document.createTextNode(w.value);g.push(c),C.append(c);continue}const a=(x=w==null?void 0:w.attributes)!=null&&x.xmlns?document.createElementNS(w.attributes.xmlns,_):document.createElement(_);if(C.append(a),w.attributes&&this.setAttributes({html:a,element:w,storage:it,intent:f,linkService:k}),w.children&&w.children.length>0)D.push([w,-1,a]);else if(w.value){const c=document.createTextNode(w.value);n.XfaText.shouldBuildText(_)&&g.push(c),a.append(c)}}for(const u of E.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))u.setAttribute("readOnly",!0);return{textDivs:g}}static update(j){const it=`matrix(${j.viewport.transform.join(",")})`;j.div.style.transform=it,j.div.hidden=!1}}e.XfaLayer=d},(b,e,v)=>{var S,f,I,D,E,g,x,u,y,C,w,_,a,c,L,Nn,l,Bn,m,Un,z,Wn,V,dn,at,$n,ct,un,xt,Hn,M,zn,o,Gn,h,qn,P,Vn,H,ae,J,pn,ht,Fe,dt,Me,Lt,pe,Dt,fn,et,De,pt,Xn,Ct,gn,zt,Yn,$t,Kn,Bt,mn,ut,Le,Y,fe;Object.defineProperty(e,"__esModule",{value:!0}),e.InkEditor=void 0;var n=v(1),d=v(4),W=v(29),j=v(6),it=v(5);const At=class At extends d.AnnotationEditor{constructor(Z){super({...Z,name:"inkEditor"});U(this,L);U(this,l);U(this,m);U(this,z);U(this,V);U(this,at);U(this,ct);U(this,xt);U(this,M);U(this,o);U(this,h);U(this,P);U(this,H);U(this,J);U(this,ht);U(this,dt);U(this,Lt);U(this,Dt);U(this,et);U(this,$t);U(this,Bt);U(this,ut);U(this,Y);U(this,S,0);U(this,f,0);U(this,I,this.canvasPointermove.bind(this));U(this,D,this.canvasPointerleave.bind(this));U(this,E,this.canvasPointerup.bind(this));U(this,g,this.canvasPointerdown.bind(this));U(this,x,new Path2D);U(this,u,!1);U(this,y,!1);U(this,C,!1);U(this,w,null);U(this,_,0);U(this,a,0);U(this,c,null);this.color=Z.color||null,this.thickness=Z.thickness||null,this.opacity=Z.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(Z){d.AnnotationEditor.initialize(Z,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(Z,St){switch(Z){case n.AnnotationEditorParamsType.INK_THICKNESS:At._defaultThickness=St;break;case n.AnnotationEditorParamsType.INK_COLOR:At._defaultColor=St;break;case n.AnnotationEditorParamsType.INK_OPACITY:At._defaultOpacity=St/100;break}}updateParams(Z,St){switch(Z){case n.AnnotationEditorParamsType.INK_THICKNESS:X(this,L,Nn).call(this,St);break;case n.AnnotationEditorParamsType.INK_COLOR:X(this,l,Bn).call(this,St);break;case n.AnnotationEditorParamsType.INK_OPACITY:X(this,m,Un).call(this,St);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,At._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,At._defaultColor||d.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(At._defaultOpacity*100)]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||At._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,this.color||At._defaultColor||d.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??At._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(X(this,ht,Fe).call(this),X(this,dt,Me).call(this)),this.isAttachedToDOM||(this.parent.add(this),X(this,Lt,pe).call(this)),X(this,Y,fe).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,t(this,w).disconnect(),rt(this,w,null),super.remove())}setParent(Z){!this.parent&&Z?this._uiManager.removeShouldRescale(this):this.parent&&Z===null&&this._uiManager.addShouldRescale(this),super.setParent(Z)}onScaleChanging(){const[Z,St]=this.parentDimensions,Ot=this.width*Z,Rt=this.height*St;this.setDimensions(Ot,Rt)}enableEditMode(){t(this,u)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",t(this,g)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",t(this,g)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){t(this,u)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),rt(this,u,!0),this.div.classList.add("disabled"),X(this,Y,fe).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(Z){this._focusEventsAllowed&&(super.focusin(Z),this.enableEditMode())}canvasPointerdown(Z){Z.button!==0||!this.isInEditMode()||t(this,u)||(this.setInForeground(),Z.preventDefault(),Z.type!=="mouse"&&this.div.focus(),X(this,at,$n).call(this,Z.offsetX,Z.offsetY))}canvasPointermove(Z){Z.preventDefault(),X(this,ct,un).call(this,Z.offsetX,Z.offsetY)}canvasPointerup(Z){Z.preventDefault(),X(this,J,pn).call(this,Z)}canvasPointerleave(Z){X(this,J,pn).call(this,Z)}get isResizable(){return!this.isEmpty()&&t(this,u)}render(){if(this.div)return this.div;let Z,St;this.width&&(Z=this.x,St=this.y),super.render(),d.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(Jt=>{var _t;return(_t=this.div)==null?void 0:_t.setAttribute("aria-label",Jt)});const[Ot,Rt,jt,Nt]=X(this,z,Wn).call(this);if(this.setAt(Ot,Rt,0,0),this.setDims(jt,Nt),X(this,ht,Fe).call(this),this.width){const[Jt,_t]=this.parentDimensions;this.setAspectRatio(this.width*Jt,this.height*_t),this.setAt(Z*Jt,St*_t,this.width*Jt,this.height*_t),rt(this,C,!0),X(this,Lt,pe).call(this),this.setDims(this.width*Jt,this.height*_t),X(this,H,ae).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return X(this,dt,Me).call(this),this.div}setDimensions(Z,St){const Ot=Math.round(Z),Rt=Math.round(St);if(t(this,_)===Ot&&t(this,a)===Rt)return;rt(this,_,Ot),rt(this,a,Rt),this.canvas.style.visibility="hidden";const[jt,Nt]=this.parentDimensions;this.width=Z/jt,this.height=St/Nt,this.fixAndSetPosition(),t(this,u)&&X(this,Dt,fn).call(this,Z,St),X(this,Lt,pe).call(this),X(this,H,ae).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(Z,St,Ot){var q,K,lt;if(Z instanceof W.InkAnnotationElement)return null;const Rt=super.deserialize(Z,St,Ot);Rt.thickness=Z.thickness,Rt.color=n.Util.makeHexColor(...Z.color),Rt.opacity=Z.opacity;const[jt,Nt]=Rt.pageDimensions,Jt=Rt.width*jt,_t=Rt.height*Nt,Yt=Rt.parentScale,It=Z.thickness/2;rt(Rt,u,!0),rt(Rt,_,Math.round(Jt)),rt(Rt,a,Math.round(_t));const{paths:N,rect:s,rotation:T}=Z;for(let{bezier:bt}of N){bt=X(q=At,zt,Yn).call(q,bt,s,T);const kt=[];Rt.paths.push(kt);let Pt=Yt*(bt[0]-It),qt=Yt*(bt[1]-It);for(let Mt=2,Ht=bt.length;Mt<Ht;Mt+=6){const Vt=Yt*(bt[Mt]-It),Kt=Yt*(bt[Mt+1]-It),Zt=Yt*(bt[Mt+2]-It),se=Yt*(bt[Mt+3]-It),ne=Yt*(bt[Mt+4]-It),ie=Yt*(bt[Mt+5]-It);kt.push([[Pt,qt],[Vt,Kt],[Zt,se],[ne,ie]]),Pt=ne,qt=ie}const Ft=X(this,pt,Xn).call(this,kt);Rt.bezierPath2D.push(Ft)}const B=X(K=Rt,Bt,mn).call(K);return rt(Rt,f,Math.max(d.AnnotationEditor.MIN_SIZE,B[2]-B[0])),rt(Rt,S,Math.max(d.AnnotationEditor.MIN_SIZE,B[3]-B[1])),X(lt=Rt,Dt,fn).call(lt,Jt,_t),Rt}serialize(){if(this.isEmpty())return null;const Z=this.getRect(0,0),St=d.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:n.AnnotationEditorType.INK,color:St,thickness:this.thickness,opacity:this.opacity,paths:X(this,$t,Kn).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,Z),pageIndex:this.pageIndex,rect:Z,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};S=new WeakMap,f=new WeakMap,I=new WeakMap,D=new WeakMap,E=new WeakMap,g=new WeakMap,x=new WeakMap,u=new WeakMap,y=new WeakMap,C=new WeakMap,w=new WeakMap,_=new WeakMap,a=new WeakMap,c=new WeakMap,L=new WeakSet,Nn=function(Z){const St=this.thickness;this.addCommands({cmd:()=>{this.thickness=Z,X(this,Y,fe).call(this)},undo:()=>{this.thickness=St,X(this,Y,fe).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},l=new WeakSet,Bn=function(Z){const St=this.color;this.addCommands({cmd:()=>{this.color=Z,X(this,H,ae).call(this)},undo:()=>{this.color=St,X(this,H,ae).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},m=new WeakSet,Un=function(Z){Z/=100;const St=this.opacity;this.addCommands({cmd:()=>{this.opacity=Z,X(this,H,ae).call(this)},undo:()=>{this.opacity=St,X(this,H,ae).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},z=new WeakSet,Wn=function(){const{parentRotation:Z,parentDimensions:[St,Ot]}=this;switch(Z){case 90:return[0,Ot,Ot,St];case 180:return[St,Ot,St,Ot];case 270:return[St,0,Ot,St];default:return[0,0,St,Ot]}},V=new WeakSet,dn=function(){const{ctx:Z,color:St,opacity:Ot,thickness:Rt,parentScale:jt,scaleFactor:Nt}=this;Z.lineWidth=Rt*jt/Nt,Z.lineCap="round",Z.lineJoin="round",Z.miterLimit=10,Z.strokeStyle=`${St}${(0,it.opacityToHex)(Ot)}`},at=new WeakSet,$n=function(Z,St){this.canvas.addEventListener("contextmenu",j.noContextMenu),this.canvas.addEventListener("pointerleave",t(this,D)),this.canvas.addEventListener("pointermove",t(this,I)),this.canvas.addEventListener("pointerup",t(this,E)),this.canvas.removeEventListener("pointerdown",t(this,g)),this.isEditing=!0,t(this,C)||(rt(this,C,!0),X(this,Lt,pe).call(this),this.thickness||(this.thickness=At._defaultThickness),this.color||(this.color=At._defaultColor||d.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=At._defaultOpacity)),this.currentPath.push([Z,St]),rt(this,y,!1),X(this,V,dn).call(this),rt(this,c,()=>{X(this,o,Gn).call(this),t(this,c)&&window.requestAnimationFrame(t(this,c))}),window.requestAnimationFrame(t(this,c))},ct=new WeakSet,un=function(Z,St){const[Ot,Rt]=this.currentPath.at(-1);if(this.currentPath.length>1&&Z===Ot&&St===Rt)return;const jt=this.currentPath;let Nt=t(this,x);if(jt.push([Z,St]),rt(this,y,!0),jt.length<=2){Nt.moveTo(...jt[0]),Nt.lineTo(Z,St);return}jt.length===3&&(rt(this,x,Nt=new Path2D),Nt.moveTo(...jt[0])),X(this,h,qn).call(this,Nt,...jt.at(-3),...jt.at(-2),Z,St)},xt=new WeakSet,Hn=function(){if(this.currentPath.length===0)return;const Z=this.currentPath.at(-1);t(this,x).lineTo(...Z)},M=new WeakSet,zn=function(Z,St){rt(this,c,null),Z=Math.min(Math.max(Z,0),this.canvas.width),St=Math.min(Math.max(St,0),this.canvas.height),X(this,ct,un).call(this,Z,St),X(this,xt,Hn).call(this);let Ot;if(this.currentPath.length!==1)Ot=X(this,P,Vn).call(this);else{const _t=[Z,St];Ot=[[_t,_t.slice(),_t.slice(),_t]]}const Rt=t(this,x),jt=this.currentPath;this.currentPath=[],rt(this,x,new Path2D);const Nt=()=>{this.allRawPaths.push(jt),this.paths.push(Ot),this.bezierPath2D.push(Rt),this.rebuild()},Jt=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(X(this,ht,Fe).call(this),X(this,dt,Me).call(this)),X(this,Y,fe).call(this))};this.addCommands({cmd:Nt,undo:Jt,mustExec:!0})},o=new WeakSet,Gn=function(){if(!t(this,y))return;rt(this,y,!1);const Z=Math.ceil(this.thickness*this.parentScale),St=this.currentPath.slice(-3),Ot=St.map(Nt=>Nt[0]),Rt=St.map(Nt=>Nt[1]);Math.min(...Ot)-Z,Math.max(...Ot)+Z,Math.min(...Rt)-Z,Math.max(...Rt)+Z;const{ctx:jt}=this;jt.save(),jt.clearRect(0,0,this.canvas.width,this.canvas.height);for(const Nt of this.bezierPath2D)jt.stroke(Nt);jt.stroke(t(this,x)),jt.restore()},h=new WeakSet,qn=function(Z,St,Ot,Rt,jt,Nt,Jt){const _t=(St+Rt)/2,Yt=(Ot+jt)/2,It=(Rt+Nt)/2,N=(jt+Jt)/2;Z.bezierCurveTo(_t+2*(Rt-_t)/3,Yt+2*(jt-Yt)/3,It+2*(Rt-It)/3,N+2*(jt-N)/3,It,N)},P=new WeakSet,Vn=function(){const Z=this.currentPath;if(Z.length<=2)return[[Z[0],Z[0],Z.at(-1),Z.at(-1)]];const St=[];let Ot,[Rt,jt]=Z[0];for(Ot=1;Ot<Z.length-2;Ot++){const[s,T]=Z[Ot],[B,q]=Z[Ot+1],K=(s+B)/2,lt=(T+q)/2,bt=[Rt+2*(s-Rt)/3,jt+2*(T-jt)/3],kt=[K+2*(s-K)/3,lt+2*(T-lt)/3];St.push([[Rt,jt],bt,kt,[K,lt]]),[Rt,jt]=[K,lt]}const[Nt,Jt]=Z[Ot],[_t,Yt]=Z[Ot+1],It=[Rt+2*(Nt-Rt)/3,jt+2*(Jt-jt)/3],N=[_t+2*(Nt-_t)/3,Yt+2*(Jt-Yt)/3];return St.push([[Rt,jt],It,N,[_t,Yt]]),St},H=new WeakSet,ae=function(){if(this.isEmpty()){X(this,et,De).call(this);return}X(this,V,dn).call(this);const{canvas:Z,ctx:St}=this;St.setTransform(1,0,0,1,0,0),St.clearRect(0,0,Z.width,Z.height),X(this,et,De).call(this);for(const Ot of this.bezierPath2D)St.stroke(Ot)},J=new WeakSet,pn=function(Z){this.canvas.removeEventListener("pointerleave",t(this,D)),this.canvas.removeEventListener("pointermove",t(this,I)),this.canvas.removeEventListener("pointerup",t(this,E)),this.canvas.addEventListener("pointerdown",t(this,g)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",j.noContextMenu)},10),X(this,M,zn).call(this,Z.offsetX,Z.offsetY),this.addToAnnotationStorage(),this.setInBackground()},ht=new WeakSet,Fe=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",d.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(Z=>{var St;return(St=this.canvas)==null?void 0:St.setAttribute("aria-label",Z)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},dt=new WeakSet,Me=function(){rt(this,w,new ResizeObserver(Z=>{const St=Z[0].contentRect;St.width&&St.height&&this.setDimensions(St.width,St.height)})),t(this,w).observe(this.div)},Lt=new WeakSet,pe=function(){if(!t(this,C))return;const[Z,St]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*Z),this.canvas.height=Math.ceil(this.height*St),X(this,et,De).call(this)},Dt=new WeakSet,fn=function(Z,St){const Ot=X(this,ut,Le).call(this),Rt=(Z-Ot)/t(this,f),jt=(St-Ot)/t(this,S);this.scaleFactor=Math.min(Rt,jt)},et=new WeakSet,De=function(){const Z=X(this,ut,Le).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+Z,this.translationY*this.scaleFactor+Z)},pt=new WeakSet,Xn=function(Z){const St=new Path2D;for(let Ot=0,Rt=Z.length;Ot<Rt;Ot++){const[jt,Nt,Jt,_t]=Z[Ot];Ot===0&&St.moveTo(...jt),St.bezierCurveTo(Nt[0],Nt[1],Jt[0],Jt[1],_t[0],_t[1])}return St},Ct=new WeakSet,gn=function(Z,St,Ot){const[Rt,jt,Nt,Jt]=St;switch(Ot){case 0:for(let _t=0,Yt=Z.length;_t<Yt;_t+=2)Z[_t]+=Rt,Z[_t+1]=Jt-Z[_t+1];break;case 90:for(let _t=0,Yt=Z.length;_t<Yt;_t+=2){const It=Z[_t];Z[_t]=Z[_t+1]+Rt,Z[_t+1]=It+jt}break;case 180:for(let _t=0,Yt=Z.length;_t<Yt;_t+=2)Z[_t]=Nt-Z[_t],Z[_t+1]+=jt;break;case 270:for(let _t=0,Yt=Z.length;_t<Yt;_t+=2){const It=Z[_t];Z[_t]=Nt-Z[_t+1],Z[_t+1]=Jt-It}break;default:throw new Error("Invalid rotation")}return Z},zt=new WeakSet,Yn=function(Z,St,Ot){const[Rt,jt,Nt,Jt]=St;switch(Ot){case 0:for(let _t=0,Yt=Z.length;_t<Yt;_t+=2)Z[_t]-=Rt,Z[_t+1]=Jt-Z[_t+1];break;case 90:for(let _t=0,Yt=Z.length;_t<Yt;_t+=2){const It=Z[_t];Z[_t]=Z[_t+1]-jt,Z[_t+1]=It-Rt}break;case 180:for(let _t=0,Yt=Z.length;_t<Yt;_t+=2)Z[_t]=Nt-Z[_t],Z[_t+1]-=jt;break;case 270:for(let _t=0,Yt=Z.length;_t<Yt;_t+=2){const It=Z[_t];Z[_t]=Jt-Z[_t+1],Z[_t+1]=Nt-It}break;default:throw new Error("Invalid rotation")}return Z},$t=new WeakSet,Kn=function(Z,St,Ot,Rt){var Yt,It;const jt=[],Nt=this.thickness/2,Jt=Z*St+Nt,_t=Z*Ot+Nt;for(const N of this.paths){const s=[],T=[];for(let B=0,q=N.length;B<q;B++){const[K,lt,bt,kt]=N[B],Pt=Z*K[0]+Jt,qt=Z*K[1]+_t,Ft=Z*lt[0]+Jt,Mt=Z*lt[1]+_t,Ht=Z*bt[0]+Jt,Vt=Z*bt[1]+_t,Kt=Z*kt[0]+Jt,Zt=Z*kt[1]+_t;B===0&&(s.push(Pt,qt),T.push(Pt,qt)),s.push(Ft,Mt,Ht,Vt,Kt,Zt),T.push(Ft,Mt),B===q-1&&T.push(Kt,Zt)}jt.push({bezier:X(Yt=At,Ct,gn).call(Yt,s,Rt,this.rotation),points:X(It=At,Ct,gn).call(It,T,Rt,this.rotation)})}return jt},Bt=new WeakSet,mn=function(){let Z=1/0,St=-1/0,Ot=1/0,Rt=-1/0;for(const jt of this.paths)for(const[Nt,Jt,_t,Yt]of jt){const It=n.Util.bezierBoundingBox(...Nt,...Jt,..._t,...Yt);Z=Math.min(Z,It[0]),Ot=Math.min(Ot,It[1]),St=Math.max(St,It[2]),Rt=Math.max(Rt,It[3])}return[Z,Ot,St,Rt]},ut=new WeakSet,Le=function(){return t(this,u)?Math.ceil(this.thickness*this.parentScale):0},Y=new WeakSet,fe=function(Z=!1){if(this.isEmpty())return;if(!t(this,u)){X(this,H,ae).call(this);return}const St=X(this,Bt,mn).call(this),Ot=X(this,ut,Le).call(this);rt(this,f,Math.max(d.AnnotationEditor.MIN_SIZE,St[2]-St[0])),rt(this,S,Math.max(d.AnnotationEditor.MIN_SIZE,St[3]-St[1]));const Rt=Math.ceil(Ot+t(this,f)*this.scaleFactor),jt=Math.ceil(Ot+t(this,S)*this.scaleFactor),[Nt,Jt]=this.parentDimensions;this.width=Rt/Nt,this.height=jt/Jt,this.setAspectRatio(Rt,jt);const _t=this.translationX,Yt=this.translationY;this.translationX=-St[0],this.translationY=-St[1],X(this,Lt,pe).call(this),X(this,H,ae).call(this),rt(this,_,Rt),rt(this,a,jt),this.setDims(Rt,jt);const It=Z?Ot/this.scaleFactor/2:0;this.translate(_t-this.translationX-It,Yt-this.translationY-It)},U(At,pt),U(At,Ct),U(At,zt),ee(At,"_defaultColor",null),ee(At,"_defaultOpacity",1),ee(At,"_defaultThickness",1),ee(At,"_type","ink");let k=At;e.InkEditor=k},(b,e,v)=>{var k,S,f,I,D,E,g,x,u,y,C,ve,_,xe,c,Ie,A,bn,F,Jn,$,Zn,R,yn,st,Oe,G,Qn;Object.defineProperty(e,"__esModule",{value:!0}),e.StampEditor=void 0;var n=v(1),d=v(4),W=v(6),j=v(29);const gt=class gt extends d.AnnotationEditor{constructor(M){super({...M,name:"stampEditor"});U(this,C);U(this,_);U(this,c);U(this,A);U(this,F);U(this,$);U(this,R);U(this,st);U(this,G);U(this,k,null);U(this,S,null);U(this,f,null);U(this,I,null);U(this,D,null);U(this,E,null);U(this,g,null);U(this,x,null);U(this,u,!1);U(this,y,!1);rt(this,I,M.bitmapUrl),rt(this,D,M.bitmapFile)}static initialize(M){d.AnnotationEditor.initialize(M)}static get supportedTypes(){const M=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,n.shadow)(this,"supportedTypes",M.map(i=>`image/${i}`))}static get supportedTypesStr(){return(0,n.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(M){return this.supportedTypes.includes(M)}static paste(M,i){i.pasteEditor(n.AnnotationEditorType.STAMP,{bitmapFile:M.getAsFile()})}remove(){var M,i;t(this,S)&&(rt(this,k,null),this._uiManager.imageManager.deleteId(t(this,S)),(M=t(this,E))==null||M.remove(),rt(this,E,null),(i=t(this,g))==null||i.disconnect(),rt(this,g,null)),super.remove()}rebuild(){if(!this.parent){t(this,S)&&X(this,c,Ie).call(this);return}super.rebuild(),this.div!==null&&(t(this,S)&&X(this,c,Ie).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(t(this,f)||t(this,k)||t(this,I)||t(this,D))}get isResizable(){return!0}render(){if(this.div)return this.div;let M,i;if(this.width&&(M=this.x,i=this.y),super.render(),this.div.hidden=!0,t(this,k)?X(this,A,bn).call(this):X(this,c,Ie).call(this),this.width){const[o,r]=this.parentDimensions;this.setAt(M*o,i*r,this.width*o,this.height*r)}return this.div}static deserialize(M,i,o){if(M instanceof j.StampAnnotationElement)return null;const r=super.deserialize(M,i,o),{rect:h,bitmapUrl:p,bitmapId:P,isSvg:O,accessibilityData:H}=M;P&&o.imageManager.isValidId(P)?rt(r,S,P):rt(r,I,p),rt(r,u,O);const[nt,J]=r.pageDimensions;return r.width=(h[2]-h[0])/nt,r.height=(h[3]-h[1])/J,H&&(r.altTextData=H),r}serialize(M=!1,i=null){if(this.isEmpty())return null;const o={annotationType:n.AnnotationEditorType.STAMP,bitmapId:t(this,S),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:t(this,u),structTreeParentId:this._structTreeParentId};if(M)return o.bitmapUrl=X(this,st,Oe).call(this,!0),o.accessibilityData=this.altTextData,o;const{decorative:r,altText:h}=this.altTextData;if(!r&&h&&(o.accessibilityData={type:"Figure",alt:h}),i===null)return o;i.stamps||(i.stamps=new Map);const p=t(this,u)?(o.rect[2]-o.rect[0])*(o.rect[3]-o.rect[1]):null;if(!i.stamps.has(t(this,S)))i.stamps.set(t(this,S),{area:p,serialized:o}),o.bitmap=X(this,st,Oe).call(this,!1);else if(t(this,u)){const P=i.stamps.get(t(this,S));p>P.area&&(P.area=p,P.serialized.bitmap.close(),P.serialized.bitmap=X(this,st,Oe).call(this,!1))}return o}};k=new WeakMap,S=new WeakMap,f=new WeakMap,I=new WeakMap,D=new WeakMap,E=new WeakMap,g=new WeakMap,x=new WeakMap,u=new WeakMap,y=new WeakMap,C=new WeakSet,ve=function(M,i=!1){if(!M){this.remove();return}rt(this,k,M.bitmap),i||(rt(this,S,M.id),rt(this,u,M.isSvg)),X(this,A,bn).call(this)},_=new WeakSet,xe=function(){rt(this,f,null),this._uiManager.enableWaiting(!1),t(this,E)&&this.div.focus()},c=new WeakSet,Ie=function(){if(t(this,S)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(t(this,S)).then(i=>X(this,C,ve).call(this,i,!0)).finally(()=>X(this,_,xe).call(this));return}if(t(this,I)){const i=t(this,I);rt(this,I,null),this._uiManager.enableWaiting(!0),rt(this,f,this._uiManager.imageManager.getFromUrl(i).then(o=>X(this,C,ve).call(this,o)).finally(()=>X(this,_,xe).call(this)));return}if(t(this,D)){const i=t(this,D);rt(this,D,null),this._uiManager.enableWaiting(!0),rt(this,f,this._uiManager.imageManager.getFromFile(i).then(o=>X(this,C,ve).call(this,o)).finally(()=>X(this,_,xe).call(this)));return}const M=document.createElement("input");M.type="file",M.accept=gt.supportedTypesStr,rt(this,f,new Promise(i=>{M.addEventListener("change",async()=>{if(!M.files||M.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const o=await this._uiManager.imageManager.getFromFile(M.files[0]);X(this,C,ve).call(this,o)}i()}),M.addEventListener("cancel",()=>{this.remove(),i()})}).finally(()=>X(this,_,xe).call(this))),M.click()},A=new WeakSet,bn=function(){const{div:M}=this;let{width:i,height:o}=t(this,k);const[r,h]=this.pageDimensions,p=.75;if(this.width)i=this.width*r,o=this.height*h;else if(i>p*r||o>p*h){const nt=Math.min(p*r/i,p*h/o);i*=nt,o*=nt}const[P,O]=this.parentDimensions;this.setDims(i*P/r,o*O/h),this._uiManager.enableWaiting(!1);const H=rt(this,E,document.createElement("canvas"));M.append(H),M.hidden=!1,X(this,R,yn).call(this,i,o),X(this,G,Qn).call(this),t(this,y)||(this.parent.addUndoableEditor(this),rt(this,y,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},F=new WeakSet,Jn=function(M,i){var p;const[o,r]=this.parentDimensions;this.width=M/o,this.height=i/r,this.setDims(M,i),(p=this._initialOptions)!=null&&p.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,t(this,x)!==null&&clearTimeout(t(this,x)),rt(this,x,setTimeout(()=>{rt(this,x,null),X(this,R,yn).call(this,M,i)},200))},$=new WeakSet,Zn=function(M,i){const{width:o,height:r}=t(this,k);let h=o,p=r,P=t(this,k);for(;h>2*M||p>2*i;){const O=h,H=p;h>2*M&&(h=h>=16384?Math.floor(h/2)-1:Math.ceil(h/2)),p>2*i&&(p=p>=16384?Math.floor(p/2)-1:Math.ceil(p/2));const nt=new OffscreenCanvas(h,p);nt.getContext("2d").drawImage(P,0,0,O,H,0,0,h,p),P=nt.transferToImageBitmap()}return P},R=new WeakSet,yn=function(M,i){M=Math.ceil(M),i=Math.ceil(i);const o=t(this,E);if(!o||o.width===M&&o.height===i)return;o.width=M,o.height=i;const r=t(this,u)?t(this,k):X(this,$,Zn).call(this,M,i),h=o.getContext("2d");h.filter=this._uiManager.hcmFilter,h.drawImage(r,0,0,r.width,r.height,0,0,M,i)},st=new WeakSet,Oe=function(M){if(M){if(t(this,u)){const r=this._uiManager.imageManager.getSvgUrl(t(this,S));if(r)return r}const i=document.createElement("canvas");return{width:i.width,height:i.height}=t(this,k),i.getContext("2d").drawImage(t(this,k),0,0),i.toDataURL()}if(t(this,u)){const[i,o]=this.pageDimensions,r=Math.round(this.width*i*W.PixelsPerInch.PDF_TO_CSS_UNITS),h=Math.round(this.height*o*W.PixelsPerInch.PDF_TO_CSS_UNITS),p=new OffscreenCanvas(r,h);return p.getContext("2d").drawImage(t(this,k),0,0,t(this,k).width,t(this,k).height,0,0,r,h),p.transferToImageBitmap()}return structuredClone(t(this,k))},G=new WeakSet,Qn=function(){rt(this,g,new ResizeObserver(M=>{const i=M[0].contentRect;i.width&&i.height&&X(this,F,Jn).call(this,i.width,i.height)})),t(this,g).observe(this.div)},ee(gt,"_type","stamp");let it=gt;e.StampEditor=it}],__webpack_module_cache__={};function __w_pdfjs_require__(b){var e=__webpack_module_cache__[b];if(e!==void 0)return e.exports;var v=__webpack_module_cache__[b]={exports:{}};return __webpack_modules__[b](v,v.exports,__w_pdfjs_require__),v.exports}var __webpack_exports__={};return(()=>{var b=__webpack_exports__;Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"AbortException",{enumerable:!0,get:function(){return e.AbortException}}),Object.defineProperty(b,"AnnotationEditorLayer",{enumerable:!0,get:function(){return W.AnnotationEditorLayer}}),Object.defineProperty(b,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return e.AnnotationEditorParamsType}}),Object.defineProperty(b,"AnnotationEditorType",{enumerable:!0,get:function(){return e.AnnotationEditorType}}),Object.defineProperty(b,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return j.AnnotationEditorUIManager}}),Object.defineProperty(b,"AnnotationLayer",{enumerable:!0,get:function(){return it.AnnotationLayer}}),Object.defineProperty(b,"AnnotationMode",{enumerable:!0,get:function(){return e.AnnotationMode}}),Object.defineProperty(b,"CMapCompressionType",{enumerable:!0,get:function(){return e.CMapCompressionType}}),Object.defineProperty(b,"DOMSVGFactory",{enumerable:!0,get:function(){return n.DOMSVGFactory}}),Object.defineProperty(b,"FeatureTest",{enumerable:!0,get:function(){return e.FeatureTest}}),Object.defineProperty(b,"GlobalWorkerOptions",{enumerable:!0,get:function(){return k.GlobalWorkerOptions}}),Object.defineProperty(b,"ImageKind",{enumerable:!0,get:function(){return e.ImageKind}}),Object.defineProperty(b,"InvalidPDFException",{enumerable:!0,get:function(){return e.InvalidPDFException}}),Object.defineProperty(b,"MissingPDFException",{enumerable:!0,get:function(){return e.MissingPDFException}}),Object.defineProperty(b,"OPS",{enumerable:!0,get:function(){return e.OPS}}),Object.defineProperty(b,"PDFDataRangeTransport",{enumerable:!0,get:function(){return v.PDFDataRangeTransport}}),Object.defineProperty(b,"PDFDateString",{enumerable:!0,get:function(){return n.PDFDateString}}),Object.defineProperty(b,"PDFWorker",{enumerable:!0,get:function(){return v.PDFWorker}}),Object.defineProperty(b,"PasswordResponses",{enumerable:!0,get:function(){return e.PasswordResponses}}),Object.defineProperty(b,"PermissionFlag",{enumerable:!0,get:function(){return e.PermissionFlag}}),Object.defineProperty(b,"PixelsPerInch",{enumerable:!0,get:function(){return n.PixelsPerInch}}),Object.defineProperty(b,"PromiseCapability",{enumerable:!0,get:function(){return e.PromiseCapability}}),Object.defineProperty(b,"RenderingCancelledException",{enumerable:!0,get:function(){return n.RenderingCancelledException}}),Object.defineProperty(b,"SVGGraphics",{enumerable:!0,get:function(){return v.SVGGraphics}}),Object.defineProperty(b,"UnexpectedResponseException",{enumerable:!0,get:function(){return e.UnexpectedResponseException}}),Object.defineProperty(b,"Util",{enumerable:!0,get:function(){return e.Util}}),Object.defineProperty(b,"VerbosityLevel",{enumerable:!0,get:function(){return e.VerbosityLevel}}),Object.defineProperty(b,"XfaLayer",{enumerable:!0,get:function(){return S.XfaLayer}}),Object.defineProperty(b,"build",{enumerable:!0,get:function(){return v.build}}),Object.defineProperty(b,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return e.createValidAbsoluteUrl}}),Object.defineProperty(b,"getDocument",{enumerable:!0,get:function(){return v.getDocument}}),Object.defineProperty(b,"getFilenameFromUrl",{enumerable:!0,get:function(){return n.getFilenameFromUrl}}),Object.defineProperty(b,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return n.getPdfFilenameFromUrl}}),Object.defineProperty(b,"getXfaPageViewport",{enumerable:!0,get:function(){return n.getXfaPageViewport}}),Object.defineProperty(b,"isDataScheme",{enumerable:!0,get:function(){return n.isDataScheme}}),Object.defineProperty(b,"isPdfFile",{enumerable:!0,get:function(){return n.isPdfFile}}),Object.defineProperty(b,"loadScript",{enumerable:!0,get:function(){return n.loadScript}}),Object.defineProperty(b,"noContextMenu",{enumerable:!0,get:function(){return n.noContextMenu}}),Object.defineProperty(b,"normalizeUnicode",{enumerable:!0,get:function(){return e.normalizeUnicode}}),Object.defineProperty(b,"renderTextLayer",{enumerable:!0,get:function(){return d.renderTextLayer}}),Object.defineProperty(b,"setLayerDimensions",{enumerable:!0,get:function(){return n.setLayerDimensions}}),Object.defineProperty(b,"shadow",{enumerable:!0,get:function(){return e.shadow}}),Object.defineProperty(b,"updateTextLayer",{enumerable:!0,get:function(){return d.updateTextLayer}}),Object.defineProperty(b,"version",{enumerable:!0,get:function(){return v.version}});var e=__w_pdfjs_require__(1),v=__w_pdfjs_require__(2),n=__w_pdfjs_require__(6),d=__w_pdfjs_require__(26),W=__w_pdfjs_require__(27),j=__w_pdfjs_require__(5),it=__w_pdfjs_require__(29),k=__w_pdfjs_require__(14),S=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf$1);var pdfExports=pdf$1.exports;const pdf=getDefaultExportFromCjs(pdfExports),pdfjsModule=_mergeNamespaces({__proto__:null,default:pdf},[pdfExports]),pdfjs="default"in pdfjsModule?pdf:pdfjsModule;var __spreadArray=function(b,e,v){if(v||arguments.length===2)for(var n=0,d=e.length,W;n<d;n++)(W||!(n in e))&&(W||(W=Array.prototype.slice.call(e,0,n)),W[n]=e[n]);return b.concat(W||Array.prototype.slice.call(e))},clipboardEvents=["onCopy","onCut","onPaste"],compositionEvents=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],focusEvents=["onFocus","onBlur"],formEvents=["onInput","onInvalid","onReset","onSubmit"],imageEvents=["onLoad","onError"],keyboardEvents=["onKeyDown","onKeyPress","onKeyUp"],mediaEvents=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],mouseEvents=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],dragEvents=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],selectionEvents=["onSelect"],touchEvents=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],pointerEvents=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],uiEvents=["onScroll"],wheelEvents=["onWheel"],animationEvents=["onAnimationStart","onAnimationEnd","onAnimationIteration"],transitionEvents=["onTransitionEnd"],otherEvents=["onToggle"],changeEvents=["onChange"],allEvents=__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([],clipboardEvents,!0),compositionEvents,!0),focusEvents,!0),formEvents,!0),imageEvents,!0),keyboardEvents,!0),mediaEvents,!0),mouseEvents,!0),dragEvents,!0),selectionEvents,!0),touchEvents,!0),pointerEvents,!0),uiEvents,!0),wheelEvents,!0),animationEvents,!0),transitionEvents,!0),changeEvents,!0),otherEvents,!0);function makeEventProps(b,e){var v={};return allEvents.forEach(function(n){var d=b[n];d&&(e?v[n]=function(W){return d(W,e(n))}:v[n]=d)}),v}function makeCancellablePromise(b){var e=!1,v=new Promise(function(n,d){b.then(function(W){return!e&&n(W)}).catch(function(W){return!e&&d(W)})});return{promise:v,cancel:function(){e=!0}}}var prefix="Invariant failed";function invariant(b,e){if(!b)throw new Error(prefix)}var warning=function(){},warning_1=warning;const warning$1=getDefaultExportFromCjs(warning_1);var has=Object.prototype.hasOwnProperty;function find(b,e,v){for(v of b.keys())if(dequal(v,e))return v}function dequal(b,e){var v,n,d;if(b===e)return!0;if(b&&e&&(v=b.constructor)===e.constructor){if(v===Date)return b.getTime()===e.getTime();if(v===RegExp)return b.toString()===e.toString();if(v===Array){if((n=b.length)===e.length)for(;n--&&dequal(b[n],e[n]););return n===-1}if(v===Set){if(b.size!==e.size)return!1;for(n of b)if(d=n,d&&typeof d=="object"&&(d=find(e,d),!d)||!e.has(d))return!1;return!0}if(v===Map){if(b.size!==e.size)return!1;for(n of b)if(d=n[0],d&&typeof d=="object"&&(d=find(e,d),!d)||!dequal(n[1],e.get(d)))return!1;return!0}if(v===ArrayBuffer)b=new Uint8Array(b),e=new Uint8Array(e);else if(v===DataView){if((n=b.byteLength)===e.byteLength)for(;n--&&b.getInt8(n)===e.getInt8(n););return n===-1}if(ArrayBuffer.isView(b)){if((n=b.byteLength)===e.byteLength)for(;n--&&b[n]===e[n];);return n===-1}if(!v||typeof b=="object"){n=0;for(v in b)if(has.call(b,v)&&++n&&!has.call(e,v)||!(v in e)||!dequal(b[v],e[v]))return!1;return Object.keys(e).length===n}}return b!==b&&e!==e}const DocumentContext=reactExports.createContext(null);function Message({children:b,type:e}){return jsxRuntimeExports.jsx("div",{className:`react-pdf__message react-pdf__message--${e}`,children:b})}const DEFAULT_LINK_REL="noopener noreferrer nofollow";class LinkService{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(e){this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setExternalLinkRel(e){this.externalLinkRel=e}setExternalLinkTarget(e){this.externalLinkTarget=e}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return invariant(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(e){invariant(this.pdfViewer),this.pdfViewer.currentPageNumber=e}get rotation(){return 0}set rotation(e){}goToDestination(e){return new Promise(v=>{invariant(this.pdfDocument),invariant(e),typeof e=="string"?this.pdfDocument.getDestination(e).then(v):Array.isArray(e)?v(e):e.then(v)}).then(v=>{invariant(Array.isArray(v));const n=v[0];new Promise(d=>{invariant(this.pdfDocument),n instanceof Object?this.pdfDocument.getPageIndex(n).then(W=>{d(W)}).catch(()=>{invariant(!1)}):typeof n=="number"?d(n):invariant(!1)}).then(d=>{const W=d+1;invariant(this.pdfViewer),invariant(W>=1&&W<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:v,pageIndex:d,pageNumber:W})})})}navigateTo(e){this.goToDestination(e)}goToPage(e){const v=e-1;invariant(this.pdfViewer),invariant(e>=1&&e<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:v,pageNumber:e})}addLinkAttributes(e,v,n){e.href=v,e.rel=this.externalLinkRel||DEFAULT_LINK_REL,e.target=n?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},isBrowser=typeof document<"u",isLocalFileSystem=isBrowser&&window.location.protocol==="file:";function isDefined(b){return typeof b<"u"}function isProvided(b){return isDefined(b)&&b!==null}function isString(b){return typeof b=="string"}function isArrayBuffer(b){return b instanceof ArrayBuffer}function isBlob(b){return invariant(isBrowser),b instanceof Blob}function isDataURI(b){return isString(b)&&/^data:/.test(b)}function dataURItoByteString(b){invariant(isDataURI(b));const[e="",v=""]=b.split(",");return e.split(";").indexOf("base64")!==-1?atob(v):unescape(v)}function getDevicePixelRatio(){return isBrowser&&window.devicePixelRatio||1}const allowFileAccessFromFilesTip="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function displayCORSWarning(){warning$1(!isLocalFileSystem,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function displayWorkerWarning(){warning$1(!isLocalFileSystem,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function cancelRunningTask(b){b&&b.cancel&&b.cancel()}function makePageCallback(b,e){return Object.defineProperty(b,"width",{get(){return this.view[2]*e},configurable:!0}),Object.defineProperty(b,"height",{get(){return this.view[3]*e},configurable:!0}),Object.defineProperty(b,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(b,"originalHeight",{get(){return this.view[3]},configurable:!0}),b}function isCancelException(b){return b.name==="RenderingCancelledException"}function loadFromFile(b){return new Promise((e,v)=>{const n=new FileReader;n.onload=()=>{if(!n.result)return v(new Error("Error while reading a file."));e(n.result)},n.onerror=d=>{if(!d.target)return v(new Error("Error while reading a file."));const{error:W}=d.target;if(!W)return v(new Error("Error while reading a file."));switch(W.code){case W.NOT_FOUND_ERR:return v(new Error("Error while reading a file: File not found."));case W.SECURITY_ERR:return v(new Error("Error while reading a file: Security error."));case W.ABORT_ERR:return v(new Error("Error while reading a file: Aborted."));default:return v(new Error("Error while reading a file."))}},n.readAsArrayBuffer(b)})}function reducer(b,e){switch(e.type){case"RESOLVE":return{value:e.value,error:void 0};case"REJECT":return{value:!1,error:e.error};case"RESET":return{value:void 0,error:void 0};default:return b}}function useResolver(){return reactExports.useReducer(reducer,{value:void 0,error:void 0})}var __awaiter=function(b,e,v,n){function d(W){return W instanceof v?W:new v(function(j){j(W)})}return new(v||(v=Promise))(function(W,j){function it(f){try{S(n.next(f))}catch(I){j(I)}}function k(f){try{S(n.throw(f))}catch(I){j(I)}}function S(f){f.done?W(f.value):d(f.value).then(it,k)}S((n=n.apply(b,e||[])).next())})},__rest$1=function(b,e){var v={};for(var n in b)Object.prototype.hasOwnProperty.call(b,n)&&e.indexOf(n)<0&&(v[n]=b[n]);if(b!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,n=Object.getOwnPropertySymbols(b);d<n.length;d++)e.indexOf(n[d])<0&&Object.prototype.propertyIsEnumerable.call(b,n[d])&&(v[n[d]]=b[n[d]]);return v};const{PDFDataRangeTransport}=pdfjs,defaultOnPassword=(b,e)=>{switch(e){case PasswordResponses.NEED_PASSWORD:{const v=prompt("Enter the password to open this PDF file.");b(v);break}case PasswordResponses.INCORRECT_PASSWORD:{const v=prompt("Invalid password. Please try again.");b(v);break}}};function isParameterObject(b){return typeof b=="object"&&b!==null&&("data"in b||"range"in b||"url"in b)}const Document=reactExports.forwardRef(function b(e,v){var{children:n,className:d,error:W="Failed to load PDF file.",externalLinkRel:j,externalLinkTarget:it,file:k,inputRef:S,imageResourcesPath:f,loading:I="Loading PDF…",noData:D="No PDF file specified.",onItemClick:E,onLoadError:g,onLoadProgress:x,onLoadSuccess:u,onPassword:y=defaultOnPassword,onSourceError:C,onSourceSuccess:w,options:_,renderMode:a,rotate:c}=e,L=__rest$1(e,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[A,l]=useResolver(),{value:F,error:m}=A,[$,z]=useResolver(),{value:R,error:V}=$,st=reactExports.useRef(new LinkService),at=reactExports.useRef([]),G=reactExports.useRef(void 0),ct=reactExports.useRef(void 0);k&&k!==G.current&&isParameterObject(k)&&(warning$1(!dequal(k,G.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),G.current=k),_&&_!==ct.current&&(warning$1(!dequal(_,ct.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),ct.current=_);const gt=reactExports.useRef({scrollPageIntoView:ft=>{const{dest:dt,pageNumber:wt,pageIndex:Lt=wt-1}=ft;if(E){E({dest:dt,pageIndex:Lt,pageNumber:wt});return}const vt=at.current[Lt];if(vt){vt.scrollIntoView();return}warning$1(!1,`An internal link leading to page ${wt} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});reactExports.useImperativeHandle(v,()=>({linkService:st,pages:at,viewer:gt}),[]);function xt(){w&&w()}function Et(){m&&(warning$1(!1,m.toString()),C&&C(m))}function M(){l({type:"RESET"})}reactExports.useEffect(M,[k,l]);const i=reactExports.useCallback(()=>__awaiter(this,void 0,void 0,function*(){if(!k)return null;if(typeof k=="string")return isDataURI(k)?{data:dataURItoByteString(k)}:(displayCORSWarning(),{url:k});if(k instanceof PDFDataRangeTransport)return{range:k};if(isArrayBuffer(k))return{data:k};if(isBrowser&&isBlob(k))return{data:yield loadFromFile(k)};if(invariant(typeof k=="object"),invariant(isParameterObject(k)),"url"in k&&typeof k.url=="string"){if(isDataURI(k.url)){const{url:ft}=k,dt=__rest$1(k,["url"]),wt=dataURItoByteString(ft);return Object.assign({data:wt},dt)}displayCORSWarning()}return k}),[k]);reactExports.useEffect(()=>{const ft=makeCancellablePromise(i());return ft.promise.then(dt=>{l({type:"RESOLVE",value:dt})}).catch(dt=>{l({type:"REJECT",error:dt})}),()=>{cancelRunningTask(ft)}},[i,l]),reactExports.useEffect(()=>{if(!(typeof F>"u")){if(F===!1){Et();return}xt()}},[F]);function o(){R&&(u&&u(R),at.current=new Array(R.numPages),st.current.setDocument(R))}function r(){V&&(warning$1(!1,V.toString()),g&&g(V))}function h(){z({type:"RESET"})}reactExports.useEffect(h,[z,F]);function p(){if(!F)return;const ft=Object.assign(Object.assign({},_),{isEvalSupported:!1}),dt=Object.assign(Object.assign({},F),ft),wt=pdfjs.getDocument(dt);x&&(wt.onProgress=x),y&&(wt.onPassword=y);const Lt=wt;return Lt.promise.then(vt=>{z({type:"RESOLVE",value:vt})}).catch(vt=>{Lt.destroyed||z({type:"REJECT",error:vt})}),()=>{Lt.destroy()}}reactExports.useEffect(p,[_,z,F]),reactExports.useEffect(()=>{if(!(typeof R>"u")){if(R===!1){r();return}o()}},[R]);function P(){st.current.setViewer(gt.current),st.current.setExternalLinkRel(j),st.current.setExternalLinkTarget(it)}reactExports.useEffect(P,[j,it]);function O(ft,dt){at.current[ft]=dt}function H(ft){delete at.current[ft]}const nt=reactExports.useMemo(()=>({imageResourcesPath:f,linkService:st.current,onItemClick:E,pdf:R,registerPage:O,renderMode:a,rotate:c,unregisterPage:H}),[f,E,R,a,c]),J=reactExports.useMemo(()=>makeEventProps(L,()=>R),[L,R]);function ot(){return jsxRuntimeExports.jsx(DocumentContext.Provider,{value:nt,children:n})}function ht(){return k?R==null?jsxRuntimeExports.jsx(Message,{type:"loading",children:typeof I=="function"?I():I}):R===!1?jsxRuntimeExports.jsx(Message,{type:"error",children:typeof W=="function"?W():W}):ot():jsxRuntimeExports.jsx(Message,{type:"no-data",children:typeof D=="function"?D():D})}return jsxRuntimeExports.jsx("div",Object.assign({className:clsx("react-pdf__Document",d),ref:S,style:{"--scale-factor":"1"}},J,{children:ht()}))});function useDocumentContext(){return reactExports.useContext(DocumentContext)}function mergeRefs(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];var v=b.filter(Boolean);if(v.length<=1){var n=v[0];return n||null}return function(W){v.forEach(function(j){typeof j=="function"?j(W):j&&(j.current=W)})}}const PageContext=reactExports.createContext(null),PDF_ROLE_TO_HTML_ROLE={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},HEADING_PATTERN=/^H(\d+)$/;function isPdfRole(b){return b in PDF_ROLE_TO_HTML_ROLE}function isStructTreeNode(b){return"children"in b}function isStructTreeNodeWithOnlyContentChild(b){return isStructTreeNode(b)?b.children.length===1&&0 in b.children&&"id"in b.children[0]:!1}function getRoleAttributes(b){const e={};if(isStructTreeNode(b)){const{role:v}=b,n=v.match(HEADING_PATTERN);if(n)e.role="heading",e["aria-level"]=Number(n[1]);else if(isPdfRole(v)){const d=PDF_ROLE_TO_HTML_ROLE[v];d&&(e.role=d)}}return e}function getBaseAttributes(b){const e={};if(isStructTreeNode(b)){if(b.alt!==void 0&&(e["aria-label"]=b.alt),b.lang!==void 0&&(e.lang=b.lang),isStructTreeNodeWithOnlyContentChild(b)){const[v]=b.children;if(v){const n=getBaseAttributes(v);return Object.assign(Object.assign({},e),n)}}}else"id"in b&&(e["aria-owns"]=b.id);return e}function getAttributes(b){return b?Object.assign(Object.assign({},getRoleAttributes(b)),getBaseAttributes(b)):null}function StructTreeItem({className:b,node:e}){const v=reactExports.useMemo(()=>getAttributes(e),[e]),n=reactExports.useMemo(()=>!isStructTreeNode(e)||isStructTreeNodeWithOnlyContentChild(e)?null:e.children.map((d,W)=>jsxRuntimeExports.jsx(StructTreeItem,{node:d},W)),[e]);return jsxRuntimeExports.jsx("span",Object.assign({className:b},v,{children:n}))}function usePageContext(){return reactExports.useContext(PageContext)}function StructTree(){const b=usePageContext();invariant(b);const{onGetStructTreeError:e,onGetStructTreeSuccess:v}=b,[n,d]=useResolver(),{value:W,error:j}=n,{customTextRenderer:it,page:k}=b;function S(){W&&v&&v(W)}function f(){j&&(warning$1(!1,j.toString()),e&&e(j))}function I(){d({type:"RESET"})}reactExports.useEffect(I,[d,k]);function D(){if(it||!k)return;const E=makeCancellablePromise(k.getStructTree()),g=E;return E.promise.then(x=>{d({type:"RESOLVE",value:x})}).catch(x=>{d({type:"REJECT",error:x})}),()=>cancelRunningTask(g)}return reactExports.useEffect(D,[it,k,d]),reactExports.useEffect(()=>{if(W!==void 0){if(W===!1){f();return}S()}},[W]),W?jsxRuntimeExports.jsx(StructTreeItem,{className:"react-pdf__Page__structTree structTree",node:W}):null}const ANNOTATION_MODE=pdfjs.AnnotationMode;function PageCanvas(b){const e=usePageContext();invariant(e);const v=Object.assign(Object.assign({},e),b),{_className:n,canvasBackground:d,devicePixelRatio:W=getDevicePixelRatio(),onRenderError:j,onRenderSuccess:it,page:k,renderForms:S,renderTextLayer:f,rotate:I,scale:D}=v,{canvasRef:E}=b;invariant(k);const g=reactExports.useRef(null);function x(){k&&it&&it(makePageCallback(k,D))}function u(a){isCancelException(a)||(warning$1(!1,a.toString()),j&&j(a))}const y=reactExports.useMemo(()=>k.getViewport({scale:D*W,rotation:I}),[W,k,I,D]),C=reactExports.useMemo(()=>k.getViewport({scale:D,rotation:I}),[k,I,D]);function w(){if(!k)return;k.cleanup();const{current:a}=g;if(!a)return;a.width=y.width,a.height=y.height,a.style.width=`${Math.floor(C.width)}px`,a.style.height=`${Math.floor(C.height)}px`,a.style.visibility="hidden";const c={annotationMode:S?ANNOTATION_MODE.ENABLE_FORMS:ANNOTATION_MODE.ENABLE,canvasContext:a.getContext("2d",{alpha:!1}),viewport:y};d&&(c.background=d);const L=k.render(c),A=L;return L.promise.then(()=>{a.style.visibility="",x()}).catch(u),()=>cancelRunningTask(A)}reactExports.useEffect(w,[d,g,W,k,S,y,C]);const _=reactExports.useCallback(()=>{const{current:a}=g;a&&(a.width=0,a.height=0)},[g]);return reactExports.useEffect(()=>_,[_]),jsxRuntimeExports.jsx("canvas",{className:`${n}__canvas`,dir:"ltr",ref:mergeRefs(E,g),style:{display:"block",userSelect:"none"},children:f?jsxRuntimeExports.jsx(StructTree,{}):null})}function PageSVG(){const b=usePageContext();invariant(b);const{_className:e,onRenderSuccess:v,onRenderError:n,page:d,rotate:W,scale:j}=b;invariant(d);const[it,k]=useResolver(),{value:S,error:f}=it;function I(){d&&v&&v(makePageCallback(d,j))}function D(){f&&(isCancelException(f)||(warning$1(!1,f.toString()),n&&n(f)))}const E=reactExports.useMemo(()=>d.getViewport({scale:j,rotation:W}),[d,W,j]);function g(){k({type:"RESET"})}reactExports.useEffect(g,[d,k,E]);function x(){if(!d)return;const w=makeCancellablePromise(d.getOperatorList());return w.promise.then(_=>{new pdfjs.SVGGraphics(d.commonObjs,d.objs).getSVG(_,E).then(c=>{if(!(c instanceof SVGElement))throw new Error("getSVG returned unexpected result.");k({type:"RESOLVE",value:c})}).catch(c=>{k({type:"REJECT",error:c})})}).catch(_=>{k({type:"REJECT",error:_})}),()=>cancelRunningTask(w)}reactExports.useEffect(x,[d,k,E]),reactExports.useEffect(()=>{if(S!==void 0){if(S===!1){D();return}I()}},[S]);function u(w){if(!w||!S)return;w.firstElementChild||w.appendChild(S);const{width:_,height:a}=E;S.setAttribute("width",`${_}`),S.setAttribute("height",`${a}`)}const{width:y,height:C}=E;return jsxRuntimeExports.jsx("div",{className:`${e}__svg`,ref:w=>u(w),style:{display:"block",backgroundColor:"white",overflow:"hidden",width:y,height:C,userSelect:"none"}})}function isTextItem(b){return"str"in b}function TextLayer(){const b=usePageContext();invariant(b);const{customTextRenderer:e,onGetTextError:v,onGetTextSuccess:n,onRenderTextLayerError:d,onRenderTextLayerSuccess:W,page:j,pageIndex:it,pageNumber:k,rotate:S,scale:f}=b;invariant(j);const[I,D]=useResolver(),{value:E,error:g}=I,x=reactExports.useRef(null),u=reactExports.useRef(void 0);warning$1(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function y(){E&&n&&n(E)}function C(){g&&(warning$1(!1,g.toString()),v&&v(g))}function w(){D({type:"RESET"})}reactExports.useEffect(w,[j,D]);function _(){if(!j)return;const m=makeCancellablePromise(j.getTextContent()),$=m;return m.promise.then(z=>{D({type:"RESOLVE",value:z})}).catch(z=>{D({type:"REJECT",error:z})}),()=>cancelRunningTask($)}reactExports.useEffect(_,[j,D]),reactExports.useEffect(()=>{if(E!==void 0){if(E===!1){C();return}y()}},[E]);const a=reactExports.useCallback(()=>{W&&W()},[W]),c=reactExports.useCallback(m=>{warning$1(!1,m.toString()),d&&d(m)},[d]);function L(){const m=u.current;m&&m.classList.add("active")}function A(){const m=u.current;m&&m.classList.remove("active")}const l=reactExports.useMemo(()=>j.getViewport({scale:f,rotation:S}),[j,S,f]);function F(){if(!j||!E)return;const{current:m}=x;if(!m)return;m.innerHTML="";const $=j.streamTextContent({includeMarkedContent:!0}),z={container:m,textContentSource:$,viewport:l},R=pdfjs.renderTextLayer(z),V=R;return R.promise.then(()=>{const st=document.createElement("div");st.className="endOfContent",m.append(st),u.current=st;const at=m.querySelectorAll('[role="presentation"]');if(e){let G=0;E.items.forEach((ct,gt)=>{if(!isTextItem(ct))return;const xt=at[G];if(!xt)return;const Et=e(Object.assign({pageIndex:it,pageNumber:k,itemIndex:gt},ct));xt.innerHTML=Et,G+=ct.str&&ct.hasEOL?2:1})}a()}).catch(c),()=>cancelRunningTask(V)}return reactExports.useLayoutEffect(F,[e,c,a,j,it,k,E,l]),jsxRuntimeExports.jsx("div",{className:clsx("react-pdf__Page__textContent","textLayer"),onMouseUp:A,onMouseDown:L,ref:x})}function AnnotationLayer(){const b=useDocumentContext(),e=usePageContext();invariant(e);const v=Object.assign(Object.assign({},b),e),{imageResourcesPath:n,linkService:d,onGetAnnotationsError:W,onGetAnnotationsSuccess:j,onRenderAnnotationLayerError:it,onRenderAnnotationLayerSuccess:k,page:S,pdf:f,renderForms:I,rotate:D,scale:E=1}=v;invariant(f),invariant(S),invariant(d);const[g,x]=useResolver(),{value:u,error:y}=g,C=reactExports.useRef(null);warning$1(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function w(){u&&j&&j(u)}function _(){y&&(warning$1(!1,y.toString()),W&&W(y))}function a(){x({type:"RESET"})}reactExports.useEffect(a,[x,S]);function c(){if(!S)return;const m=makeCancellablePromise(S.getAnnotations()),$=m;return m.promise.then(z=>{x({type:"RESOLVE",value:z})}).catch(z=>{x({type:"REJECT",error:z})}),()=>{cancelRunningTask($)}}reactExports.useEffect(c,[x,S,I]),reactExports.useEffect(()=>{if(u!==void 0){if(u===!1){_();return}w()}},[u]);function L(){k&&k()}function A(m){warning$1(!1,`${m}`),it&&it(m)}const l=reactExports.useMemo(()=>S.getViewport({scale:E,rotation:D}),[S,D,E]);function F(){if(!f||!S||!d||!u)return;const{current:m}=C;if(!m)return;const $=l.clone({dontFlip:!0}),z={accessibilityManager:null,annotationCanvasMap:null,div:m,l10n:null,page:S,viewport:$},R={annotations:u,annotationStorage:f.annotationStorage,div:m,downloadManager:null,imageResourcesPath:n,linkService:d,page:S,renderForms:I,viewport:$};m.innerHTML="";try{new pdfjs.AnnotationLayer(z).render(R),L()}catch(V){A(V)}return()=>{}}return reactExports.useEffect(F,[u,n,d,S,I,l]),jsxRuntimeExports.jsx("div",{className:clsx("react-pdf__Page__annotations","annotationLayer"),ref:C})}var __rest=function(b,e){var v={};for(var n in b)Object.prototype.hasOwnProperty.call(b,n)&&e.indexOf(n)<0&&(v[n]=b[n]);if(b!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,n=Object.getOwnPropertySymbols(b);d<n.length;d++)e.indexOf(n[d])<0&&Object.prototype.propertyIsEnumerable.call(b,n[d])&&(v[n[d]]=b[n[d]]);return v};const defaultScale=1;function Page(b){const e=useDocumentContext(),v=Object.assign(Object.assign({},e),b),{_className:n="react-pdf__Page",_enableRegisterUnregisterPage:d=!0,canvasBackground:W,canvasRef:j,children:it,className:k,customRenderer:S,customTextRenderer:f,devicePixelRatio:I,error:D="Failed to load the page.",height:E,inputRef:g,loading:x="Loading page…",noData:u="No page specified.",onGetAnnotationsError:y,onGetAnnotationsSuccess:C,onGetStructTreeError:w,onGetStructTreeSuccess:_,onGetTextError:a,onGetTextSuccess:c,onLoadError:L,onLoadSuccess:A,onRenderAnnotationLayerError:l,onRenderAnnotationLayerSuccess:F,onRenderError:m,onRenderSuccess:$,onRenderTextLayerError:z,onRenderTextLayerSuccess:R,pageIndex:V,pageNumber:st,pdf:at,registerPage:G,renderAnnotationLayer:ct=!0,renderForms:gt=!1,renderMode:xt="canvas",renderTextLayer:Et=!0,rotate:M,scale:i=defaultScale,unregisterPage:o,width:r}=v,h=__rest(v,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[p,P]=useResolver(),{value:O,error:H}=p,nt=reactExports.useRef(null);invariant(at);const J=isProvided(st)?st-1:V??null,ot=st??(isProvided(V)?V+1:null),ht=M??(O?O.rotate:null),ft=reactExports.useMemo(()=>{if(!O)return null;let $t=1;const Gt=i??defaultScale;if(r||E){const Bt=O.getViewport({scale:1,rotation:ht});r?$t=r/Bt.width:E&&($t=E/Bt.height)}return Gt*$t},[E,O,ht,i,r]);function dt(){return()=>{isProvided(J)&&d&&o&&o(J)}}reactExports.useEffect(dt,[d,at,J,o]);function wt(){if(A){if(!O||!ft)return;A(makePageCallback(O,ft))}if(d&&G){if(!isProvided(J)||!nt.current)return;G(J,nt.current)}}function Lt(){H&&(warning$1(!1,H.toString()),L&&L(H))}function vt(){P({type:"RESET"})}reactExports.useEffect(vt,[P,at,J]);function Dt(){if(!at||!ot)return;const $t=makeCancellablePromise(at.getPage(ot)),Gt=$t;return $t.promise.then(Bt=>{P({type:"RESOLVE",value:Bt})}).catch(Bt=>{P({type:"REJECT",error:Bt})}),()=>cancelRunningTask(Gt)}reactExports.useEffect(Dt,[P,at,J,ot,G]),reactExports.useEffect(()=>{if(O!==void 0){if(O===!1){Lt();return}wt()}},[O,ft]);const mt=reactExports.useMemo(()=>O&&isProvided(J)&&ot&&isProvided(ht)&&isProvided(ft)?{_className:n,canvasBackground:W,customTextRenderer:f,devicePixelRatio:I,onGetAnnotationsError:y,onGetAnnotationsSuccess:C,onGetStructTreeError:w,onGetStructTreeSuccess:_,onGetTextError:a,onGetTextSuccess:c,onRenderAnnotationLayerError:l,onRenderAnnotationLayerSuccess:F,onRenderError:m,onRenderSuccess:$,onRenderTextLayerError:z,onRenderTextLayerSuccess:R,page:O,pageIndex:J,pageNumber:ot,renderForms:gt,renderTextLayer:Et,rotate:ht,scale:ft}:null,[n,W,f,I,y,C,w,_,a,c,l,F,m,$,z,R,O,J,ot,gt,Et,ht,ft]),et=reactExports.useMemo(()=>makeEventProps(h,()=>O&&(ft?makePageCallback(O,ft):void 0)),[h,O,ft]),Q=`${J}@${ft}/${ht}`,pt=`${J}/${ht}`;function Tt(){switch(xt){case"custom":return invariant(S),jsxRuntimeExports.jsx(S,{},`${Q}_custom`);case"none":return null;case"svg":return jsxRuntimeExports.jsx(PageSVG,{},`${pt}_svg`);case"canvas":default:return jsxRuntimeExports.jsx(PageCanvas,{canvasRef:j},`${Q}_canvas`)}}function Ct(){return Et?jsxRuntimeExports.jsx(TextLayer,{},`${Q}_text`):null}function Ut(){return ct?jsxRuntimeExports.jsx(AnnotationLayer,{},`${Q}_annotations`):null}function zt(){return jsxRuntimeExports.jsxs(PageContext.Provider,{value:mt,children:[Tt(),Ct(),Ut(),it]})}function Wt(){return ot?at===null||O===void 0||O===null?jsxRuntimeExports.jsx(Message,{type:"loading",children:typeof x=="function"?x():x}):at===!1||O===!1?jsxRuntimeExports.jsx(Message,{type:"error",children:typeof D=="function"?D():D}):zt():jsxRuntimeExports.jsx(Message,{type:"no-data",children:typeof u=="function"?u():u})}return jsxRuntimeExports.jsx("div",Object.assign({className:clsx(n,k),"data-page-number":ot,ref:mergeRefs(g,nt),style:{"--scale-factor":`${ft}`,backgroundColor:W||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},et,{children:Wt()}))}displayWorkerWarning();pdfjs.GlobalWorkerOptions.workerSrc="pdf.worker.js";pdfjs.GlobalWorkerOptions.workerSrc=`//unpkg.com/pdfjs-dist@${pdfjs.version}/build/pdf.worker.min.js`;PdfViewer.propTypes={pdf:PropTypes.object,loadingProgress:PropTypes.array,currentPages:PropTypes.number,setCurrentPages:PropTypes.func,numPages:PropTypes.oneOfType([PropTypes.number,PropTypes.oneOf([null])]),setNumPages:PropTypes.func,index:PropTypes.number};function PdfViewer({numPages:b,currentPages:e,setNumPages:v,setCurrentPages:n,loadingProgress:d,pdf:W,index:j}){var I,D;const it=useSelector(selectLanguage),k=({numPages:E})=>{v(E)},S=()=>{n(E=>E+1)},f=()=>{n(E=>E-1)};return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{style:{width:200,display:"flex",justifyContent:"space-between",flexWrap:"wrap"},children:[jsxRuntimeExports.jsxs(Typography,{variant:"caption",children:[it==="en"?"Total page: ":"Всього сторінок: ",b]}),jsxRuntimeExports.jsxs(Typography,{variant:"caption",children:[it==="en"?"Current page: ":"Поточна сторінка: ",e]})]}),jsxRuntimeExports.jsxs("div",{style:{position:"relative",width:200,height:283},children:[jsxRuntimeExports.jsxs(WrapperNavigateButton$1,{children:[jsxRuntimeExports.jsx(IconButton,{disabled:e===1,onClick:f,color:"info",sx:{bgcolor:"#11111199"},children:jsxRuntimeExports.jsx(default_1$5,{})}),jsxRuntimeExports.jsx(IconButton,{onClick:S,disabled:e===b,color:"info",sx:{bgcolor:"#11111199"},children:jsxRuntimeExports.jsx(default_1$4,{})})]}),jsxRuntimeExports.jsxs(LoaderWrapper,{children:[jsxRuntimeExports.jsx(CircularProgress,{variant:"determinate",value:((I=d==null?void 0:d[j])==null?void 0:I.progress)??0}),jsxRuntimeExports.jsx(LoaderPercent,{children:jsxRuntimeExports.jsx(Typography,{variant:"caption",component:"div",color:"text.secondary",children:`${Math.round(((D=d==null?void 0:d[j])==null?void 0:D.progress)??0)}%`})})]}),jsxRuntimeExports.jsx(Document,{file:W,onLoadSuccess:k,children:jsxRuntimeExports.jsx(Page,{pageNumber:e,width:200})})]})]})}UploadButtons.propTypes={handleFileChange:PropTypes.func,selectedFile:PropTypes.array,imagePreview:PropTypes.object,handleCloseModal:PropTypes.func,loadingProgress:PropTypes.array,setLoadingProgress:PropTypes.func,currentPages:PropTypes.number,setCurrentPages:PropTypes.func,numPages:PropTypes.oneOfType([PropTypes.number,PropTypes.oneOf([null])]),setNumPages:PropTypes.func};function UploadButtons({selectedFile:b,handleFileChange:e,imagePreview:v,loadingProgress:n,setLoadingProgress:d,currentPages:W,setCurrentPages:j,numPages:it,setNumPages:k,handleCloseModal:S}){var x,u,y,C;const f=useSelector(selectLanguage),I=useDispatch(),D=useLocation(),E=useSelector(selectLessonsById),g=async()=>{var w;await I(uploadMaterialsThunk({data:b,setLoadingProgress:d,id:((w=D==null?void 0:D.state)==null?void 0:w.id)??D.pathname.split("/")[D.pathname.split("/").length-1],lessonInfo:D==null?void 0:D.state,lessonMaterials:(E==null?void 0:E.materials)??null})),S()};return jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsxs(MainWrapper,{children:[jsxRuntimeExports.jsxs(ButtonWrapper,{children:[jsxRuntimeExports.jsxs(Button,{sx:{width:130,position:"relative"},size:"small",variant:"contained",startIcon:jsxRuntimeExports.jsx(default_1$7,{}),component:"label",children:[b.length>0&&jsxRuntimeExports.jsx(StyledBadge,{children:jsxRuntimeExports.jsx(Typography,{variant:"caption",children:b.length})}),f==="en"?"Select files":"Виберіть файли",jsxRuntimeExports.jsx(VisuallyHiddenInput,{type:"file",onChange:e,multiple:!0,accept:".png, .jpg, .jpeg, .pdf"})]}),jsxRuntimeExports.jsxs(Button,{disabled:b.length===0,variant:"contained",startIcon:jsxRuntimeExports.jsx(default_1$6,{}),size:"small",onClick:g,children:[f==="en"&&"Upload",f==="ua"&&"Завантажити"]})]}),jsxRuntimeExports.jsxs(Box,{display:"flex",flexDirection:"column",gap:"20px",width:"100%",alignItems:"center",children:[((x=v==null?void 0:v.pdf)==null?void 0:x.length)>0&&jsxRuntimeExports.jsx(Divider,{sx:{m:2,width:"100%"},children:jsxRuntimeExports.jsx(Chip,{label:"PDF",size:"small"})}),(u=v==null?void 0:v.pdf)==null?void 0:u.map((w,_)=>jsxRuntimeExports.jsx(Box,{width:"100%",display:"flex",justifyContent:"center",children:jsxRuntimeExports.jsx(PdfViewer,{numPages:it,currentPages:W,setNumPages:k,setCurrentPages:j,loadingProgress:n,pdf:w,index:_})},nanoid())),((y=v==null?void 0:v.images)==null?void 0:y.length)>0&&jsxRuntimeExports.jsx(Divider,{sx:{m:2,width:"100%"},children:jsxRuntimeExports.jsx(Chip,{label:"IMAGE",size:"small"})}),jsxRuntimeExports.jsx(Box,{display:"flex",flexWrap:"wrap",justifyContent:"center",gap:"20px",children:(C=v==null?void 0:v.images)==null?void 0:C.map((w,_)=>{var a,c;return jsxRuntimeExports.jsx(ImageWrapper,{src:w,children:jsxRuntimeExports.jsxs(LoaderWrapper$1,{children:[jsxRuntimeExports.jsx(CircularProgress,{variant:"determinate",value:((a=n==null?void 0:n[_])==null?void 0:a.progress)??0}),jsxRuntimeExports.jsx(LoaderPercent$1,{children:jsxRuntimeExports.jsx(Typography,{variant:"caption",component:"div",color:"text.secondary",children:`${Math.round(((c=n==null?void 0:n[_])==null?void 0:c.progress)??0)}%`})})]})},nanoid())})})]})]})})}ModalAddMaterial.propTypes={isModalMaterials:PropTypes.bool.isRequired,setIsModalMaterials:PropTypes.func,lessonMaterials:PropTypes.object.isRequired};function ModalAddMaterial({isModalMaterials:b,setIsModalMaterials:e,lessonMaterials:v}){const n=useSelector(selectLanguage),[d,W]=reactExports.useState([]),[j,it]=reactExports.useState([]),[k,S]=reactExports.useState({pdf:[],images:[]}),[f,I]=reactExports.useState(null),[D,E]=reactExports.useState(1);reactExports.useLayoutEffect(()=>{b?(document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%"):(document.body.style.overflow="auto",document.body.style.position="static")},[b]);const g=async u=>{it([]),E(1),I(null),S({pdf:[],images:[]}),W([]);let y=[...u.target.files];const C=y.filter(({type:_})=>_==="application/pdf");if(C.length>1&&(notify("warning",n==="en?"?"You can only add one PDF file at a time":"Ви можете додати лише один файл PDF на раз"),y=[...y.filter(({type:a})=>a.includes("image")),C[0]]),console.log(C),console.log(y),v.materials&&v.materials.length>0){const _=v.materials.map(({name:c})=>c);y=[...y.filter(c=>{if(_.includes(c.name)){notify("warning",n==="en?"?`This file already exist ${c.name}`:`Цей файл уже існує ${c.name}`);return}else return c})]}const w=5*1024*1024;(y==null?void 0:y.length)>5&&maxFilesError(n,5),y.forEach(_=>{if(_.size>w){maxSizeError(n);return}if(_&&(_.type==="image/png"||_.type==="image/jpeg"||_.type==="image/jpg"||_.type==="application/pdf")){if(_.type==="application/pdf")S(a=>{var c,L;return((c=a==null?void 0:a.pdf)==null?void 0:c.length)+((L=a==null?void 0:a.images)==null?void 0:L.length)>4?a:{images:[...a.images],pdf:[...a.pdf,_]}});else{const a=new FileReader;a.onload=()=>{S(c=>{var L,A;return((L=c==null?void 0:c.pdf)==null?void 0:L.length)+((A=c==null?void 0:c.images)==null?void 0:A.length)>4?c:{images:[...c.images,a.result],pdf:[...c.pdf]}})},a.readAsDataURL(_)}it(a=>(a==null?void 0:a.length)>4?a:[...a,_])}else chooseCorrectFile(n)})},x=()=>{e(!1),it([]),S([]),E(1),I(null),W([])};return jsxRuntimeExports.jsx(AnimatePresence,{mode:"wait",children:b&&jsxRuntimeExports.jsx(Overlay,{id:"overlay",onClick:u=>{u.target.id==="overlay"&&x()},children:jsxRuntimeExports.jsxs(MotionWrapper,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[jsxRuntimeExports.jsx(WrapperClose,{children:jsxRuntimeExports.jsx(IconButton,{onClick:()=>{x()},children:jsxRuntimeExports.jsx(default_1$8,{})})}),jsxRuntimeExports.jsx(UploadButtons,{selectedFile:j,handleFileChange:g,imagePreview:k,loadingProgress:d,setLoadingProgress:W,currentPages:D,setCurrentPages:E,numPages:f,setNumPages:I,handleCloseModal:x})]})})})}const ContentBox$1=styled(Box)`
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 30px;
  width: 100%;
`,ContentWrapper=styled(Paper)`
  position: relative;
  max-width: 400px;
  border-radius: 5px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;

  @media screen and (min-width: 320px) {
    width: 270px;
  }

  @media screen and (min-width: 370px) {
    width: 320px;
  }

  @media screen and (min-width: 430px) {
    width: 350px;
  }

  @media screen and (min-width: 600px) {
    width: 500px;
  }

  @media screen and (min-width: 720px) {
    width: 310px;
  }

  @media screen and (min-width: 900px) {
    width: 400px;
  }

  @media screen and (min-width: 1200px) {
    width: 350px;
  }
`,WrapperButtonDelete=styled(Box)`
  position: absolute;
  top: 5px;
  right: 5px;
  z-index: 10;
`,ImageBoxWrapper=styled(Box)`
  overflow: hidden;
`,ImageBox$1=styled(Box)`
  position: relative;
  background-image: ${({src:b})=>`url(${b})`};
  background-repeat: no-repeat;
  background-size: cover;
  background-position: center;
  border-radius: 5px 5px 0 0;
  max-width: 400px;
  width: 270px;
  height: 250px;
  transition: scale 500ms ease;

  @media screen and (min-width: 370px) {
    width: 320px;
  }

  @media screen and (min-width: 430px) {
    width: 350px;
  }

  @media screen and (min-width: 600px) {
    width: 500px;
  }

  @media screen and (min-width: 720px) {
    width: 350px;
  }

  @media screen and (min-width: 720px) {
    width: 310px;
  }

  @media screen and (min-width: 900px) {
    width: 400px;
  }

  @media screen and (min-width: 1200px) {
    width: 350px;
  }

  &:hover {
    scale: 1.05;
    cursor: zoom-in;
  }
`,NoCommentsBox=styled(Box)`
  width: 100%;
  height: 120px;
  display: flex;
  justify-content: center;
  align-items: center;
`,CommentsBox=styled(Box)`
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  gap: 10px;
  overflow: auto;
  scrollbar-width: thin;
`,SmsBox=styled(Box)`
  width: 100%;
  display: flex;
  justify-content: space-between;
  gap: 10px;
  padding: 10px;
`,TextBox=styled(Paper)`
  width: 100%;
  display: flex;
  flex-direction: column;
  gap: 5px;
  padding: 10px;
`,AvatareBox=styled(Box)`
  position: relative;
  background-image: ${({src:b})=>`url(${b})`};
  background-repeat: no-repeat;
  background-size: cover;
  background-position: center;
  border-radius: 50%;
  width: 30px;
  height: 30px;
`,NoAvatareBox=styled(Box)`
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  width: 30px;
  height: 30px;
`,HelperTextBox=styled(Box)`
  position: absolute;
  left: 0;
  bottom: -25px;
`,WrapperButtonSend=styled(Box)`
  position: absolute;
  top: 50%;
  right: 5px;
  transform: translate(0, -50%);
  z-index: 10;
`;var Send={},_interopRequireDefault$3=interopRequireDefaultExports;Object.defineProperty(Send,"__esModule",{value:!0});var default_1$3=Send.default=void 0,_createSvgIcon$3=_interopRequireDefault$3(requireCreateSvgIcon()),_jsxRuntime$3=jsxRuntimeExports;default_1$3=Send.default=(0,_createSvgIcon$3.default)((0,_jsxRuntime$3.jsx)("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"}),"Send");const handleSentComment=async({currentName:b,textComment:e,lessonMaterials:v,currentUser:n,dispatch:d,setTextComment:W})=>{var f,I,D,E;if(!e[b].trim()||((I=(f=e[b])==null?void 0:f.trim())==null?void 0:I.length)>500)return;const j=(D=v==null?void 0:v.materials)==null?void 0:D.findIndex(({name:g})=>g===b),it=(E=v.materials[j])==null?void 0:E.comments,k={...v.materials[j],comments:[...it||[],{user:n,text:e[b].trim(),time:dayjs().format("HH:mm"),id:nanoid()}]},S=[...v.materials];S.splice(j,1,k),await d(addCommentByIdThunk({nameCollection:collectionDb.lessonsWithJill,id:v.id,updateValue:{materials:S}})),W(g=>({...g,[b]:""}))};function Comments({language:b,comments:e,theme:v,currentUser:n,authentificated:d,textComment:W,isLoading:j,setTextComment:it,name:k,lessonMaterials:S}){var I,D;const f=useDispatch();return jsxRuntimeExports.jsxs(Box,{display:"flex",flexDirection:"column",justifyContent:"flex-end",alignItems:"center",width:"100%",height:"100%",minHeight:"170px",children:[(!e||(e==null?void 0:e.length)===0)&&jsxRuntimeExports.jsx(NoCommentsBox,{children:jsxRuntimeExports.jsx(Typography,{variant:"h6",children:b==="en"?"There are no comments":"Немає коментарів"})}),(e||(e==null?void 0:e.length)>0)&&jsxRuntimeExports.jsx(CommentsBox,{children:(I=[...e].reverse())==null?void 0:I.map(({text:E,user:g,time:x,id:u})=>jsxRuntimeExports.jsxs(SmsBox,{children:[(n==null?void 0:n.uid)!==(g==null?void 0:g.uid)?g!=null&&g.photoURL?jsxRuntimeExports.jsx(AvatareBox,{src:g==null?void 0:g.photoURL}):jsxRuntimeExports.jsx(NoAvatareBox,{children:jsxRuntimeExports.jsx(default_1$9,{fontSize:"large"})}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{}),jsxRuntimeExports.jsxs(TextBox,{elevation:2,children:[jsxRuntimeExports.jsx(Typography,{variant:"caption",textAlign:(n==null?void 0:n.uid)===(g==null?void 0:g.uid)?"right":"left",color:v==="dark"?"#008080":"#2F4F4F",children:g.displayName}),jsxRuntimeExports.jsx(Typography,{variant:"subtitle2",whiteSpace:"wrap",sx:{wordBreak:"break-word"},children:E}),jsxRuntimeExports.jsx(Typography,{variant:"caption",textAlign:(n==null?void 0:n.uid)===(g==null?void 0:g.uid)?"left":"right",color:v==="dark"?"#008000":"#228B22",children:x})]}),(n==null?void 0:n.uid)===(g==null?void 0:g.uid)?g!=null&&g.photoURL?jsxRuntimeExports.jsx(Box,{children:jsxRuntimeExports.jsx(AvatareBox,{src:g==null?void 0:g.photoURL})}):jsxRuntimeExports.jsx(NoAvatareBox,{children:jsxRuntimeExports.jsx(default_1$9,{fontSize:"large"})}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})]},u))}),d&&jsxRuntimeExports.jsxs(Box,{width:"100%",position:"relative",children:[jsxRuntimeExports.jsx(HelperTextBox,{children:jsxRuntimeExports.jsx(Typography,{variant:"caption",color:"#FF4500",children:((D=W[k])==null?void 0:D.length)>500?"Max length 500":""})}),jsxRuntimeExports.jsx(TextField,{fullWidth:!0,size:"small",placeholder:b==="en"?"Add your comment":"Додайте свій коментар",sx:{".MuiOutlinedInput-input":{padding:"15px 50px  15px 15px"}},value:W[k]??"",onChange:E=>it(g=>({...g,[k]:E.target.value})),onKeyDown:E=>{E.keyCode===13&&handleSentComment({currentName:k,lessonMaterials:S,textComment:W,currentUser:n,dispatch:f,setTextComment:it})}}),jsxRuntimeExports.jsx(WrapperButtonSend,{children:jsxRuntimeExports.jsx(IconButton,{color:"info",onClick:()=>handleSentComment({currentName:k,lessonMaterials:S,textComment:W,currentUser:n,dispatch:f,setTextComment:it}),disabled:j,children:jsxRuntimeExports.jsx(default_1$3,{})})})]})]})}Comments.propTypes={language:PropTypes.string.isRequired,comments:PropTypes.array,theme:PropTypes.string.isRequired,currentUser:PropTypes.object,authentificated:PropTypes.bool.isRequired,textComment:PropTypes.object.isRequired,setTextComment:PropTypes.func.isRequired,isLoading:PropTypes.bool.isRequired,name:PropTypes.string.isRequired,lessonMaterials:PropTypes.object.isRequired};function ImagesComponent({isImages:b,language:e,permissions:v,handleDeleteFile:n,isLoading:d,setIsImagesModal:W,lessonMaterials:j,currentUser:it,authentificated:k,theme:S,textComment:f,setTextComment:I}){return reactExports.useEffect(()=>{b&&b.map(D=>{I(E=>({...E,[D.name]:""}))})},[]),jsxRuntimeExports.jsxs(ContentBox$1,{children:[(b==null?void 0:b.length)!==0&&jsxRuntimeExports.jsx(Divider,{sx:{m:2,width:"100%"},children:jsxRuntimeExports.jsx(Chip,{label:"IMAGE"})}),(b==null?void 0:b.length)>0&&(b==null?void 0:b.map(({images:D,comments:E,name:g},x)=>jsxRuntimeExports.jsx(Box,{position:"relative",children:D&&jsxRuntimeExports.jsxs(ContentWrapper,{children:[v&&jsxRuntimeExports.jsx(WrapperButtonDelete,{children:jsxRuntimeExports.jsx(IconButton,{type:"button",color:"error",onClick:()=>n(g),disabled:d,children:jsxRuntimeExports.jsx(default_1$a,{})})}),jsxRuntimeExports.jsx(ImageBoxWrapper,{children:jsxRuntimeExports.jsx(ImageBox$1,{src:D,onClick:()=>W({images:D,comments:E,name:g})})}),jsxRuntimeExports.jsx(Box,{height:"170px",width:"100%",children:jsxRuntimeExports.jsx(Comments,{language:e,comments:E,theme:S,currentUser:it,authentificated:k,textComment:f,isLoading:d,setTextComment:I,name:g,lessonMaterials:j})})]})},x)))]})}ImagesComponent.propTypes={isImages:PropTypes.array.isRequired,language:PropTypes.string.isRequired,permissions:PropTypes.bool.isRequired,handleDeleteFile:PropTypes.func.isRequired,isLoading:PropTypes.bool.isRequired,setIsImagesModal:PropTypes.func.isRequired,lessonMaterials:PropTypes.object.isRequired,currentUser:PropTypes.object,theme:PropTypes.string.isRequired,authentificated:PropTypes.bool.isRequired,textComment:PropTypes.object.isRequired,setTextComment:PropTypes.func.isRequired};const ContentBox=styled(Box)`
  display: flex;
  flex-direction: column;
  gap: 20px;
  width: 100%;
`;var ZoomIn={},_interopRequireDefault$2=interopRequireDefaultExports;Object.defineProperty(ZoomIn,"__esModule",{value:!0});var default_1$2=ZoomIn.default=void 0,_createSvgIcon$2=_interopRequireDefault$2(requireCreateSvgIcon()),_jsxRuntime$2=jsxRuntimeExports;default_1$2=ZoomIn.default=(0,_createSvgIcon$2.default)([(0,_jsxRuntime$2.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"},"0"),(0,_jsxRuntime$2.jsx)("path",{d:"M12 10h-2v2H9v-2H7V9h2V7h1v2h2z"},"1")],"ZoomIn");var ZoomOut={},_interopRequireDefault$1=interopRequireDefaultExports;Object.defineProperty(ZoomOut,"__esModule",{value:!0});var default_1$1=ZoomOut.default=void 0,_createSvgIcon$1=_interopRequireDefault$1(requireCreateSvgIcon()),_jsxRuntime$1=jsxRuntimeExports;default_1$1=ZoomOut.default=(0,_createSvgIcon$1.default)((0,_jsxRuntime$1.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14M7 9h5v1H7z"}),"ZoomOut");const WrapperNavigateButton=styled(Box)`
  width: 100%;

  display: flex;
  justify-content: space-between;
  align-items: center;
`,WrapperPageInfo=styled(Box)`
  width: 100%;

  display: flex;
  justify-content: space-between;
  align-items: center;
`,WrapperLoader=styled(Box)`
  width: 100%;

  display: flex;
  justify-content: center;
  align-items: center;
`,WrapperZoomButton=styled(Box)``;pdfjs.GlobalWorkerOptions.workerSrc=`//unpkg.com/pdfjs-dist@${pdfjs.version}/build/pdf.worker.min.js`;PdfViewerMaterials.propTypes={pdf:PropTypes.string};function PdfViewerMaterials({pdf:b}){var u,y;const e=useSelector(selectLanguage),[v,n]=reactExports.useState(null),[d,W]=reactExports.useState(1),[j,it]=reactExports.useState(1),k=reactExports.useRef(null),[S,f]=reactExports.useState({width:window.innerWidth-50,height:300});reactExports.useEffect(()=>{k.current&&(S.width<window.innerWidth-50&&f(C=>({...C,width:k.current.clientWidth})),S.height!==k.current.clientHeight&&f(C=>({...C,height:k.current.clientHeight})))},[S.height,S.width,(u=k.current)==null?void 0:u.clientHeight,(y=k.current)==null?void 0:y.clientWidth]);const I=()=>{j<2&&it(C=>C+.1)},D=()=>{j>1&&it(C=>C-.1)},E=({numPages:C})=>{n(C)},g=()=>{W(C=>C+1)},x=()=>{W(C=>C-1)};return jsxRuntimeExports.jsxs("div",{style:{position:"relative"},children:[jsxRuntimeExports.jsxs(WrapperNavigateButton,{children:[jsxRuntimeExports.jsx(IconButton,{disabled:d===1,onClick:x,color:"info",sx:{bgcolor:"#11111199"},children:jsxRuntimeExports.jsx(default_1$5,{})}),jsxRuntimeExports.jsxs(WrapperZoomButton,{children:[jsxRuntimeExports.jsx(IconButton,{size:"small",disabled:j<=1,onClick:D,color:"info",sx:{bgcolor:"#11111199"},children:jsxRuntimeExports.jsx(default_1$1,{fontSize:"small"})}),jsxRuntimeExports.jsx(IconButton,{size:"small",onClick:I,disabled:j>2,color:"info",sx:{bgcolor:"#11111199",ml:1},children:jsxRuntimeExports.jsx(default_1$2,{fontSize:"small"})}),jsxRuntimeExports.jsxs(Typography,{variant:"caption",children:["Zoom:",j.toFixed(1)]})]}),jsxRuntimeExports.jsx(IconButton,{onClick:g,disabled:d===v,color:"info",sx:{bgcolor:"#11111199"},children:jsxRuntimeExports.jsx(default_1$4,{})})]}),jsxRuntimeExports.jsxs(WrapperPageInfo,{children:[jsxRuntimeExports.jsxs(Typography,{variant:"caption",children:[e==="en"?"Total page: ":"Всього сторінок: ",v]}),jsxRuntimeExports.jsxs(Typography,{variant:"caption",children:[e==="en"?" Current page: ":"Поточна сторінка: ",d]})]}),jsxRuntimeExports.jsx(Document,{loading:jsxRuntimeExports.jsx(WrapperLoader,{children:jsxRuntimeExports.jsx(CircularProgress,{})}),file:b,onLoadSuccess:E,children:jsxRuntimeExports.jsx(Page,{inputRef:k,scale:j,pageNumber:d,width:S.width<1100?S.width:1100,loading:jsxRuntimeExports.jsx(WrapperLoader,{children:jsxRuntimeExports.jsx(CircularProgress,{})})})})]})}function PDFComponent({isPDF:b,language:e,permissions:v,handleDeleteFile:n}){return jsxRuntimeExports.jsxs(ContentBox,{children:[b.length!==0&&jsxRuntimeExports.jsx(Divider,{sx:{m:2,width:"100%"},children:jsxRuntimeExports.jsx(Chip,{label:"PDF"})}),b.length>0&&(b==null?void 0:b.map(({pdf:d,comments:W,name:j},it)=>jsxRuntimeExports.jsx(Box,{position:"relative",children:d&&jsxRuntimeExports.jsx(PdfViewerMaterials,{pdf:d})},it)))]})}PDFComponent.propTypes={isPDF:PropTypes.array.isRequired,language:PropTypes.string.isRequired,permissions:PropTypes.bool.isRequired,handleDeleteFile:PropTypes.func.isRequired};const Wrapper=styled(Paper)`
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
`,CommentWrapper=styled(Paper)`
  width: 100%;
  max-height: 60%;
  min-height: 170px;
  overflow: hidden;
`,ImageBox=styled(Box)`
  position: relative;
  background-image: ${({src:b})=>`url(${b})`};
  background-repeat: no-repeat;
  background-size: contain;
  background-position: center;
  border-radius: 5px 5px 0 0;
  min-width: 100%;
  min-height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-end;
`,WrapperButtonClose=styled(Box)`
  position: absolute;
  top: 5px;
  right: 5px;
  z-index: 10;
`,WrapperButtonComments=styled(Box)`
  position: absolute;
  bottom: 5px;
  right: 5px;
  z-index: 10;
`;var Comment={},_interopRequireDefault=interopRequireDefaultExports;Object.defineProperty(Comment,"__esModule",{value:!0});var default_1=Comment.default=void 0,_createSvgIcon=_interopRequireDefault(requireCreateSvgIcon()),_jsxRuntime=jsxRuntimeExports;default_1=Comment.default=(0,_createSvgIcon.default)((0,_jsxRuntime.jsx)("path",{d:"M21.99 4c0-1.1-.89-2-1.99-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h14l4 4zM18 14H6v-2h12zm0-3H6V9h12zm0-3H6V6h12z"}),"Comment");function ImageModal({isLoading:b,isImagesModal:e,setIsImagesModal:v,language:n,theme:d,currentUser:W,authentificated:j,textComment:it,setTextComment:k,lessonMaterials:S,isImages:f,openComment:I,setOpenComment:D}){var g;const E=f.find(({name:x})=>x===e.name);return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(Modal,{open:!!e,onClose:()=>{v(!1),D(!1)},sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:jsxRuntimeExports.jsxs(Box,{display:"flex",flexDirection:"column",width:"90%",height:"90%",maxWidth:1200,children:[jsxRuntimeExports.jsx(Wrapper,{height:"80%",children:jsxRuntimeExports.jsxs(ImageBox,{src:e==null?void 0:e.images,children:[jsxRuntimeExports.jsx(WrapperButtonClose,{children:jsxRuntimeExports.jsx(IconButton,{type:"button",onClick:()=>{v(!1),D(!1)},disabled:b,children:jsxRuntimeExports.jsx(default_1$8,{})})}),jsxRuntimeExports.jsx(WrapperButtonComments,{children:jsxRuntimeExports.jsx(IconButton,{color:"info",onClick:()=>D(x=>!x),children:jsxRuntimeExports.jsx(Badge,{badgeContent:(g=E==null?void 0:E.comments)==null?void 0:g.length,color:"warning",children:jsxRuntimeExports.jsx(default_1,{})})})})]})}),I&&jsxRuntimeExports.jsx(CommentWrapper,{children:jsxRuntimeExports.jsx(Comments,{language:n,comments:E==null?void 0:E.comments,theme:d,currentUser:W,authentificated:j,textComment:it,isLoading:b,setTextComment:k,name:e==null?void 0:e.name,lessonMaterials:S})})]})})})}ImageModal.propTypes={isImagesModal:PropTypes.oneOfType([PropTypes.object,PropTypes.bool]).isRequired,setIsImagesModal:PropTypes.func.isRequired,isLoading:PropTypes.bool.isRequired,language:PropTypes.string.isRequired,theme:PropTypes.string.isRequired,currentUser:PropTypes.object,setTextComment:PropTypes.func.isRequired,authentificated:PropTypes.bool.isRequired,textComment:PropTypes.object.isRequired,lessonMaterials:PropTypes.object.isRequired,isImages:PropTypes.array.isRequired,openComment:PropTypes.bool.isRequired,setOpenComment:PropTypes.func.isRequired};function LessonMaterials({permissions:b,lessonMaterials:e,nameCollection:v}){var L,A,l;const n=useLocation(),d=useSelector(selectLanguage),W=useSelector(selectLessonsLoading),j=useSelector(selectAuthUser),it=useSelector(selectTheme),k=useSelector(selectAuthentificated),S=useDispatch(),[f,I]=reactExports.useState({}),[D,E]=reactExports.useState(!1),[g,x]=reactExports.useState(!1),[u,y]=reactExports.useState([]),[C,w]=reactExports.useState([]),[_,a]=reactExports.useState(!1);reactExports.useEffect(()=>{(async()=>{var z;let m=[],$=[];await((z=e==null?void 0:e.materials)==null?void 0:z.filter(R=>{R.images&&$.push(R),R.pdf&&m.push(R)})),w($),y(m)})()},[e==null?void 0:e.materials]);const c=async F=>{const m=await(e==null?void 0:e.materials.filter(({name:$})=>$!==F));S(deleteFileByNameThunk({name:F,id:e.id,nameCollection:v,updateValue:{materials:m}}))};return reactExports.useEffect(()=>{var F;S(getScheduleByIdThunk({nameCollection:v,currentId:((F=n==null?void 0:n.state)==null?void 0:F.id)??n.pathname.split("/")[n.pathname.split("/").length-1]}))},[S,n.pathname,(L=n==null?void 0:n.state)==null?void 0:L.id,v]),jsxRuntimeExports.jsxs(Box,{sx:{width:"100%",height:"100%"},children:[jsxRuntimeExports.jsx(AlertComponent,{}),jsxRuntimeExports.jsx(ImageTitle,{tipingText:(A=n==null?void 0:n.state)!=null&&A.date?(l=n==null?void 0:n.state)==null?void 0:l.date:e==null?void 0:e.date,title:d==="en"?"Lesson materials":"Матеріали уроку"}),b&&jsxRuntimeExports.jsx(Box,{textAlign:"center",m:2,children:jsxRuntimeExports.jsxs(Button,{variant:"contained",onClick:()=>x(!0),children:[d==="en"&&"Add material",d==="ua"&&"Додати матеріал"]})}),jsxRuntimeExports.jsxs(Box,{margin:"40px 0",display:"flex",flexDirection:"column",alignItems:"center",gap:"30px",children:[jsxRuntimeExports.jsx(ImagesComponent,{isImages:C,language:d,permissions:b,handleDeleteFile:c,isLoading:W,setIsImagesModal:a,lessonMaterials:e,currentUser:j,theme:it,authentificated:k,textComment:f,setTextComment:I}),jsxRuntimeExports.jsx(PDFComponent,{isPDF:u,language:d,permissions:b,handleDeleteFile:c,isLoading:W})]}),u.length===0&&C.length===0&&jsxRuntimeExports.jsx(Typography,{variant:"h6",textAlign:"center",mt:2,children:d==="en"?"Materials not added yet":"Матеріали ще не додані"}),jsxRuntimeExports.jsx(ImageModal,{isImagesModal:_,setIsImagesModal:a,isLoading:W,language:d,currentUser:j,theme:it,authentificated:k,textComment:f,setTextComment:I,lessonMaterials:e,isImages:C,openComment:D,setOpenComment:E}),jsxRuntimeExports.jsx(ModalAddMaterial,{isModalMaterials:g,setIsModalMaterials:x,lessonMaterials:e})]})}LessonMaterials.propTypes={permissions:PropTypes.bool.isRequired,lessonMaterials:PropTypes.object.isRequired,nameCollection:PropTypes.string.isRequired};export{LessonMaterials as default};
